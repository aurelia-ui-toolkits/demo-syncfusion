/*!
*  filename: ej.documenteditor.min.js
*  version : 14.4.0.15
*  Copyright Syncfusion Inc. 2001 - 2016. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["./../common/ej.core.min","./../common/ej.data.min","./../common/ej.scroller.min"],n):n()})(function(){"use strict";var n=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},t=ej.browserInfo().name=="msie"&&parseInt(ej.browserInfo().version)<9,r=function(r){function u(){r.apply(this,arguments);this.rootCSS="e-documenteditor";this.PluginName="ejDocumentEditor";this._id="null";this.defaults={importExportSettings:{importUrl:""},documentChange:null,zoomFactorChange:null,requestNavigate:null,selectionChange:null};this._documentEditorHelper=null;this.model=this.defaults}return n(u,r),u.prototype._init=function(){t||ej.isNullOrUndefined(this.element)||(this._documentEditorHelper=new i.DocumentEditorHelper(this,ej),this._documentEditorHelper.Document=this.createEmptyDocument())},u.prototype.createEmptyDocument=function(){var n=new i.DocumentAdv(null),t=new i.SectionAdv(null),r=new i.ParagraphAdv(null);return t.Blocks.push(r),n.Sections.push(t),n},u.prototype.loadDocument=function(n){this._documentEditorHelper.ParseDocument(n)},u.prototype.raiseClientEvent=function(n,t){var f=null,u,r,e;if(t===null||(f=t),n=="documentChange")u="";else if(n=="selectionChange")u="";else if(n=="zoomFactorChange")u="";else if(n=="requestNavigate"){r="";switch(f.Hyperlink.LinkType){case i.HyperlinkType.Bookmark:r="bookmark";break;case i.HyperlinkType.Email:r="email";break;case i.HyperlinkType.File:r="file";break;default:r="webpage"}e={navigationLink:f.Hyperlink.navigationLink,linkType:r};u={hyperlink:e}}this._trigger(n,u)},u.prototype.load=function(n){var r,i;t||(r=this,this._documentEditorHelper.InitDocumentLoad(),i=null,ej.browserInfo().name=="msie"&&parseInt(ej.browserInfo().version)==9?i="":(i=new FormData,i.append("files",n)),$.ajax({type:"POST",async:!0,processData:!1,contentType:!1,crossDomain:!0,data:i,url:this.model.importExportSettings.importUrl,dataType:"JSON",success:function(n){r.loadDocument(n)}}))},u.prototype.getCurrentPageNumber=function(){if(!t)return this._documentEditorHelper.CurrentPageNumber},u.prototype.getPageCount=function(){if(!t)return this._documentEditorHelper.PageCount},u.prototype.getZoomFactor=function(){if(!t)return this._documentEditorHelper.ZoomFactor},u.prototype.setZoomFactor=function(n){t||(this._documentEditorHelper.ZoomFactor=n)},u.prototype.print=function(){t||this._documentEditorHelper.Print()},u.prototype.find=function(n){t||n!=undefined&&n!=null&&n!=""&&this._documentEditorHelper.Find(n.toString(),0)},u.prototype.getSelectedText=function(){if(!t)return this._documentEditorHelper.Selection.Text},u}(ej.WidgetBase),i;ej.widget("ejDocumentEditor","ej.DocumentEditor",new r);t=ej.browserInfo().name=="msie"&&ej.browserInfo().version<9;t||(n=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(t){var vi=function(){function n(){}return n.DocumentChange="documentChange",n.SelectionChange="selectionChange",n.ZoomFactorChange="zoomFactorChange",n.RequestNavigate="requestNavigate",n}(),l,bu,w,o,st,vt,tt,ku,e,kt,su,it,dt,ut,wr,yi,tr,ir,rr,ur,ii,fr,er,ci,or,hu,sr,hr,pi,lt,s,cr,wi,y,ri,br,ht,r,yt,p,d,u,f,ui,h,cu,kr,a,fi,k,ei,lu,dr,gr,nu,au,ft,vu,oi,ni,tu,ti,bi,gt,pt,ki,lr,c,rt,li,ar,ai,at,si,yu,vr,di,pu,wu,iu,yr,g,wt,ru,uu,hi,ct,gi,b,bt,nt,du,fu,i,gu,et,eu,ot,v,ou,nr,pr;t.DocumentEditorEvents=vi;l=function(){function n(){}return n.ContextMenu="ejDocumentEditor-ContextMenu",n.ContextMenuUlList="ejDocumentEditor-ContextMenuList",n.ContextMenuItem="ejDocumentEditor-ContextMenuItem",n.DisabledContextMenuItem="ejDocumentEditor-DisbledContextMenuItem",n.HiddenContextMenuItem="ejDocumentEditor-HiddenContextMenuIten",n.ContextMenuCopy="ejDocumentEditor-ContextMenu-Copy",n.ContextMenuCopyHyperlink="ejDocumentEditor-ContextMenu-CopyHyperlink",n.ContextMenuOpenHyperlink="ejDocumentEditro-ContextMenu-OpenHyperlink",n}();t.DocumentEditorThemeHelper=l;bu=function(){function n(n,t){this.isDocumentLoaded=!0;this.currentPageNumber=1;this.pageCount=1;this.ej=null;this.DocumentEditor=n;this.ej=t;this.viewer=new ft(this);this.selection=new gr(this)}return Object.defineProperty(n.prototype,"DocumentEditorElement",{get:function(){return this.DocumentEditor.element[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ContainerId",{get:function(){return this.DocumentEditor._id},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CurrentPageNumber",{get:function(){return this.Viewer==null||this.Viewer.SelectionEndPage==null?1:this.Viewer.Pages.indexOf(this.Viewer.SelectionEndPage)+1},set:function(n){this.currentPageNumber=n;this.RaiseClientEvent(vi.SelectionChange,null)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"PageCount",{get:function(){return this.pageCount},set:function(n){this.pageCount=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ZoomFactor",{get:function(){return this.Viewer.ZoomFactor},set:function(n){this.Viewer.ZoomFactor=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Document",{get:function(){return this.document},set:function(n){this._onDocumentChanged(n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsDocumentLoaded",{get:function(){return this.isDocumentLoaded},set:function(n){n&&this.Document!=null&&this.Document.ClearUnlinkedFields();this.isDocumentLoaded=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Selection",{get:function(){return this.selection},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Viewer",{get:function(){return this.viewer},set:function(n){this.viewer=n},enumerable:!0,configurable:!0}),n.prototype.RaiseClientEvent=function(n,t){this.DocumentEditor.raiseClientEvent(n,t)},n.prototype.Print=function(){this.viewer.Print()},n.prototype.FireRequestNavigate=function(n){var t=new kr(n),i=new cu(t);this.RaiseClientEvent(vi.RequestNavigate,i)},n.prototype._onDocumentChanged=function(n){this.document!=null&&this.document.Dispose();this.document=n;this.IsDocumentLoaded=!0;this.document!=null&&(this.document.OwnerControl=this,this.document.LayoutItems(this.viewer));this.PageCount=this.Viewer.Pages.Count>0?this.viewer.Pages.Count:1;this.RaiseClientEvent(vi.DocumentChange,null)},n.prototype.InitDocumentLoad=function(){this.IsDocumentLoaded=!1;this.viewer.ClearContainer()},n.prototype.ParseDocument=function(n){var t=new pi(null);n.BackgroundColor!=null&&n.BackgroundColor!=undefined&&(t.BackgroundColor=n.BackgroundColor);this._parseSections(n.Sections,t);this._parseAbstractList(n,t);this._parseList(n,t);this.Document=t;this.Selection.SelectRange(t.DocumentStart,t.DocumentStart,!0)},n.prototype._parseSections=function(n,t){for(var r,i=0;i<n.length;i++)r=new lt(null),this._parseSectionFormat(n[i].SectionFormat,r.SectionFormat),this._parseHeaderFooter(n[i].HeaderFooters,r.HeaderFooters),this._parseTextBody(n[i].Blocks,r.Blocks),t.Sections.push(r)},n.prototype._parseSectionFormat=function(n,t){t.PageWidth=n.PageWidth;t.PageHeight=n.PageHeight;t.LeftMargin=n.LeftMargin;t.TopMargin=n.TopMargin;t.RightMargin=n.RightMargin;t.BottomMargin=n.BottomMargin;t.HeaderDistance=n.HeaderDistance;t.FooterDistance=n.FooterDistance;t.DifferentFirstPage=n.DifferentFirstPage;t.DifferentOddAndEvenPages=n.DifferentOddAndEvenPages},n.prototype._parseHeaderFooter=function(n,t){this._parseTextBody(n.Header.Blocks,t.Header.Blocks);this._parseTextBody(n.Footer.Blocks,t.Footer.Blocks);this._parseTextBody(n.EvenHeader.Blocks,t.EvenHeader.Blocks);this._parseTextBody(n.EvenFooter.Blocks,t.EvenFooter.Blocks);this._parseTextBody(n.FirstPageHeader.Blocks,t.FirstPageHeader.Blocks);this._parseTextBody(n.FirstPageFooter.Blocks,t.FirstPageFooter.Blocks)},n.prototype._parseTextBody=function(n,t){for(var i,u,f=0;f<n.length;f++)i=n[f],i.hasOwnProperty("Inlines")?(u=new r(null),i.hasOwnProperty("ParagraphFormat")&&this._parseParagraphFormat(i.ParagraphFormat,u.ParagraphFormat),i.hasOwnProperty("CharacterFormat")&&this._parseCharacterFormat(i.CharacterFormat,u.CharacterFormat),i.Inlines.length>0&&this._parseParagraph(i.Inlines,u),t.push(u)):i.hasOwnProperty("Rows")&&this._parseTable(i,t)},n.prototype._parseTable=function(n,t){var u=new y(null),i,r,f,e;for(this._parseTableFormat(n.TableFormat,u.TableFormat),u.Title=n.Title,u.Description=n.Description,i=0;i<n.Rows.length;i++)if(r=new ri(null),u.Rows.push(r),n.Rows[i].hasOwnProperty("RowFormat"))for(this._parseRowFormat(n.Rows[i].RowFormat,r.RowFormat),r.GridBefore=n.Rows[i].GridBefore,r.GridBeforeWidth=n.Rows[i].GridBeforeWidth,r.GridAfter=n.Rows[i].GridAfter,r.GridAfterWidth=n.Rows[i].GridAfterWidth,f=0;f<n.Rows[i].Cells.length;f++)e=new ht(null),r.Cells.push(e),n.Rows[i].Cells[f].hasOwnProperty("CellFormat")&&this._parseCellFormat(n.Rows[i].Cells[f].CellFormat,e.CellFormat),this._parseTextBody(n.Rows[i].Cells[f].Blocks,e.Blocks);u!=null&&t.push(u)},n.prototype._parseParagraph=function(n,t){for(var r,e,u,s,o,i=0;i<n.length;i++)r=n[i],r.hasOwnProperty("Text")?(e=new p(null),r.hasOwnProperty("CharacterFormat")&&this._parseCharacterFormat(r.CharacterFormat,e.CharacterFormat),e.Text=n[i].Text,t.Inlines.push(e)):r.hasOwnProperty("Imagestring")?(u=new d(null,n[i].IsInlineImage,n[i].IsMetaFile),t.Inlines.push(u),u.ImageString=n[i].Imagestring,u.Width=n[i].Width,u.Height=n[i].Height,r.hasOwnProperty("CharacterFormat")&&this._parseCharacterFormat(r.CharacterFormat,u.CharacterFormat)):r.hasOwnProperty("HasFieldEnd")?(s=new f(null),s.HasFieldEnd=n[i].HasFieldEnd,t.Inlines.push(s)):r.hasOwnProperty("FieldCharacterType")&&(o=null,n[i].FieldCharacterType==1?o=new ui(null):n[i].FieldCharacterType==2&&(o=new h(null)),t.Inlines.push(o))},n.prototype._parseCharacterFormat=function(n,t){n.BaselineAlignment!=undefined&&n.BaselineAlignment!=null&&(t.BaselineAlignment=n.BaselineAlignment);n.Underline!=undefined&&n.Underline!=null&&(t.Underline=n.Underline);n.StrikeThrough!=undefined&&n.StrikeThrough!=null&&(t.StrikeThrough=n.StrikeThrough);n.FontSize!=undefined&&n.FontSize!=null&&(t.FontSize=n.FontSize);n.FontFamily!=undefined&&n.FontFamily!=null&&(t.FontFamily=n.FontFamily);n.Bold!=undefined&&n.Bold!=null&&(t.Bold=n.Bold);n.Italic!=undefined&&n.Italic!=null&&(t.Italic=n.Italic);n.HighlightColor!=undefined&&n.HighlightColor!=null&&(t.HighlightColor=n.HighlightColor);n.FontColor!=undefined&&n.FontColor!=null&&(t.FontColor=n.FontColor)},n.prototype._parseListCharacterFormat=function(n,t){n!=null&&(n.BaselineAlignment!=undefined&&n.BaselineAlignment!=null&&(t.BaselineAlignment=n.BaselineAlignment),n.Underline!=undefined&&n.Underline!=null&&(t.Underline=n.Underline),n.StrikeThrough!=undefined&&n.StrikeThrough!=null&&(t.StrikeThrough=n.StrikeThrough),n.FontSize!=undefined&&n.FontSize!=null&&(t.FontSize=n.FontSize),n.FontFamily!=undefined&&n.FontFamily!=null&&(t.FontFamily=n.FontFamily),n.Bold!=undefined&&n.Bold!=null&&(t.Bold=n.Bold),n.Italic!=undefined&&n.Italic!=null&&(t.Italic=n.Italic),n.HighlightColor!=undefined&&n.HighlightColor!=null&&(t.HighlightColor=n.HighlightColor),n.FontColor!=undefined&&n.FontColor!=null&&(t.FontColor=n.FontColor))},n.prototype._parseParagraphFormat=function(n,t){n.hasOwnProperty("ListFormat")&&this._parseListFormat(n,t.ListFormat);n.LeftIndent!=undefined&&n.LeftIndent!=null&&(t.LeftIndent=n.LeftIndent);n.RightIndent!=undefined&&n.RightIndent!=null&&(t.RightIndent=n.RightIndent);n.FirstLineIndent!=undefined&&n.FirstLineIndent!=null&&(t.FirstLineIndent=n.FirstLineIndent);n.LineSpacing!=undefined&&n.LineSpacing!=null&&(t.LineSpacing=n.LineSpacing);n.LineSpacingType!=undefined&&n.LineSpacingType!=null&&(t.LineSpacingType=n.LineSpacingType);n.BeforeSpacing!=undefined&&n.BeforeSpacing!=null&&(t.BeforeSpacing=n.BeforeSpacing);n.AfterSpacing!=undefined&&n.AfterSpacing!=null&&(t.AfterSpacing=n.AfterSpacing);n.TextAlignment!=undefined&&n.TextAlignment!=null&&(t.TextAlignment=n.TextAlignment)},n.prototype._parseListFormat=function(n,t){t.ListId=n.ListFormat.ListId;t.ListLevelNumber=n.ListFormat.ListLevelNumber},n.prototype._parseTableFormat=function(n,t){n.Borders!=undefined&&n.Borders!=null&&this._parseBorders(n.Borders,t.Borders);n.CellSpacing!=undefined&&n.CellSpacing!=null&&(t.CellSpacing=n.CellSpacing);n.LeftMargin!=undefined&&n.LeftMargin!=null&&(t.LeftMargin=n.LeftMargin);n.TopMargin!=undefined&&n.TopMargin!=null&&(t.TopMargin=n.TopMargin);n.RightMargin!=undefined&&n.RightMargin!=null&&(t.RightMargin=n.RightMargin);n.BottomMargin!=undefined&&n.BottomMargin!=null&&(t.BottomMargin=n.BottomMargin);n.LeftIndent!=undefined&&n.LeftIndent!=null&&(t.LeftIndent=n.LeftIndent);n.Shading!=undefined&&n.Shading!=null&&this._parseShading(n.Shading,t.Shading);n.TableAlignment!=undefined&&n.TableAlignment!=null&&(t.TableAlignment=n.TableAlignment);n.PreferredWidth!=undefined&&n.PreferredWidth!=null&&(t.PreferredWidth=n.PreferredWidth);n.PreferredWidthType!=undefined&&n.PreferredWidthType!=null&&(t.PreferredWidthType=n.PreferredWidthType)},n.prototype._parseShading=function(n,t){n.BackgroundColor!=null&&n.BackgroundColor!=undefined&&(t.BackgroundColor=n.BackgroundColor);n.ForegroundColor!=null&&n.ForegroundColor!=undefined&&(t.ForegroundColor=n.ForegroundColor);n.TextureStyle!=null&&n.TextureStyle!=undefined&&(t.TextureStyle=n.TextureStyle)},n.prototype._parseBorder=function(n,t){n.Color!=null&&n.Color!=undefined&&(t.Color=n.Color);n.LineStyle!=null&&n.LineStyle!=undefined&&(t.LineStyle=n.LineStyle);n.LineWidth!=null&&n.LineWidth!=undefined&&(t.LineWidth=n.LineWidth)},n.prototype._parseBorders=function(n,t){this._parseBorder(n.Left,t.Left);this._parseBorder(n.Right,t.Right);this._parseBorder(n.Top,t.Top);this._parseBorder(n.Bottom,t.Bottom);this._parseBorder(n.Vertical,t.Vertical);this._parseBorder(n.Horizontal,t.Horizontal);this._parseBorder(n.DiagonalDown,t.DiagonalDown);this._parseBorder(n.DiagonalUp,t.DiagonalUp)},n.prototype._parseCellFormat=function(n,t){n.Borders!=undefined&&n.Borders!=null&&this._parseBorders(n.Borders,t.Borders);n.IsSamePaddingAsTable?t.ClearMargins():this._parseCellMargin(n,t);n.CellWidth!=undefined&&n.CellWidth!=null&&(t.CellWidth=n.CellWidth);n.ColumnSpan!=undefined&&n.ColumnSpan!=null&&(t.ColumnSpan=n.ColumnSpan);n.RowSpan!=undefined&&n.RowSpan!=null&&(t.RowSpan=n.RowSpan);n.Shading!=undefined&&n.Shading!=null&&this._parseShading(n.Shading,t.Shading);n.VerticalAlignment!=undefined&&n.VerticalAlignment!=null&&(t.VerticalAlignment=n.VerticalAlignment);n.PreferredWidthType!=undefined&&n.PreferredWidthType!=null&&(t.PrefferedWidthType=n.PreferredWidthType);n.PreferredWidth!=undefined&&n.PreferredWidth!=null&&(t.PrefferedWidth=n.PreferredWidth)},n.prototype._parseCellMargin=function(n,t){n.LeftMargin!=undefined&&n.LeftMargin!=null&&(t.LeftMargin=n.LeftMargin);n.RightMargin!=undefined&&n.RightMargin!=null&&(t.RightMargin=n.RightMargin);n.TopMargin!=undefined&&n.TopMargin!=null&&(t.TopMargin=n.TopMargin);n.BottomMargin!=undefined&&n.BottomMargin!=null&&(t.BottomMargin=n.BottomMargin)},n.prototype._parseRowFormat=function(n,t){n.AllowBreakAcrossPages!=undefined&&n.AllowBreakAcrossPages!=null&&(t.AllowBreakAcrossPages=n.AllowBreakAcrossPages);n.IsHeader!=undefined&&n.IsHeader!=null&&(t.IsHeader=n.IsHeader);n.Height!=undefined&&n.Height!=null&&(t.Height=n.Height);n.HeightType!=undefined&&n.HeightType!=null&&(t.HeightType=n.HeightType);n.Borders!=undefined&&n.Borders!=null&&this._parseBorders(n.Borders,t.Borders)},n.prototype._parseAbstractList=function(n,t){for(var r,u,f,i=0;i<n.AbstractLists.length;i++)for(r=new ai(null),t.AbstractLists.push(r),r.AbstractListId=n.AbstractLists[i].AbstractListId,u=0;u<n.AbstractLists[i].Levels.length;u++)f=this._parseListLevel(n.AbstractLists[i].Levels[u]),r.Levels.push(f)},n.prototype._parseList=function(n,t){for(var r,i=0;i<n.Lists.length;i++)r=new ar(null),r.AbstractListId=n.Lists[i].AbstractListId,t.Lists.push(r),r.ListId=t.Lists.length-1,n.Lists[i].hasOwnProperty("LevelOverrides")!=null&&this._parseLevelOverride(n.Lists[i].LevelOverrides,r)},n.prototype._parseLevelOverride=function(n,t){for(var r,u,i=0;i<n.length;i++)r=new si(null),u=n[i],r.StartAt=u.StartAt,r.LevelNumber=u.LevelNumber,n[i].OverrideListLevel!=null&&(r.OverrideListLevel=this._parseListLevel(u.OverrideListLevel)),t.LevelOverrides.push(r)},n.prototype._parseListLevel=function(n){var t=new at(null);return n.ListLevelPattern==v.Bullet?(t.ListLevelPattern=v.Bullet,t.NumberFormat=n.NumberFormat):(t.ListLevelPattern=n.ListLevelPattern,t.StartAt=n.StartAt,t.NumberFormat=n.NumberFormat,t.RestartLevel=n.RestartLevel>=0?n.RestartLevel:n.LevelNumber),t.FollowCharacter=n.FollowCharacter,this._parseListCharacterFormat(n.CharacterFormat,t.CharacterFormat),this._parseParagraphFormat(n.ParagraphFormat,t.ParagraphFormat),t},n.prototype.Find=function(n,t){var i=st.StringToRegex(n,t);return this.Document==null||!this.isDocumentLoaded?!1:this.Document.Find(i,t,!0,this)},n}();t.DocumentEditorHelper=bu;w=function(){function n(){}return n.Round=function(n,t){for(var i=n,r=0;r<t;r++)i=i*10;for(i=Math.round(i),r=0;r<t;r++)i=i/10;return i},n}();t.MathHelper=w;o=function(){function n(){}return Object.defineProperty(n,"ParagraphMark",{get:function(){return"¶"},enumerable:!0,configurable:!0}),n.GetParagraphMarkSize=function(t){var r=n.GetWidth(this.ParagraphMark,t),i=n.GetHeight(t);return{Width:r,Height:i.Height,BaselineOffset:i.BaselineOffset}},n.GetTextSize=function(t,i){t.Width=n.GetWidth(t.Text,i);var r=n.GetHeight(i);t.Height=r.Height;t.BaselineOffset=r.BaselineOffset},n.UpdateTextSize=function(t){var i=t.ListLevel.CharacterFormat,u=t.Paragraph.CharacterFormat,r;i.FontSize=i.FontSize==11?u.FontSize:i.FontSize;i.FontFamily=i.FontFamily=="verdana"?u.FontFamily:i.FontFamily;t.Width=n.GetWidth(t.Text,i);r=n.GetHeight(i);t.Height=r.Height;t.BaselineOffset=r.BaselineOffset},n.MeasureText=function(t,i){var u=n.GetWidth(t,i),r=n.GetHeight(i);return{Width:u,Height:r.Height,BaselineOffset:r.BaselineOffset}},n.MeasureTextExcludIngSpaceAtEnd=function(t,i){var u=n.GetWidth(t.replace(/\s\s*$/,""),i),r=n.GetHeight(i);return{Width:u,Height:r.Height,BaselineOffset:r.BaselineOffset}},n.GetHeight=function(t){var e=0,o=0,i=document.createElement("span"),f,r,u,s,h;return i.id="tempSpan",i.style.whiteSpace="nowrap",i.innerText="m",n.ApplyStyle(i,t),f=document.getElementsByTagName("body"),f!=null&&f.length>0&&(r=document.createElement("div"),r.style.display="inline-block",u=document.createElement("div"),u.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),r.appendChild(i),r.appendChild(u),document.body.appendChild(r),e=i.getBoundingClientRect().height,s=i.getBoundingClientRect().top,h=u.getBoundingClientRect().top,o=h-s,document.body.removeChild(r)),{Height:e,BaselineOffset:o}},n.GetWidth=function(n,t){var o=document.createElement("canvas"),i=o.getContext("2d"),r="",u="",f="",e=11;return r=t.Bold?"bold":"",u=t.Italic?"italic":"",f=t.FontFamily,e=t.FontSize==0?.5:t.FontSize/(t.BaselineAlignment==ct.Normal?1:1.5),i.font=r+" "+u+" "+e+"px "+f,i.measureText(n).width},n.ApplyStyle=function(n,t){if(n!=undefined&&n!=null&&t!=undefined&&t!=null){t.Bold&&(n.style.fontWeight="bold");t.Italic&&(n.style.fontStyle="italic");t.FontFamily!=""&&(n.style.fontFamily=t.FontFamily);var i=t.FontSize;i<=.5&&(i=.5);n.style.fontSize=i.toString()+"px"}},n}();t.TextHelper=o;st=function(){function n(){}return n.StringToRegex=function(n,t){return(t==pr.WholeWord||t==pr.CaseSensitiveWholeWord)&&(n=this.WORD_BEFORE+n+this.WORD_AFTER),new RegExp(n,t==pr.CaseSensitive||t==pr.CaseSensitiveWholeWord?"g":"ig")},n.IsPatternEmpty=function(n){var i=this.WORD_BEFORE+this.WORD_AFTER,t=n.toString();return t.length==0||t==i},n.AddCssStyle=function(n){var t=document.createElement("style");t.style.cssText?t.style.cssText=n:t.appendChild(document.createTextNode(n));document.getElementsByTagName("head")[0].appendChild(t)},n.IsVeryDark=function(n){n=n.substring(1);var t=parseInt(n.substr(0,2),16),i=parseInt(n.substr(2,2),16),r=parseInt(n.substr(4,2),16),u=(t*299+i*587+r*114)/1e3;return u<=60},n.GetHighlightColorCode=function(n){var t="#ffffff";switch(n){case b.Yellow:t="#ffff00";break;case b.BrightGreen:t="#00ff00";break;case b.Turquoise:t="#00ffff";break;case b.Pink:t="#ff00ff";break;case b.Blue:t="#0000ff";break;case b.Red:t="#ff0000";break;case b.DarkBlue:t="#000080";break;case b.Teal:t="#008080";break;case b.Green:t="#008000";break;case b.Violet:t="#800080";break;case b.DarkRed:t="#800000";break;case b.DarkYellow:t="#808000";break;case b.Gray50:t="#808080";break;case b.Gray25:t="#c0c0c0";break;case b.Black:t="#000000"}return t},n.IndexOfAny=function(n,t){for(var r,i=0;i<n.length;i++)for(r=0;r<t.length-1;r++)if(n[i]==t[r])return i;return-1},n.LastIndexOfAny=function(n,t){for(var r,i=n.length-1;i>=0;i--)for(r=0;r<=t.length-1;r++)if(n[i]==t[r])return i;return-1},n.GetHtmlTextAlign=function(n){switch(n){case nt.Center:return"center";case nt.Right:return"right";case nt.Justify:return"justify";default:return"left"}},n.WORD_BEFORE="(?<=^|W|\t)",n.WORD_AFTER="(?=$|W|\t)",n}();t.HelperMethods=st;vt=function(){function n(){}return Object.defineProperty(n,"Maroon",{get:function(){return"maroon"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Red",{get:function(){return"red"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Orange",{get:function(){return"orange"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Yellow",{get:function(){return"yellow"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Olive",{get:function(){return"olive"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Fuchsia",{get:function(){return"fuchsia"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Lime",{get:function(){return"lime"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"White",{get:function(){return"white"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Green",{get:function(){return"green"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Navy",{get:function(){return"navy"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Blue",{get:function(){return"blue"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Aqua",{get:function(){return"aqua"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Teal",{get:function(){return"teal"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Black",{get:function(){return"black"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Silver",{get:function(){return"silver"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Gray",{get:function(){return"gray"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Purple",{get:function(){return"purple"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"XXSmall",{get:function(){return"xx-small"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"XSmall",{get:function(){return"x-small"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Medium",{get:function(){return"medium"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"XLarge",{get:function(){return"x-large"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"XXLarge",{get:function(){return"xx-large"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Small",{get:function(){return"small"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Smaller",{get:function(){return"smaller"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Larger",{get:function(){return"bigger"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Large",{get:function(){return"large"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Underline",{get:function(){return"underline"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LineThrough",{get:function(){return"line-through"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LineHeight",{get:function(){return"line-height"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SubScript",{get:function(){return"sub"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SuperScript",{get:function(){return"super"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Font",{get:function(){return"font"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LeftIndent",{get:function(){return"left-indent"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TextIndent",{get:function(){return"text-indent"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FontFamily",{get:function(){return"font-family"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FontSize",{get:function(){return"font-size"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FontStyle",{get:function(){return"font-style"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"FontWeight",{get:function(){return"font-weight"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TextDecoration",{get:function(){return"text-decoration"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TextAlign",{get:function(){return"text-align"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SubSuperScripts",{get:function(){return"vertical-align"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Background",{get:function(){return"background-color"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Color",{get:function(){return"color"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"HyperlinkColor",{get:function(){return"hyperlinkcolor"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Baseline",{get:function(){return"baseline"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"ListType",{get:function(){return"listType"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Margin",{get:function(){return"margin"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Border",{get:function(){return"border"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"BgColor",{get:function(){return"bgcolor"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Align",{get:function(){return"align"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Cm",{get:function(){return"cm"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Mm",{get:function(){return"mm"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Px",{get:function(){return"px"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"In",{get:function(){return"in"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Ex",{get:function(){return"ex"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Em",{get:function(){return"em"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Pt",{get:function(){return"pt"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Pc",{get:function(){return"pc"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Percentage",{get:function(){return"%"},enumerable:!0,configurable:!0}),n}();t.CssConstants=vt;tt=function(){function n(){}return Object.defineProperty(n,"Dot",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(n,"OpenBrace",{get:function(){return"{"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"CloseBrace",{get:function(){return"}"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Colon",{get:function(){return":"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"SemiColon",{get:function(){return";"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Equal",{get:function(){return"="},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Quotes",{get:function(){return'"'},enumerable:!0,configurable:!0}),Object.defineProperty(n,"LessthanSymbol",{get:function(){return"<"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"GreaterthanSymbol",{get:function(){return">"},enumerable:!0,configurable:!0}),Object.defineProperty(n,"Endslash",{get:function(){return"/"},enumerable:!0,configurable:!0}),n}();t.HTMLOperators=tt;ku=function(){function n(){}return Object.defineProperty(n,"HtmlAsciiCodeTable",{get:function(){return n.htmlAsciiCodeTable==null&&(n.htmlAsciiCodeTable=new kt,n.htmlNameTable=new kt,n.AddHtmlAsciiSymbols(),n.AddHtmlNames()),n.htmlAsciiCodeTable},enumerable:!0,configurable:!0}),Object.defineProperty(n,"HtmlNameTable",{get:function(){return n.htmlNameTable==null&&(n.htmlAsciiCodeTable=new kt,n.htmlNameTable=new kt,n.AddHtmlAsciiSymbols(),n.AddHtmlNames()),n.htmlNameTable},enumerable:!0,configurable:!0}),n.AddHtmlAsciiSymbols=function(){var r=[],i,t;for(r=[" ",'""',"!","#","$","%","&","'","(",")","*"," +",", "," - ",".","/ ","0","1","2","3","4","5","6","7","8","9",":",";"," < ","="," > "," ? ","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[",'"',"]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"," ","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","","­®","¯","°","±","²","³","´","µ","¶","•","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","â","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ","Œ","œ","Š","š","Ÿ","ƒ","–","—","‘","’","‚","“","”","„","†","‡","•","…","‰","€","™"],i=-1,t=32;t<=8482;t++)if(t>126&&t<160||t>255&&t<338||t>339&&t<352||t>353&&t<376||t>376&&t<402||t>402&&t<8211||t>8212&&t<8216||t==8219||t==8223||t>8226&&t<8230||t>8230&&t<8240||t>8240&&t<8364||t>8364&&t<8482)continue;else i++,i<r.length&&n.HtmlAsciiCodeTable.Add("&#"+t+";",r[i])},n.AddHtmlNames=function(){n.HtmlNameTable.Add("&nbsp;"," ");n.HtmlNameTable.Add("&emsp;","\t");n.HtmlNameTable.Add("&#160;"," ");n.HtmlNameTable.Add("&lt;","<");n.HtmlNameTable.Add("&gt;",">");n.HtmlNameTable.Add("&amp;","&");n.HtmlNameTable.Add("&quot;",'"');n.HtmlNameTable.Add("&iexcl;","¡");n.HtmlNameTable.Add("&cent;","¢");n.HtmlNameTable.Add("&pound;","£");n.HtmlNameTable.Add("&curren;","¤");n.HtmlNameTable.Add("&yen;","¥");n.HtmlNameTable.Add("&brvbar;","¦");n.HtmlNameTable.Add("&sect;","§");n.HtmlNameTable.Add("&uml;","¨");n.HtmlNameTable.Add("&copy;","©");n.HtmlNameTable.Add("&ordf;","ª");n.HtmlNameTable.Add("&laquo;","«");n.HtmlNameTable.Add("&not;","¬");n.HtmlNameTable.Add("&reg;","­®");n.HtmlNameTable.Add("&macr;","¯");n.HtmlNameTable.Add("&deg;","°");n.HtmlNameTable.Add("&plusmn;","±");n.HtmlNameTable.Add("&sup2;","²");n.HtmlNameTable.Add("&sup3;","³");n.HtmlNameTable.Add("&acute;","´");n.HtmlNameTable.Add("&micro;","µ");n.HtmlNameTable.Add("&para;","¶");n.HtmlNameTable.Add("&middot;","·");n.HtmlNameTable.Add("&cedil;","¸");n.HtmlNameTable.Add("&sup1;","¹");n.HtmlNameTable.Add("&ordm;","º");n.HtmlNameTable.Add("&raquo;","»");n.HtmlNameTable.Add("&frac14;","¼");n.HtmlNameTable.Add("&frac12;","½");n.HtmlNameTable.Add("&frac34;","¾");n.HtmlNameTable.Add("&iquest;","¿");n.HtmlNameTable.Add("&Agrave;","À");n.HtmlNameTable.Add("&Aacute;","Á");n.HtmlNameTable.Add("&Acirc;","Â");n.HtmlNameTable.Add("&Atilde;","Ã");n.HtmlNameTable.Add("&Auml;","Ä");n.HtmlNameTable.Add("&Aring;","Å");n.HtmlNameTable.Add("&AElig;","Æ");n.HtmlNameTable.Add("&Ccedil;","Ç");n.HtmlNameTable.Add("&Egrave;","È");n.HtmlNameTable.Add("&Eacute;","É");n.HtmlNameTable.Add("&Ecirc;","Ê");n.HtmlNameTable.Add("&Euml;","Ë");n.HtmlNameTable.Add("&Igrave;","Ì");n.HtmlNameTable.Add("&Iacute;","Í");n.HtmlNameTable.Add("&Icirc;","Î");n.HtmlNameTable.Add("&Iuml;","Ï");n.HtmlNameTable.Add("&ETH;","Ð");n.HtmlNameTable.Add("&Ntilde;","Ñ");n.HtmlNameTable.Add("&Ograve;","Ò");n.HtmlNameTable.Add("&Oacute;","Ó");n.HtmlNameTable.Add("&Ocirc;","Ô");n.HtmlNameTable.Add("&Otilde;","Õ");n.HtmlNameTable.Add("&Ouml;","Ö");n.HtmlNameTable.Add("&times;","×");n.HtmlNameTable.Add("&Oslash;","Ø");n.HtmlNameTable.Add("&Ugrave;","Ù");n.HtmlNameTable.Add("&Uacute;","Ú");n.HtmlNameTable.Add("&Ucirc;","Û");n.HtmlNameTable.Add("&Uuml;","Ü");n.HtmlNameTable.Add("&Yacute;","Ý");n.HtmlNameTable.Add("&THORN;","Þ");n.HtmlNameTable.Add("&szlig;","ß");n.HtmlNameTable.Add("&agrave;","à");n.HtmlNameTable.Add("&aacute;","á");n.HtmlNameTable.Add("&acirc;","â");n.HtmlNameTable.Add("&atilde;","ã");n.HtmlNameTable.Add("&auml;","ä");n.HtmlNameTable.Add("&aring;","å");n.HtmlNameTable.Add("&aelig;","æ");n.HtmlNameTable.Add("&ccedil;","ç");n.HtmlNameTable.Add("&egrave;","è");n.HtmlNameTable.Add("&eacute;","é");n.HtmlNameTable.Add("&ecirc;","ê");n.HtmlNameTable.Add("&euml;","ë");n.HtmlNameTable.Add("&igrave;","ì");n.HtmlNameTable.Add("&iacute;","í");n.HtmlNameTable.Add("&icirc;","î");n.HtmlNameTable.Add("&iuml;","ï");n.HtmlNameTable.Add("&eth;","ð");n.HtmlNameTable.Add("&ntilde;","ñ");n.HtmlNameTable.Add("&ograve;","ò");n.HtmlNameTable.Add("&oacute;","ó");n.HtmlNameTable.Add("&ocirc;","ô");n.HtmlNameTable.Add("&otilde;","õ");n.HtmlNameTable.Add("&ouml;","ö");n.HtmlNameTable.Add("&divide;","÷");n.HtmlNameTable.Add("&oslash;","ø");n.HtmlNameTable.Add("&ugrave;","ù");n.HtmlNameTable.Add("&uacute;","ú");n.HtmlNameTable.Add("&ucirc;","û");n.HtmlNameTable.Add("&uuml;","ü");n.HtmlNameTable.Add("&yacute;","ý");n.HtmlNameTable.Add("&thorn;","þ");n.HtmlNameTable.Add("&yuml;","ÿ");n.HtmlNameTable.Add("&OElig;","Œ");n.HtmlNameTable.Add("&oelig;","œ");n.HtmlNameTable.Add("&Scaron;","Š");n.HtmlNameTable.Add("&scaron;","š");n.HtmlNameTable.Add("&Yuml;","Ÿ");n.HtmlNameTable.Add("&fnof;","ƒ");n.HtmlNameTable.Add("&ndash;","–");n.HtmlNameTable.Add("&mdash;","—");n.HtmlNameTable.Add("&lsquo;","‘");n.HtmlNameTable.Add("&rsquo;","’");n.HtmlNameTable.Add("&ldquo;","“");n.HtmlNameTable.Add("&rdquo;","”");n.HtmlNameTable.Add("&bdquo;","„");n.HtmlNameTable.Add("&dagger;","†");n.HtmlNameTable.Add("&ddagger;","‡");n.HtmlNameTable.Add("&bullet;","•");n.HtmlNameTable.Add("&hellip;","…");n.HtmlNameTable.Add("&permil;","‰");n.HtmlNameTable.Add("&trade;","™");n.HtmlNameTable.Add("&euro;","€")},n.htmlAsciiCodeTable=null,n.htmlNameTable=null,n}();t.HtmlAsciiCodesInfo=ku;e=function(t){function i(){t.apply(this,arguments)}return n(i,t),Object.defineProperty(i.prototype,"Count",{get:function(){return this.length!=undefined&&this.length!=null?this.length:0},enumerable:!0,configurable:!0}),i.prototype.Add=function(n){if(1)return t.prototype.push.call(this,n),1},i.prototype.Insert=function(n,t){if(n==this.length){this.Add(t);return}n>-1&&n<this.length&&(this.shiftItems(n,!0),this[n]=t,this.length=this.length+1)},i.prototype.Remove=function(n){var i=this.indexOf(n);return i>-1&&i<this.length?(this.shiftItems(i,!1),t.prototype.pop.call(this),!0):!1},i.prototype.RemoveAt=function(n){if(n>-1&&n<this.length){var i=this[n];return this.shiftItems(n,!1),t.prototype.pop.call(this),!0}return!1},i.prototype.Contains=function(n){var t=this.indexOf(n);return t>-1&&t<this.length},i.prototype.Clear=function(){for(var n=this.length;n>0;n--)this.RemoveAt(n-1)},i.prototype.ToList=function(){for(var t=new i,n=0;n<this.length;n++)t.Add(this[n]);return t},i.prototype.IndexOf=function(n){return this.indexOf(n)},i.prototype.First=function(){return this.length>0?this[0]:null},i.prototype.Last=function(){return this.length>0?this[this.length-1]:null},i.prototype.shiftItems=function(n,t){var i;if(t)for(i=this.length;i>n;i--)this[i]=this[i-1];else for(i=n;i<this.length-1;i++)this[i]=this[i+1]},i.prototype.Sort=function(){t.prototype.sort.call(this,function(n,t){return n-t})},i}(Array);t.List=e;kt=function(){function n(){this.keys=new e;this.values=new e}return Object.defineProperty(n.prototype,"Count",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Keys",{get:function(){return this.keys.ToList()},enumerable:!0,configurable:!0}),n.prototype.Add=function(n,t){if(n==undefined||n==null||t==undefined||t==null)throw new ReferenceError("Provided key or value is not valid.");var i=this.keys.indexOf(n);if(i<0||i>this.keys.length-1)return this.keys.Add(n),this.values.Add(t),1;throw new RangeError("An item with the same key has already been added.");},n.prototype.Get=function(n){if(n==undefined||n==null)throw new ReferenceError("Provided key is not valid.");var t=this.keys.indexOf(n);if(t<0||t>this.keys.length-1)throw new RangeError("No item with the specified key has been added.");else return this.values[t]},n.prototype.Set=function(n,t){if(n==undefined||n==null)throw new ReferenceError("Provided key is not valid.");var i=this.keys.indexOf(n);if(i<0||i>this.keys.length-1)throw new RangeError("No item with the specified key has been added.");else this.values[i]=t},n.prototype.Remove=function(n){if(n==undefined||n==null)throw new ReferenceError("Provided key is not valid.");var t=this.keys.indexOf(n);if(t<0||t>this.keys.length-1)throw new RangeError("No item with the specified key has been added.");else return this.keys.RemoveAt(t),this.values.RemoveAt(t),!0},n.prototype.ContainsKey=function(n){if(n==undefined||n==null)throw new ReferenceError("Provided key is not valid.");var t=this.keys.indexOf(n);return t<0||t>this.keys.length-1?!1:!0},n.prototype.Clear=function(){this.keys.Clear();this.values.Clear()},n}();t.Dictionary=kt;su=function(t){function i(){t.apply(this,arguments);this.maxBaseLineOffset=0;this.maxTextElementHeight=Number.NaN;this.maxTextElementBaselineOffset=0;this.SkipClipImage=!1}return n(i,t),Object.defineProperty(i.prototype,"MaxBaselineOffset",{get:function(){return this.maxBaseLineOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"MaxTextElementHeight",{get:function(){return this.maxTextElementHeight},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"MaxTextElementBaselineOffset",{get:function(){return this.maxTextElementBaselineOffset},enumerable:!0,configurable:!0}),i.prototype.push=function(n){return this.Add(n)},i.prototype.Add=function(n){if(n!=undefined&&n!=null)return t.prototype.push.call(this,n),this.UpdateMaxElementHeight(n),1},i.prototype.Insert=function(n,t){if(n==this.length){this.Add(t);return}n>-1&&n<this.length&&(this.shiftItems(n,!0),this[n]=t,this.length=this.length+1,this.UpdateMaxElementHeight(t))},i.prototype.Remove=function(n){var i=this.indexOf(n);return i>-1&&i<this.length?(this.shiftItems(i,!1),t.prototype.pop.call(this),!0):!1},i.prototype.RemoveAt=function(n){if(n>-1&&n<this.length){var i=this[n];return this.shiftItems(n,!1),t.prototype.pop.call(this),!0}return!1},i.prototype.Contains=function(n){var t=this.indexOf(n);return t>-1&&t<this.length},i.prototype.ToList=function(){for(var t=new e,n=0;n<this.length;n++)t.Add(this[n]);return t},i.prototype.Clear=function(){t.prototype.Clear.call(this);this.maxBaseLineOffset=0;this.maxTextElementHeight=Number.NaN;this.maxTextElementBaselineOffset=0;this.SkipClipImage=!1},i.prototype.UpdateMaxElement=function(){this.maxBaseLineOffset=0;this.maxTextElementHeight=Number.NaN;this.maxTextElementBaselineOffset=0;for(var n=0;n<this.Count;n++)this.UpdateMaxElementHeight(this[n])},i.prototype.UpdateMaxElementHeight=function(n){n instanceof c||n instanceof rt?(isNaN(this.maxTextElementHeight)&&(this.maxTextElementHeight=0),this.maxTextElementHeight<n.Height&&(this.maxTextElementHeight=n.Height,this.maxTextElementBaselineOffset=n instanceof c?n.BaselineOffset:n.BaselineOffset),this.maxBaseLineOffset<this.maxTextElementBaselineOffset&&(this.maxBaseLineOffset=this.maxTextElementBaselineOffset)):this.maxBaseLineOffset<n.Height&&(this.maxBaseLineOffset=n.Height)},i}(e);t.ElementCollection=su;it=function(){function n(n){this.ownerBase=n}return Object.defineProperty(n.prototype,"OwnerBase",{get:function(){return this.ownerBase},enumerable:!0,configurable:!0}),n.prototype.SetOwner=function(n){this.ownerBase=n},n.prototype.SetOwnerBase=function(n){this.ownerBase=n},n}();t.BaseNode=it;dt=function(t){function i(n){t.call(this,n)}return n(i,t),Object.defineProperty(i.prototype,"Owner",{get:function(){return this.OwnerBase},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"NextNode",{get:function(){return this.Owner instanceof ut?this.Owner.ChildNodes.GetNextNode(this):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PreviousNode",{get:function(){return this.Owner instanceof ut?this.Owner.ChildNodes.GetPreviousNode(this):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsComposite",{get:function(){return this instanceof ut},enumerable:!0,configurable:!0}),i.prototype.SetOwner=function(n){if(this.OwnerBase!=n&&this.OwnerBase instanceof ut){if(this instanceof u){var t=this;t.IsLinkedFieldCharacter()&&t.UnlinkFieldCharacter("",!1);this.OwnerBase.RemoveFieldCharacter(t);t.CheckUnlinkFieldCharacter("",!1)}this.OwnerBase.ChildNodes.Contains(this)&&this.OwnerBase.ChildNodes.Remove(this)}this.SetOwnerBase(n);n instanceof ut&&this instanceof u&&n.AttachFieldCharacter(this)},i.prototype.GetIndexInOwnerCollection=function(){var n=this.Owner;return n!=null?n.ChildNodes.indexOf(this):-1},i.prototype.GetTopLevelOwner=function(){for(var n=this;n.Owner instanceof i;)if(n=n.Owner,n instanceof pi)break;return n},i.prototype.GetOwnerDocument=function(){return this.GetTopLevelOwner()},i}(it);t.Node=dt;ut=function(t){function i(n){t.call(this,n);this.Fields=new e;this.FieldCharacter=new e}return n(i,t),i.prototype.SetOwner=function(n){this.OwnerBase!=n&&this.OwnerBase instanceof i&&(this.Fields.Count>0&&this.OwnerBase.RemoveFields(this),this.FieldCharacter.Count>0&&this.OwnerBase.RemoveFieldCharacter(this),this.OwnerBase.ChildNodes.Contains(this)&&this.OwnerBase.ChildNodes.Remove(this));this.SetOwnerBase(n);n instanceof i&&(this.FieldCharacter.Count>0&&this.Owner.AttachFieldCharacter(this),this.Fields.Count>0&&n.AddFields(this))},i.prototype.RemoveField=function(n){this.Fields.Remove(n);this.Owner instanceof i&&!(this instanceof s)&&this.Owner.RemoveField(n)},i.prototype.RemoveFields=function(n){var r,t,i,u;if(!(n instanceof s))for(r=n.GetHierarchicalIndex(""),t=0;t<n.Fields.Count;t++)i=n.Fields[t],u=n.Fields.Count,i.IsUnlinkFieldCharacters(r)&&i.UnlinkFieldCharacter(r,!0),this.RemoveField(i),u>n.Fields.Count&&(t-=u-n.Fields.Count),t<-1&&(t=-1)},i.prototype.ClearUnlinkedFields=function(){var i=this.GetOwnerDocument(),n,t;if(i!=null)for(n=0;n<this.FieldCharacter.Count;n++)t=this.FieldCharacter[n],t.OwnerParagraph.Inlines.Remove(t),this.FieldCharacter.Remove(t),n--},i.prototype.AttachFieldCharacter=function(n){var t,r,f;if(n instanceof u)this.LinkFieldCharacters(n,n)||this.AddFieldCharacter(n);else if(n instanceof i){if(n instanceof s)return;for(t=0;t<n.FieldCharacter.Count;t++)r=n.FieldCharacter.Count,f=n.FieldCharacter[t],this.LinkFieldCharacters(f,n)?(r>n.FieldCharacter.Count&&(t-=r-n.FieldCharacter.Count),t<-1&&(t=-1)):this.AddFieldCharacter(f)}},i.prototype.LinkFieldCharacters=function(n,t){var e={nestingLevel:0},r,i,u;if(n instanceof f){if(r=n,r.fieldEnd==null&&this.LinkFieldTraversingForward(r,e,t),r.fieldEnd!=null)return r.AddToLinkedFields(),!0}else if(n instanceof ui){if(i=n,i.fieldBegin==null&&this.LinkFieldTraversingBackward(i,e,t),i.fieldBegin!=null&&(i.fieldEnd==null&&this.LinkFieldTraversingForward(i.fieldBegin,e,t)&&(i.fieldEnd=i.fieldBegin.fieldEnd),i.fieldEnd!=null))return i.fieldBegin.AddToLinkedFields(),!0}else if(n instanceof h&&(u=n,u.fieldBegin==null&&this.LinkFieldTraversingBackward(u,e,t),u.fieldBegin!=null))return u.fieldBegin.AddToLinkedFields(),!0;return!1},i.prototype.LinkFieldTraversingForward=function(n,t,r){var c=0,o,e,l;for(this.ChildNodes.indexOf(r)!=-1&&(c=this.ChildNodes.indexOf(r)+1),o=c;o<this.ChildNodes.length;o++)if(e=this.ChildNodes[o],e instanceof i){if(l=e.LinkFieldTraversingForward(n,t,null),n.fieldEnd!=null||l)return!0}else if(e instanceof u)if(e instanceof f&&n!=e&&t.nestingLevel++,e instanceof h){if(t.nestingLevel==0)return e.fieldBegin==null&&(n.fieldEnd=e),n.fieldEnd!=null;t.nestingLevel--}else if(t.nestingLevel==0&&n.fieldSeparator==null&&e instanceof ui)if(e.fieldBegin==null){if(n.fieldSeparator=e,e.fieldEnd!=null)return n.fieldEnd=e.fieldEnd,!0}else return!1;return this.Owner instanceof i&&!(this instanceof s)?this.Owner.LinkFieldTraversingForward(n,t,this):!0},i.prototype.LinkFieldTraversingBackward=function(n,t,r){var o,a,l,c,e,v;if(n instanceof h){for(o=n,l=this.ChildNodes.length-1,this.ChildNodes.indexOf(r)!=-1&&(l=this.ChildNodes.indexOf(r)-1),c=l;c>=0;c--)if(e=this.ChildNodes[c],e instanceof i){if(v=e.LinkFieldTraversingBackward(o,t,null),o.fieldBegin!=null||v)return!0}else if(e instanceof u)if(e instanceof h&&o!=e&&t.nestingLevel++,e instanceof f){if(t.nestingLevel==0)return e.fieldEnd==null&&(o.fieldBegin=e),o.fieldBegin!=null;t.nestingLevel--}else if(t.nestingLevel==0)if(e.fieldEnd==null){if(o.fieldSeparator=e,e.fieldBegin!=null)return o.fieldBegin=e.fieldBegin,!0}else return!1;return this.Owner instanceof i&&!(this instanceof s)?this.Owner.LinkFieldTraversingBackward(o,t,this):!0}if(n instanceof ui){for(a=n,l=this.ChildNodes.length-1,this.ChildNodes.indexOf(r)!=-1&&(l=this.ChildNodes.indexOf(r)-1),c=l;c>=0;c--)if(e=this.ChildNodes[c],e instanceof i){if(v=e.LinkFieldTraversingBackward(a,t,null),a.fieldBegin!=null||v)return!0}else if(e instanceof u)if(e instanceof h&&t.nestingLevel++,e instanceof f){if(t.nestingLevel==0)return e.fieldSeparator==null&&(a.fieldBegin=e),a.fieldBegin!=null;t.nestingLevel--}else if(t.nestingLevel==0)return!1;return this.Owner instanceof i&&!(this instanceof s)?this.Owner.LinkFieldTraversingBackward(a,t,this):!0}},i.prototype.AddFields=function(n){if(n instanceof f)this.Fields.Add(n),this.Owner instanceof i&&!(this instanceof s)&&this.Owner.AddFields(n);else if(n instanceof i){if(n instanceof s)return;for(var t=0;t<n.Fields.Count;t++)this.AddFields(n.Fields[t])}},i.prototype.AddFieldCharacter=function(n){if(n instanceof u)this.FieldCharacter.Add(n),this.Owner instanceof i&&!(this instanceof s)&&this.Owner.AttachFieldCharacter(n);else if(n instanceof i){if(n instanceof s)return;for(var t=0;t<n.FieldCharacter.Count;t++)this.AddFieldCharacter(n.FieldCharacter[t])}},i.prototype.RemoveFieldCharacter=function(n){var e,t,r,f;if(n instanceof u)this.FieldCharacter.Contains(n)&&(this.FieldCharacter.Remove(n),this.Owner instanceof i&&!(this instanceof s)&&this.Owner.RemoveFieldCharacter(n));else if(n instanceof i){if(n instanceof s)return;for(e=n.GetHierarchicalIndex(""),t=0;t<n.FieldCharacter.Count;t++)r=n.FieldCharacter[t],f=n.FieldCharacter.Count,r.CheckUnlinkFieldCharacter(e,!0),this.RemoveFieldCharacter(r),f>n.FieldCharacter.Count&&(t-=f-n.FieldCharacter.Count),t<-1&&(t=-1)}},i.prototype.GetHierarchicalIndex=function(n){return this.Owner instanceof i&&(n=this instanceof cr?"HF;"+n:this.GetIndexInOwnerCollection()+";"+n,!(this.Owner instanceof pi))?this.Owner.GetHierarchicalIndex(n):n},i.prototype.GetFieldCode=function(n,t,r,e){var c="",a=0,l,o;for(this.ChildNodes.Contains(e)&&(a=this.ChildNodes.IndexOf(e)+1),l=a;l<this.ChildNodes.Count;l++)if(o=this.ChildNodes[l],o instanceof i){if(c+=o.GetFieldCode(n,t,r,null),r)return c}else if(o instanceof u){if(o instanceof f&&(t=n.fieldEnd!=null&&n!=o),o instanceof h){if(n.fieldEnd==o)return r=!0,c;t=!1}else if(o instanceof ui){if(n.fieldSeparator==o)return r=!0,c;t=!1}}else o instanceof p&&!t&&(c+=o.Text);return this.Owner instanceof i&&!(this instanceof s)&&(c+=this.Owner.GetFieldCode(n,t,r,this)),c},i.prototype.GetHyperlinkField=function(n,t){for(var u,r=0;r<this.Fields.length;r++){if(t.Contains(this.Fields[r])||this.Fields[r].fieldSeparator==null)continue;else t.Add(this.Fields[r]);if(u=this.Fields[r].GetFieldCode(),u=u.trim().toLowerCase(),u.match("hyperlink ")&&this.Fields[r].InlineIsInFieldResult(n))return this.Fields[r]}return this.Owner instanceof i&&!(this instanceof s)?this.Owner.GetHyperlinkField(n,t):null},i.prototype.GetHyperlinkFields=function(n,t){for(var u,r=0;r<this.Fields.length;r++){if(t.Contains(this.Fields[r])||this.Fields[r].fieldSeparator==null)continue;else t.Add(this.Fields[r]);if(u=this.Fields[r].GetFieldCode(),u=u.trim().toLowerCase(),u.match("hyperlink ")&&this.Fields[r].ParagraphIsInFieldResult(n))return this.Fields[r]}return this.Owner instanceof i&&!(this instanceof s)?this.Owner.GetHyperlinkFields(n,t):null},i.prototype.GetParagraph=function(n){var u,o;if(n.Index==null||n.Index==undefined)return null;var c=this,t=n.Index.indexOf(";"),f="0";if(t>=0&&(f=n.Index.substring(0,t),n.Index=n.Index.substring(t).replace(";","")),this instanceof lt&&f=="HF")return c.HeaderFooters.GetParagraph(n);if(t=parseInt(f),this instanceof ri&&t>=this.ChildNodes.Count&&(n.Index="0;0",t=this.ChildNodes.Count-1),t>=0&&t<this.ChildNodes.Count){if(u=this.ChildNodes[t],u instanceof r){if(n.Index.indexOf("C;")>0){o=u;t=n.Index.indexOf(";");f=n.Index.substring(0,t);n.Index=n.Index.substring(t+2).replace(";","");var s=0,h=o.GetInline(parseFloat(f),s),e=h.inline;t=h.index;s==e.Length&&(e=e.NextNode)}return n.Index.indexOf(";")>0&&(n.Index="0"),u}if(u instanceof i)return n.Index.indexOf(";")>0?u.GetParagraph(n):u instanceof y?u.GetFirstParagraphInFirstCell():null}else if(this.NextNode instanceof i)return(n="0",this.NextNode instanceof y)?this.NextNode.GetFirstParagraphInFirstCell():this.NextNode;return null},i}(dt);t.CompositeNode=ut;wr=function(t){function i(){t.apply(this,arguments);this.notifyCollectionChanged=!1}return n(i,t),Object.defineProperty(i.prototype,"NotifyCollectionChanged",{get:function(){return this.notifyCollectionChanged},set:function(n){this.notifyCollectionChanged=n},enumerable:!0,configurable:!0}),i.prototype.push=function(n){return n!=null&&n!=undefined?(t.prototype.push.call(this,n),this.NotifyCollectionChanged&&this.CollectionChanged(n,!0),1):0},i.prototype.Add=function(n){return n!=null&&n!=undefined&&t.prototype.push.call(this,n),this.NotifyCollectionChanged&&this.CollectionChanged(n,!0),1},i.prototype.Insert=function(n,t){if(n==this.length){this.Add(t);return}n>-1&&n<this.length&&(this.shiftItems(n,!0),this[n]=t,this.length=this.length+1,this.CollectionChanged&&this.CollectionChanged(t,!0))},i.prototype.Remove=function(n){var i=this.indexOf(n);return i>-1&&i<this.length?(this.shiftItems(i,!1),t.prototype.pop.call(this),this.CollectionChanged&&this.CollectionChanged(n,!1),!0):!1},i.prototype.RemoveAt=function(n){if(n>-1&&n<this.length){var i=this[n];return this.shiftItems(n,!1),t.prototype.pop.call(this),this.CollectionChanged&&this.CollectionChanged(i,!1),!0}return!1},i}(e);t.ObservableCollection=wr;yi=function(t){function i(n){t.call(this);this.ownerBase=n;this.NotifyCollectionChanged=!0}return n(i,t),Object.defineProperty(i.prototype,"OwnerBase",{get:function(){return this.ownerBase},enumerable:!0,configurable:!0}),i.prototype.push=function(n){return this instanceof tr&&n instanceof ar||this instanceof ir&&n instanceof ai||this instanceof rr&&n instanceof at||this instanceof ur&&n instanceof si?(t.prototype.push.call(this,n),1):0},i.prototype.Add=function(n){return this instanceof tr&&n instanceof ar||this instanceof ir&&n instanceof ai||this instanceof rr&&n instanceof at||this instanceof ur&&n instanceof si?(t.prototype.push.call(this,n),1):0},i.prototype.CollectionChanged=function(n,t){t?n.SetOwnerBase(this.ownerBase):n instanceof it&&n.SetOwnerBase(null)},i.prototype.Dispose=function(){this.ownerBase=null;this.NotifyCollectionChanged=!1},i}(wr);t.BaseNodeCollection=yi;tr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(yi);t.ListAdvCollection=tr;ir=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(yi);t.AbstractListAdvCollection=ir;rr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(yi);t.ListLevelAdvCollection=rr;ur=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.Get=function(n){for(var i,t=0;t<this.length;t++)if(this[t]instanceof si&&(i=this[t],i.LevelNumber==n))return i;return null},i}(yi);t.LevelOverrideAdvCollection=ur;ii=function(t){function i(n){t.call(this);this.ownerNode=n;this.NotifyCollectionChanged=!0}return n(i,t),Object.defineProperty(i.prototype,"OwnerNode",{get:function(){return this.ownerNode},enumerable:!0,configurable:!0}),i.prototype.push=function(n){if(this instanceof fr&&n instanceof s||this instanceof er&&n instanceof lt||this instanceof ci&&n instanceof wi||this instanceof or&&n instanceof yt||this instanceof sr&&n instanceof ri||this instanceof hr&&n instanceof ht)return t.prototype.push.call(this,n),1},i.prototype.Add=function(n){return this instanceof fr&&n instanceof s||this instanceof er&&n instanceof lt||this instanceof ci&&n instanceof wi||this instanceof or&&n instanceof yt||this instanceof sr&&n instanceof ri||this instanceof hr&&n instanceof ht?(t.prototype.push.call(this,n),1):0},i.prototype.SetOwnerToNode=function(n,t){if(n.Owner instanceof ut){var i=n.Owner;this.indexOf(n)>-1?(this.NotifyCollectionChanged=!1,this.RemoveAt(t),i==this.OwnerNode&&(this.NotifyCollectionChanged=!0),i.ChildNodes.Remove(n),i==this.OwnerNode&&(this.NotifyCollectionChanged=!1),this.Insert(t,n),this.NotifyCollectionChanged=!0):i.ChildNodes.Remove(n)}n.SetOwner(this.OwnerNode)},i.prototype.GetNextNode=function(n){var t=this.indexOf(n);return t<0||t>this.length-2?null:this[t+1]},i.prototype.GetPreviousNode=function(n){var t=this.indexOf(n);return t<1||t>this.length-1?null:this[t-1]},i.prototype.Dispose=function(){this.ownerNode=null;this.NotifyCollectionChanged=!1},i}(wr);t.NodeCollection=ii;fr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof dt&&n.SetOwner(null)},i}(ii);t.HeaderFooterCollection=fr;er=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof dt&&n.SetOwner(null)},i}(ii);t.SectionAdvCollection=er;ci=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){var o,e,f,i,u,s;if(t){if(o=this.indexOf(n),this.SetOwnerToNode(n,o),n instanceof r&&n.Owner!=null)for(e=n,f=0;f<e.Inlines.Count;f++)i=e.Inlines[f],i instanceof p&&i.Text!=""&&i!=null&&i!=undefined&&(u=i.Text,u=u.replace("\r\n","\r"),u=u.replace("\n","\r"),s=u.indexOf("\r"),s>0&&n.SplitByBreakCharacter(e,i,f));o++}else n instanceof dt&&n.SetOwner(null)},i}(ii);t.BlockAdvCollection=ci;or=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){var u,i,r,e,f;t?(u=this.indexOf(n),this.SetOwnerToNode(n,u),n instanceof p&&n.OwnerParagraph!=null&&n.OwnerParagraph.Owner!=null&&(i=n,i.Text!="\t"&&i.Text!="\v"&&i.Text.length>=1&&n.SplitByTabOrLineBreakCharacter(u),i.Text!=""&&i.Text!=null&&(r=i.Text,r=r.replace("\r\n","\r"),r=r.replace("\n","\r"),e=r.indexOf("\r"),e>0&&(f=null,i.SplitByBreakCharacter(i,r,f,f))))):n instanceof dt&&n.SetOwner(null)},i}(ii);t.InlineCollection=or;hu=function(t){function i(){t.apply(this,arguments)}return n(i,t),i}(e);t.TableColumnAdvCollection=hu;sr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof dt&&n.SetOwner(null)},i}(ii);t.TableRowAdvCollection=sr;hr=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.CollectionChanged=function(n,t){if(t){var i=this.indexOf(n);this.SetOwnerToNode(n,i)}else n instanceof dt&&n.SetOwner(null)},i}(ii);t.TableCellAdvCollection=hr;pi=function(t){function i(n){t.call(this,n);this.defaultTabWidth=48;this.backgroundColor="#FFFFFF";this.ChildNodes=new er(this);this.lists=new tr(this);this.abstractLists=new ir(this);this.renderedListLevels=new e;this.renderedLevelOverrides=new e;this.renderedLists=new kt}return n(i,t),Object.defineProperty(i.prototype,"Sections",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Lists",{get:function(){return this.lists},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AbstractLists",{get:function(){return this.abstractLists},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerControl",{get:function(){return this.ownerControl},set:function(n){this.ownerControl=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DefaultTabWidth",{get:function(){return this.defaultTabWidth},set:function(n){this.defaultTabWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DocumentStart",{get:function(){return this.GetDocumentStart()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DocumentEnd",{get:function(){return this.GetDocumentEnd()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BackgroundColor",{get:function(){return this.backgroundColor},set:function(n){this.backgroundColor=n},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n){for(var i,t=0;t<this.Sections.length;t++)i=this.Sections[t],i.LayoutItems(n);n.UpdateScrollBars()},i.prototype.Dispose=function(){var t,i,n,r;if(this.ownerControl!=null&&(this.ownerControl=null),this.ChildNodes!=null)for(this.ChildNodes.Dispose(),n=0;n<this.Sections.Count;n++)t=this.Sections[n],t.Dispose(),this.Sections.Remove(t),n--;if(this.renderedListLevels!=null&&(this.renderedListLevels.Clear(),this.renderedListLevels=null),this.renderedLists!=null&&(this.renderedLists.Clear(),this.renderedLists=null),this.Lists!=null){for(n=0;n<this.Lists.Count;n++)i=this.Lists[n],i.Dispose(),this.lists.Remove(i),n--;this.lists.Dispose();this.lists=null}if(this.AbstractLists!=null){for(n=0;n<this.AbstractLists.Count;n++)r=this.AbstractLists[n],r.Dispose(),this.abstractLists.Remove(r),n--;this.abstractLists.Dispose();this.abstractLists=null}this.Fields=null;this.FieldCharacter=null},i.prototype.GetListByID=function(n){if(this.Lists==null)return null;for(var t=0;t<this.Lists.length;t++)if(this.Lists[t]!=null&&this.Lists[t].ListId==n)return this.Lists[t];return null},i.prototype.GetAbstractListAdvByID=function(n){if(this.AbstractLists==null)return null;for(var t=0;t<this.AbstractLists.length;t++)if(this.AbstractLists[t]!=null&&this.AbstractLists[t].AbstractListId==n)return this.AbstractLists[t];return null},i.prototype.AddListLevel=function(n){for(var t,r,i=n.Levels.Count;i<9;i++)t=new at(n),r=i%3,n.Levels[0].ListLevelPattern==v.Bullet?(t.ListLevelPattern=v.Bullet,t.NumberFormat=r==0?at.DOTBULLET:r==1?at.SQUAREBULLET:at.ARROWBULLET,t.CharacterFormat.FontFamily=t.NumberFormat==at.SQUAREBULLET?"Wingdings":"Symbol"):(t.ListLevelPattern=r,t.NumberFormat="%"+(i+1).toString()+".",t.StartAt=1,t.RestartLevel=i),t.ParagraphFormat=new di(t),t.ParagraphFormat.LeftIndent=48*(i+1),t.ParagraphFormat.FirstLineIndent=-24,n.Levels.Add(t)},i.prototype.GetListNumber=function(n){var t=n.List,i=n.ListLevelNumber,r=n.ListLevel,u=t.LevelOverrides!=null?t.LevelOverrides.Get(i):null,f;return u==null||this.renderedLevelOverrides.Contains(u)||u.OverrideListLevel!=null||(this.renderedLevelOverrides.Add(t.LevelOverrides[i]),this.renderedListLevels.Contains(r)&&this.renderedListLevels.Remove(r),this.renderedLists.ContainsKey(t.AbstractList)&&(f=this.renderedLists.Get(t.AbstractList),f.ContainsKey(i)&&f.Remove(i))),this.UpdateListValues(t,i),this.GetListText(t,i,r)},i.prototype.UpdateListValues=function(n,t){var o,f,u,i,r,e;if(this.renderedLists.ContainsKey(n.AbstractList))if(u=this.renderedLists.Get(n.AbstractList),u.ContainsKey(t))for(e=u.Get(t),u.Set(t,e+1),i=t+1;i<n.AbstractList.Levels.Count;)r=n.GetListLevel(i),r!=null&&u.ContainsKey(i)&&r.RestartLevel>t&&(u.Remove(i),this.renderedListLevels.Contains(r)&&this.renderedListLevels.Remove(r)),i++;else{for(i=t;!u.ContainsKey(i-1)&&i>0;)r=n.GetListLevel(i-1),r!=null&&(u.Add(i-1,n.GetListStartValue(i-1)),this.renderedListLevels.Contains(r)||this.renderedListLevels.Add(r)),i--;e=n.GetListStartValue(t);u.Add(t,e)}else for(o=new kt,this.renderedLists.Add(n.AbstractList,o),r=n.GetListLevel(t),f=0;f<=t;f++)o.Add(f,n.GetListStartValue(f))},i.prototype.GetListText=function(n,t,i){var r=i.NumberFormat,f,o,e;if(this.renderedLists.ContainsKey(n.AbstractList))for(f=this.renderedLists.Get(n.AbstractList),o=f.Keys,e=0;e<o.length;e++){var u=o[e],s="%"+(u+1).toString(),h=n.GetListLevel(u);if(r.match(s)){if(u>t)return"";r=f.ContainsKey(u)&&h!=null?r.replace(s,h.GetListText(f.Get(u))):r.replace(s,"0")}}return r},i.prototype.GetDocumentStart=function(){if(this.Sections.length==0||this.Sections[0].Blocks.length==0)return null;var t=null,n=this.Sections[0].Blocks[0];return n=n instanceof y?n.GetFirstParagraphInFirstCell():this.Sections[0].Blocks[0],n instanceof r&&(t=new ei(this.OwnerControl),t.SetPosition(n,!0)),t},i.prototype.GetDocumentEnd=function(){var i=null,u=this.DocumentStart,n,t,f;return u!=null&&this.Sections.Count>0&&(n=this.Sections.Last().Blocks.Last(),t=n,this.OwnerControl.IsDocumentLoaded||(t!=null&&(t=n.PreviousBlock),t==null&&this.Sections.Count>1&&(t=this.Sections[this.Sections.Count-2].Blocks.Last())),t!=null&&(n=t),n instanceof y&&(n=n.GetLastParagraphInLastCell()),n instanceof r?(f=t==null?0:n.GetEndOffset(),i=new ei(this.OwnerControl),i.SetPositionParagraph(n,f)):(i=new ei(this.OwnerControl),i.SetPositionParagraph(u.Paragraph,u.Paragraph.GetEndOffset()))),i},i.prototype.Find=function(n,t,i,r){var o,h,c,u,l,f,a;if(this.Sections.Count!=0&&!st.IsPatternEmpty(n)){var s=null,e=null;if(this.OwnerControl.Selection!=null&&this.OwnerControl.Selection.End!=null&&(e=this.OwnerControl.Selection.End),i&&e!=null&&e.Paragraph!=null&&(o=0,h=e.Paragraph.GetInline(this.OwnerControl.Selection.End.Offset,o),s=h.inline,o=h.index,s!=null&&(c=s.Find(n,t,o,i,e,r),c)))return!0;for(u=this.Sections[0];u!=null&&u.Blocks.Count==0;)u=u.NextNode;if(u!=null&&u.Blocks.Count!=0){for(l=u.Blocks[0],f=l.GetFirstParagraph();f!=null&&f.Inlines.Count==0;)f=f.GetNextParagraph();if(f!=null&&f.Inlines.Count!=0)return a=f.Inlines[0],a.Find(n,t,0,i,e,r)}}},i}(ut);t.DocumentAdv=pi;lt=function(t){function i(n){t.call(this,n);this.BodyWidgets=new e;this.ChildNodes=new ci(this);this.headerFooters=new cr(this);this.sectionformat=new yu(this)}return n(i,t),Object.defineProperty(i.prototype,"Blocks",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HeaderFooters",{get:function(){return this.headerFooters},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"SectionFormat",{get:function(){return this.sectionformat},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Document",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),i.prototype.AddBodyWidget=function(n){var t=new ni(this);return t.Width=n.Width,t.X=n.X,t.Y=n.Y,this.BodyWidgets.push(t),t},i.prototype.LayoutItems=function(n){var t,i;for(n.CreateNewPage(this),t=0;t<this.Blocks.length;t++)i=this.Blocks[t],n.UpdateClientAreaForBlock(i,!0),i.LayoutItems(n),n.UpdateClientAreaForBlock(i,!1)},i.prototype.GetCurrentHeaderFooter=function(n){return this.HeaderFooters.ChildNodes[n].Blocks.length==0&&this.PreviousNode!=null?this.PreviousNode.GetCurrentHeaderFooter(n):this.HeaderFooters.ChildNodes[n]},i.prototype.GetPreviousParagraph=function(){if(this.PreviousNode instanceof i){var n=this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1];return n instanceof r?n:n.GetLastParagraphInLastCell()}return null},i.prototype.GetNextParagraph=function(){if(this.NextNode instanceof i){var n=this.NextNode.Blocks[0];return n instanceof r?n:n.GetFirstParagraphInFirstCell()}return null},i.prototype.GetPreviousBlock=function(){return this.PreviousNode instanceof i?this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1]:null},i.prototype.GetNextSelection=function(n){if(this.NextNode instanceof i){var t=this.NextNode.Blocks[0];return t instanceof r?t:n.IsEmpty||n.IsForward?t.GetLastParagraphInFirstRow():t.Rows[0].GetNextParagraphSelection(n)}return null},i.prototype.GetPreviousSelection=function(n){if(this.PreviousNode instanceof i){var t=this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1];return t instanceof r?t:n.IsForward?t.Rows[t.Rows.Count-1].GetPreviousParagraphSelection(n):t.GetFirstParagraphInLastRow()}return null},i.prototype.Dispose=function(){var t,n,i;if(this.SectionFormat.Dispose(),this.HeaderFooters.Dispose(),this.SetOwner(null),this.BodyWidgets!=null){for(n=0;n<this.BodyWidgets.Count;n++)t=this.BodyWidgets[n],t.Dispose(),this.BodyWidgets.Remove(t),n--;this.BodyWidgets=null}if(this.Blocks!=null){for(this.Blocks.Dispose(),n=0;n<this.Blocks.Count;n++)i=this.Blocks[n],i.Dispose(),this.Blocks.Remove(i),n--;this.ChildNodes=null}this.Fields=null;this.FieldCharacter=null},i}(ut);t.SectionAdv=lt;s=function(t){function i(n){t.call(this,n);this.ChildNodes=new ci(this);this.LayoutedWidgets=new e}return n(i,t),Object.defineProperty(i.prototype,"Blocks",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Type",{get:function(){return this.type},set:function(n){this.type=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Document",{get:function(){return this.Section==null?null:this.Section.Document},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Section",{get:function(){return this.Owner instanceof cr?this.Owner.Section:null},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n){var t=new tu(this),r,i;for(t.Page=n.CurrentRenderingPage,this.LayoutedWidgets.push(t),t.UpdateClientAreaLocation(n.ClientActiveArea),r=0;r<this.Blocks.length;r++)i=this.Blocks[r],i instanceof y&&i.TableWidgets.Clear(),n.UpdateClientAreaForBlock(i,!0),i.LayoutItems(n),n.UpdateClientAreaForBlock(i,!1);return t.Height=n.ClientActiveArea.Top-n.ClientArea.Top,(this.type==ot.OddFooter||this.type==ot.EvenFooter||this.type==ot.FirstPageFooter)&&t.ShiftChildLocation(n.ClientArea.Top-n.ClientActiveArea.Top),t},i.prototype.ClearWidgets=function(){for(var t,n=0;n<this.LayoutedWidgets.Count;n++)t=this.LayoutedWidgets[n],t.Dispose(),this.LayoutedWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.Blocks!=null){for(this.Blocks.Dispose(),n=0;n<this.Blocks.Count;n++)t=this.Blocks[n],t.Dispose(),this.Blocks.Remove(t),n--;this.ChildNodes=null}this.Fields=null;this.FieldCharacter=null;this.LayoutedWidgets!=null&&(this.ClearWidgets(),this.LayoutedWidgets=null)},i}(ut);t.HeaderFooter=s;cr=function(t){function i(n){var i,r,u,f,e,o;t.call(this,n);this.ChildNodes=new fr(this);i=new s(null);i.Type=ot.EvenHeader;this.ChildNodes.push(i);r=new s(null);r.Type=ot.OddHeader;this.ChildNodes.push(r);u=new s(null);u.Type=ot.EvenFooter;this.ChildNodes.push(u);f=new s(null);f.Type=ot.OddFooter;this.ChildNodes.push(f);e=new s(null);e.Type=ot.FirstPageHeader;this.ChildNodes.push(e);o=new s(null);o.Type=ot.FirstPageFooter;this.ChildNodes.push(o)}return n(i,t),Object.defineProperty(i.prototype,"EvenHeader",{get:function(){return this.ChildNodes[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Header",{get:function(){return this.ChildNodes[1]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"EvenFooter",{get:function(){return this.ChildNodes[2]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Footer",{get:function(){return this.ChildNodes[3]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FirstPageHeader",{get:function(){return this.ChildNodes[4]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FirstPageFooter",{get:function(){return this.ChildNodes[5]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Document",{get:function(){return this.Section==null?null:this.Section.Document},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Section",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.ChildNodes!=null){for(this.ChildNodes.Dispose(),n=0;n<this.ChildNodes.Count;n++)t=this.ChildNodes[n],t.Dispose(),this.ChildNodes.Remove(t),n--;this.ChildNodes=null}this.Fields=null;this.FieldCharacter=null},i}(ut);t.HeaderFooters=cr;wi=function(t){function i(){t.apply(this,arguments)}return n(i,t),Object.defineProperty(i.prototype,"PreviousBlock",{get:function(){return this.PreviousNode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"NextBlock",{get:function(){return this.NextNode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Section",{get:function(){return this.Owner instanceof ht?this.Owner.Section:this.Owner instanceof s?this.Owner.Section:this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsInsideTable",{get:function(){return this.Owner instanceof ht},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AssociatedCell",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Document",{get:function(){return this.Section!=null?this.Section.Document:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftIndent",{get:function(){var n=this;return n instanceof r?n.ParagraphFormat.LeftIndent:n instanceof y?n.TableFormat.LeftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightIndent",{get:function(){var n=this;return n instanceof r?n.ParagraphFormat.RightIndent:0},enumerable:!0,configurable:!0}),i.prototype._UpdateWidgetsToBody=function(n,t){var h=this,f,u,s,i,o,e,c,l;n.CurrentHeaderFooter==null?(t.ContainerWidget!=null&&t.ContainerWidget.ChildWidgets.Contains(t)&&(t.ContainerWidget.ChildWidgets.Remove(t),t.ContainerWidget.Height-=t.Height),f=null,u=null,u=this.Section.BodyWidgets,s=void 0,s=h instanceof r?h.ParagraphWidgets:h.TableWidgets,s.Count>1?(i=s[s.Count-2].ContainerWidget,e=u.IndexOf(i),f=e+1<u.Count?u[e+1]:u[u.Count-1],f.ChildWidgets.Insert(0,t),t.ContainerWidget=f,f.Height+=t.Height):(i=null,o=0,this.PreviousBlock instanceof r?(i=this.PreviousBlock.ParagraphWidgets[this.PreviousBlock.ParagraphWidgets.Count-1].ContainerWidget,o=i.ChildWidgets.IndexOf(this.PreviousBlock.ParagraphWidgets[this.PreviousBlock.ParagraphWidgets.Count-1])):this.PreviousBlock instanceof y&&(i=this.PreviousBlock.TableWidgets[this.PreviousBlock.TableWidgets.Count-1].ContainerWidget,o=i.ChildWidgets.IndexOf(this.PreviousBlock.TableWidgets[this.PreviousBlock.TableWidgets.Count-1])),i!=null&&w.Round(t.Y,2)==w.Round(i.ChildWidgets[o].Y+i.ChildWidgets[o].Height,2)?(i.ChildWidgets.Insert(o+1,t),t.ContainerWidget=i,i.Height+=t.Height):(e=0,c=this.Document.DocumentStart,(c==null||c.Paragraph.IsInsideTable&&this instanceof y&&h.Contains(c.Paragraph.AssociatedCell))&&(e=-1),i!=null&&(e=u.IndexOf(i)),f=e+1<u.Count?u[e+1]:u[u.Count-1],f.ChildWidgets.Insert(0,t),t.ContainerWidget=f,f.Height+=t.Height))):(l=n.CurrentHeaderFooter.LayoutedWidgets[n.CurrentHeaderFooter.LayoutedWidgets.Count-1],l.ChildWidgets.Add(t),t.ContainerWidget=l)},i.prototype.GetContainerTable=function(){var n=this;return this.IsInsideTable&&(n=this.AssociatedCell.OwnerTable.IsInsideTable?this.AssociatedCell.OwnerTable.GetContainerTable():this.AssociatedCell.OwnerTable),n},i.prototype.IsExistBefore=function(n){var i,t,r,u;return this.IsInsideTable?(i=this.AssociatedCell,n.IsInsideTable?(t=n.AssociatedCell,i==t)?i.Blocks.IndexOf(this)<i.Blocks.IndexOf(n):i.OwnerRow==t.OwnerRow?i.CellIndex<t.CellIndex:i.OwnerTable==t.OwnerTable?i.OwnerRow.RowIndex<t.OwnerRow.RowIndex:(r=i.GetContainerCellOf(t),r.OwnerTable.Contains(t))?(i=i.GetSelectedCell(r),t=t.GetSelectedCell(r),i==r)?this.IsExistBefore(t.OwnerTable):t==r?i.OwnerTable.IsExistBefore(n):r.OwnerRow==t.OwnerRow?r.CellIndex<t.CellIndex:r.OwnerTable==t.OwnerTable?r.OwnerRow.RowIndex<t.OwnerRow.RowIndex:i.OwnerTable.IsExistBefore(t.OwnerTable):r.OwnerTable.IsExistBefore(t.OwnerTable.GetContainerTable()):(u=this.GetContainerTable(),u.IsExistBefore(n))):n.IsInsideTable?(u=n.GetContainerTable(),this.IsExistBefore(u)):this.Owner instanceof s?this.Owner.Blocks.indexOf(this)<n.Owner.Blocks.indexOf(n):this.Section==n.Section?this.Section.Blocks.indexOf(this)<this.Section.Blocks.indexOf(n):this.Document.Sections.indexOf(this.Section)<this.Document.Sections.indexOf(n.Section)},i.prototype.IsExistAfter=function(n){var i,t,r,u;return this.IsInsideTable?(i=this.AssociatedCell,n.IsInsideTable?(t=n.AssociatedCell,i==t)?i.Blocks.IndexOf(this)>i.Blocks.IndexOf(n):i.OwnerRow==t.OwnerRow?i.CellIndex>t.CellIndex:i.OwnerTable==t.OwnerTable?i.OwnerRow.RowIndex>t.OwnerRow.RowIndex:(r=i.GetContainerCellOf(t),r.OwnerTable.Contains(t))?(i=i.GetSelectedCell(r),t=t.GetSelectedCell(r),i==r)?this.IsExistAfter(t.OwnerTable):t==r?i.OwnerTable.IsExistAfter(n):r.OwnerRow==t.OwnerRow?r.CellIndex>t.CellIndex:r.OwnerTable==t.OwnerTable?r.OwnerRow.RowIndex>t.OwnerRow.RowIndex:i.OwnerTable.IsExistAfter(t.OwnerTable):r.OwnerTable.IsExistAfter(t.OwnerTable.GetContainerTable()):(u=this.GetContainerTable(),u.IsExistAfter(n))):n.IsInsideTable?(u=n.GetContainerTable(),this.IsExistAfter(u)):this.Owner instanceof s?this.Owner.Blocks.IndexOf(this)>n.Owner.Blocks.IndexOf(n):this.Section==n.Section?this.Section.Blocks.IndexOf(this)>this.Section.Blocks.IndexOf(n):this.Document.Sections.IndexOf(this.Section)>this.Document.Sections.IndexOf(n.Section)},i.prototype.GetNextParagraph=function(){return this.NextBlock instanceof r?this.NextBlock:this.NextBlock instanceof y?this.NextBlock.GetFirstParagraphInFirstCell():this.Owner instanceof ht?this.Owner.GetNextParagraph():this.Owner instanceof lt?this.Owner.GetNextParagraph():null},i.prototype.GetFirstParagraph=function(){var n=this;return n instanceof r?n:n instanceof y?n.GetFirstParagraphInFirstCell():null},i.prototype.GetLastParagraph=function(){var n=this;return n instanceof r?n:n instanceof y?n.GetLastParagraphInLastCell():null},i.prototype.GetPreviousParagraph=function(){return this.PreviousBlock instanceof r?this.PreviousBlock:this.PreviousBlock instanceof y?this.PreviousBlock.GetLastParagraphInLastCell():this.Owner instanceof ht?this.Owner.GetPreviousParagraph():this.Owner instanceof lt?this.Owner.GetPreviousParagraph():null},i.prototype.GetPreviousBlock=function(){if(this.PreviousBlock==null){if(this.Owner instanceof ht)return this.Owner.OwnerTable.GetPreviousBlock();if(this.Owner instanceof lt)return this.Owner.GetPreviousBlock()}return this.PreviousBlock},i.prototype.GetNextRenderedBlock=function(){return this.NextBlock==null&&this.Owner instanceof lt&&this.Owner.NextNode!=null?this.Owner.NextNode.Blocks[0]:this.NextBlock},i.prototype.GetPreviousSelection=function(n){return this.PreviousBlock instanceof r?this.PreviousBlock:this.PreviousBlock instanceof y?n.IsForward?this.PreviousBlock.Rows[this.PreviousBlock.Rows.Count-1].GetPreviousParagraphSelection(n):this.PreviousBlock.GetFirstParagraphInLastRow():this.Owner instanceof ht?this.Owner.GetPreviousSelection(n):this.Owner instanceof lt?this.Owner.GetPreviousSelection(n):null},i.prototype.GetNextSelection=function(n){return this.NextBlock instanceof r?this.NextBlock:this.NextBlock instanceof y?n.IsEmpty||n.IsForward?this.NextBlock.GetLastParagraphInFirstRow():this.NextBlock.Rows[0].GetNextParagraphSelection(n):this.Owner instanceof ht?this.Owner.GetNextSelection(n):this.Owner instanceof lt?this.Owner.GetNextSelection(n):null},i}(ut);t.BlockAdv=wi;y=function(t){function i(n){t.call(this,n);this.flags=0;this.headerHeight=0;this.tableholder=null;this.ChildNodes=new sr(this);this.TableFormat=new wt(this);this.TableHolder=new wu;this.SpannedRowCollection=new kt;this.TableWidgets=new e}return n(i,t),Object.defineProperty(i.prototype,"TableHolder",{get:function(){return this.tableholder},set:function(n){this.tableholder=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Rows",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Title",{get:function(){return this.title},set:function(n){this.title=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Description",{get:function(){return this.description},set:function(n){this.description=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TableWidth",{get:function(){return this.Rows==null?0:this.GetTableWidth()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ContinueHeader",{get:function(){return(this.flags&2)>>1!=0},set:function(n){this.flags=this.flags&253|(n?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Header",{get:function(){return(this.flags&1)!=0},set:function(n){this.flags=this.flags&254|(n?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HeaderHeight",{get:function(){return this.headerHeight},set:function(n){this.headerHeight=n},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n){var t,i;for(this.TableWidgets!=null&&this.TableWidgets.length>0&&this.TableWidgets.Clear(),this.AddColumns(),this.AddTableWidget(n.ClientActiveArea),n.UpdateClientAreaTopOrLeft(this.TableWidgets[this.TableWidgets.Count-1],!0),this.Rows.Count>0&&this.Rows[0].RowFormat.IsHeader?(this.Header=!0,this.ContinueHeader=!0,this.HeaderHeight=0):(this.Header=!1,this.ContinueHeader=!1,this.HeaderHeight=0),t=0;t<this.Rows.length;t++)i=this.Rows[t],i.LayoutItems(n);this.UpdateWidgetsToPage(n)},i.prototype.GetHeader=function(){for(var t,i=null,r=!0,n=0;n<this.Rows.length;n++)if(t=this.Rows[n],t.RowFormat.IsHeader?i=t:r=!1,!r)break;return i},i.prototype.GetTableWidth=function(){for(var u,n,t,f,i=0,r=0;r<this.Rows.length;r++){for(u=this.Rows[r],n=0,t=0;t<u.Cells.length;t++)f=u.Cells[t],n+=f.CellFormat.CellWidth;i<n&&(i=n)}return i},i.prototype.AddTableWidget=function(n){var t=new ti(this);t.Width=n.Width;t.X=n.X;t.Y=n.Y;this.TableWidgets.Add(t);this.IsInsideTable||(t.Width=this.GetTableWidth());this.TableFormat.CellSpacing>0&&(t.Height=t.Height+this.TableFormat.CellSpacing,t.LeftBorderWidth=this.TableFormat.Borders.GetTableLeftBorder().GetLineWidth(),t.RightBorderWidth=this.TableFormat.Borders.GetTableRightBorder().GetLineWidth(),t.TopBorderWidth=this.TableFormat.Borders.GetTableTopBorder().GetLineWidth(),t.BottomBorderWidth=this.TableFormat.Borders.GetTableBottomBorder().GetLineWidth(),t.X+=t.LeftBorderWidth,t.Y+=t.TopBorderWidth,t.Width-=t.LeftBorderWidth,t.Width-=t.RightBorderWidth)},i.prototype.AddColumns=function(){var y,h,s,r,p,l,a,w,u,c;this.TableHolder.Columns.Clear();var t=new e,v=0,n=new e;for(u=0;u<this.Rows.length;u++){var f=this.Rows[u],i=f.GridBefore,o=0;for(t.Contains(o)||t.Add(o),o+=f.GridBeforeWidth*15,y=Math.round(o),t.Contains(y)||t.Add(y),h=0;h<f.Cells.length;h++){for(s=f.Cells[h],n.length==0&&(s.ColumnIndex=i),r=0;r<n.length;r++){if(n[r].ColumnIndex<i){s.ColumnIndex=i;continue}p=1;l=!0;p=n[r].CellFormat.RowSpan;n[r].ColumnIndex>i?(s.ColumnIndex=i,l=!1,h==f.Cells.length-1&&f.GridAfter>0&&(o+=n[r].CellFormat.CellWidth*15)):(s.ColumnIndex=i=this.TableHolder.Columns.indexOf(n[r].OwnerColumn)+n[r].CellFormat.ColumnSpan,o+=n[r].CellFormat.CellWidth*15);l||h!=f.Cells.length-1||(l=!0);l&&u-n[r].OwnerRow.RowIndex==p-1&&(n.RemoveAt(r),r--)}if(s.CellFormat.RowSpan>1)if(n.length==0||n[n.length-1].ColumnIndex<=i)n.Add(s);else for(a=n.length;a>0;a--)n[a-1].ColumnIndex>i&&n.Insert(a-1,s);if(i+=s.CellFormat.ColumnSpan,o+=s.CellFormat.CellWidth*15,w=Math.round(o),t.Contains(w)||t.Add(w),h==f.Cells.length-1&&f.GridAfterWidth>0&&(o+=f.GridAfterWidth*15,t.Contains(Math.round(o))||t.Add(Math.round(o)),i+=f.GridAfter),v=Math.max(v,i-1),this.TableHolder.Columns.length<i)for(c=new br,this.TableHolder.Columns.Add(c);this.TableHolder.Columns.length<i;)c=new br,this.TableHolder.Columns.Add(c)}}for(t.Sort(),u=0;u<t.length-1;u++)c=this.TableHolder.Columns[u],c.PreferredWidth=(t[u+1]-t[u])/15;for(t.Clear();v+1<this.TableHolder.Columns.length;)this.TableHolder.Columns.RemoveAt(this.TableHolder.Columns.length-1)},i.prototype.UpdateWidgetsToPage=function(n){var t=this.TableWidgets[this.TableWidgets.length-1];this.IsInsideTable?(this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.length-1].ChildWidgets.push(t),t.ContainerWidget=this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.length-1],this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.Count-1].Height=this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.Count-1].Height+t.Height):(this._UpdateWidgetsToBody(n,t),t.UpdateHeight(n),t.ChildWidgets.Count>0&&t.Y!=t.ChildWidgets[0].Y&&(t.Y=t.ChildWidgets[0].Y));this.TableFormat.CellSpacing>0&&(t.Y+t.Height+this.TableFormat.CellSpacing>n.ClientArea.Bottom&&n instanceof ft&&(t.Height=t.Height-this.TableFormat.CellSpacing/2),n.CutFromTop(t.Y+t.Height))},i.prototype.GetLastBlockInLastCell=function(){var n=this,t,i;return n.Rows.Count>0?(t=n.Rows[n.Rows.Count-1],i=t.Cells[t.Cells.Count-1],i.Blocks[i.Blocks.Count-1]):null},i.prototype.GetLastParagraphInFirstRow=function(){var t=this;if(t.Rows.Count>0){var i=t.Rows[0],u=i.Cells[i.Cells.Count-1],n=u.Blocks[u.Blocks.Count-1];return n instanceof r?n:n.GetLastParagraphInLastCell()}return null},i.prototype.GetLastParagraphInLastCell=function(){var n=this;if(n.Rows.Count>0){var i=n.Rows[n.Rows.Count-1],u=i.Cells[i.Cells.Count-1],t=u.Blocks[u.Blocks.Count-1];return t instanceof r?t:t.GetLastParagraphInLastCell()}return null},i.prototype.GetFirstParagraphInFirstCell=function(){var u=this,t,i,n;return u.Rows.length>0&&(t=u.Rows[0],t.Cells.length>0&&(i=t.Cells[0],i.Blocks.length>0))?(n=i.Blocks[0],n instanceof r?n:n.GetFirstParagraphInFirstCell()):null},i.prototype.GetFirstBlockInFirstCell=function(){var i=this,n,t;return i.Rows.length>0&&(n=i.Rows[0],n.Cells.Count>0)?(t=n.Cells[0],t.Blocks.Count==0)?null:t.Blocks[0]:null},i.prototype.Contains=function(n){if(this==n.OwnerTable)return!0;while(n.OwnerTable.IsInsideTable){if(this==n.OwnerTable)return!0;n=n.OwnerTable.AssociatedCell}return this==n.OwnerTable},i.prototype.HighlightCells=function(n,t,i,r){var u=i.OwnerRow.GetCellLeft(i),f=u+i.CellFormat.CellWidth,o=r.OwnerRow.GetCellLeft(r),s=o+r.CellFormat.CellWidth,h,e;for(u>o&&(u=o),f<s&&(f=s),u>n.UpDownSelectionLength&&(u=n.UpDownSelectionLength),f<n.UpDownSelectionLength&&(f=n.UpDownSelectionLength),h=this.Rows.IndexOf(r.OwnerRow),e=this.Rows.IndexOf(i.OwnerRow);e<=h;e++)this.Rows[e].Highlight(n,t,u,f)},i.prototype.Highlight=function(n,t,i,r){if(this.Rows[0].HighlightInternal(n,t,i,r),!r.Paragraph.IsInsideTable||!this.Contains(r.Paragraph.AssociatedCell)){var u=this.GetNextRenderedBlock();u.Highlight(n,t,i,r)}},i.prototype.GetSelectedContentAsHtml=function(n,t,i){var r="<table ",u;return r+=this.TableFormat.GetAsHtmlStyle(),r+=">",r+=this.Rows[0].GetSelectedContentAsHtml(n,t,i),r+="<\/table>",i.Paragraph.IsInsideTable&&this.Contains(i.Paragraph.AssociatedCell)||(u=this.GetNextRenderedBlock(),r+=u.GetSelectedContentAsHtml(n,t,i)),r},i.prototype.GetSelectedContentAsHtmlInternal=function(n,t,i){var r=t.OwnerRow.GetCellLeft(t),u=r+t.CellFormat.CellWidth,e=i.OwnerRow.GetCellLeft(i),s=e+i.CellFormat.CellWidth,h,o,f;for(r>e&&(r=e),u<s&&(u=s),r>n.UpDownSelectionLength&&(r=n.UpDownSelectionLength),u<n.UpDownSelectionLength&&(u=n.UpDownSelectionLength),h=this.Rows.IndexOf(i.OwnerRow),o="",f=this.Rows.IndexOf(t.OwnerRow);f<=h;f++)o+=this.Rows[f].GetSelectedContentAsHtmlInternal(n,r,u);return o},i.prototype.GetContentAsHtml=function(){var n="<table ",t;for(n+=this.TableFormat.GetAsHtmlStyle(),n+=">",t=0;t<this.Rows.length;t++)n+=this.Rows[t].GetContentAsHtml();return n+"<\/table>"},i.prototype.GetFirstParagraphInLastRow=function(){if(this.Rows.Count>0){var t=this.Rows[this.Rows.Count-1],i=t.Cells[0],n=i.Blocks[0];return n instanceof r?n:n.GetFirstParagraphInFirstCell()}return null},i.prototype.GetCellInTable=function(n){while(n.OwnerTable.IsInsideTable){if(this==n.OwnerTable)return n;n=n.OwnerTable.AssociatedCell}return n},i.prototype.ClearWidgets=function(){var n,t;if(this.TableWidgets!=null&&this.TableWidgets.Count>0)for(n=0;n<this.TableWidgets.Count;n++)t=this.TableWidgets[n],t.Dispose(),this.TableWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.SpannedRowCollection!=null&&(this.SpannedRowCollection.Clear(),this.SpannedRowCollection=null),this.SetOwner(null),this.TableFormat.Dispose(),this.tableholder!=null&&(this.tableholder.Dispose(),this.tableholder=null),this.TableWidgets!=null&&(this.ClearWidgets(),this.TableWidgets=null),this.Rows!=null){for(this.Rows.Dispose(),n=0;n<this.Rows.Count;n++)t=this.Rows[n],t.Dispose(),this.Rows.Remove(t),n--;this.ChildNodes=null}this.Fields=null;this.FieldCharacter=null},i}(wi);t.TableAdv=y;ri=function(t){function i(n){t.call(this,n);this.gridBefore=0;this.gridBeforeWidth=0;this.gridAfter=0;this.gridAfterWidth=0;this.ChildNodes=new hr(this);this.RowFormat=new ru(this);this.TableRowWidgets=new e}return n(i,t),Object.defineProperty(i.prototype,"OwnerTable",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RowIndex",{get:function(){return this.OwnerTable!=null?this.OwnerTable.Rows.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridBefore",{get:function(){return this.gridBefore},set:function(n){this.gridBefore=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridBeforeWidth",{get:function(){return this.gridBeforeWidth},set:function(n){this.gridBeforeWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridAfter",{get:function(){return this.gridAfter},set:function(n){this.gridAfter=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"GridAfterWidth",{get:function(){return this.gridAfterWidth},set:function(n){this.gridAfterWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Cells",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n){var t,i;for(this.TableRowWidgets!=null&&this.TableRowWidgets.length>0&&this.TableRowWidgets.Clear(),this.AddTableRowWidget(n.ClientActiveArea),n.UpdateClientAreaForRow(this,!0),t=0;t<this.Cells.length;t++)i=this.Cells[t],i.LayoutItems(n,this.GetMaxTopOrBottomCellMargin(0)+this.TableRowWidgets[this.TableRowWidgets.Count-1].TopBorderWidth,this.GetMaxTopOrBottomCellMargin(1)+this.TableRowWidgets[this.TableRowWidgets.Count-1].BottomBorderWidth);n.UpdateClientAreaForRow(this,!1);this.UpdateWidgetsToTable(n)},i.prototype.AddTableRowWidget=function(n){var u=new bi(this),i,f,t,r;if(u.X=n.X+this.GridBeforeWidth,u.Y=n.Y,u.Width=n.Width,this.TableRowWidgets.Add(u),i=0,this.OwnerTable.TableFormat.CellSpacing>0){for(u.Height=u.Height+this.OwnerTable.TableFormat.CellSpacing,t=0;t<this.Cells.Count;t++)this.Cells[t].CellFormat!=null&&this.Cells[t].CellFormat.Borders!=null&&(r=this.Cells[t].CellFormat.Borders.GetCellBottomBorder(this.Cells[t]).GetLineWidth(),r>i&&(i=r));if(u.BottomBorderWidth=i,this.RowIndex>0&&this.PreviousNode!=null){for(f=this.PreviousNode,i=0,t=0;t<f.Cells.Count;t++)f.Cells[t].CellFormat!=null&&f.Cells[t].CellFormat.Borders!=null&&(r=f.Cells[t].CellFormat.Borders.GetCellBottomBorder(f.Cells[t]).GetLineWidth(),r>i&&(i=r));u.TopBorderWidth=i}}for(t=0;t<this.Cells.Count;t++)this.Cells[t].CellFormat!=null&&this.Cells[t].CellFormat.Borders!=null&&(r=this.Cells[t].CellFormat.Borders.GetCellTopBorder(this.Cells[t]).GetLineWidth(),r>i&&(i=r));if(u.TopBorderWidth=i,this.OwnerTable.TableFormat.CellSpacing<=0&&this.RowIndex==this.OwnerTable.Rows.Count-1){for(t=0;t<this.Cells.Count;t++)this.Cells[t].CellFormat!=null&&this.Cells[t].CellFormat.Borders!=null&&(r=this.Cells[t].CellFormat.Borders.GetCellBottomBorder(this.Cells[t]).GetLineWidth(),r>i&&(i=r));u.BottomBorderWidth=i}},i.prototype.GetHeaderHeight=function(n){var i=0,t,r;if(this.OwnerTable.Rows.Count>0&&n.Rows[0].RowFormat.IsHeader)for(t=0;t<n.Rows.Count;t++)if(r=n.Rows[t],r.RowFormat.IsHeader)i=i+r.GetRowHeight();else break;return i},i.prototype.GetRowHeight=function(){var n=0,t;if(this.RowFormat.HeightType==et.Exactly)n=this.RowFormat.Height;else if(this.TableRowWidgets.Count>0){for(t=0;t<this.TableRowWidgets.Count;t++)n=this.TableRowWidgets[t].Height+n;n=Math.max(n,this.RowFormat.Height)}return n},i.prototype.IsVerticalMergedCellContinue=function(){for(var i,n=0,t=0;t<this.Cells.Count;t++){if(i=this.Cells[t],n<i.ColumnIndex)return!0;n+=i.CellFormat.ColumnSpan}return n<this.OwnerTable.TableHolder.Columns.Count},i.prototype.UpdateWidgetsToTable=function(n){var tt=this.GetRowHeight(),h=!1,c=!0,o=et.Auto,p=0,b=this.TableRowWidgets.length-1,t=this.TableRowWidgets[b],it,u,l,rt,d,ut,k,v,f,ot,g,nt,s,e;for(h=this.RowFormat.IsHeader,c=this.RowFormat.AllowBreakAcrossPages,o=this.RowFormat.HeightType,this.OwnerTable.ContinueHeader&&!h&&(this.OwnerTable.ContinueHeader=!1),p=this.OwnerTable.TableFormat.CellSpacing;b<this.TableRowWidgets.length;){if(b=this.TableRowWidgets.length,this.OwnerTable.IsInsideTable||n.SplittedCellWidgets.length==0&&t.Y+t.Height+p<=n.ClientArea.Bottom)this.AddWidgetToTable(n,t);else{if(n.SplittedCellWidgets.length>0&&t.Y+t.Height<=n.ClientArea.Bottom&&(it=this.IsRowSpanEnd(n),!it)){this.AddWidgetToTable(n,t);continue}if(u=t,l=this.OwnerTable.TableWidgets[this.OwnerTable.TableWidgets.Count-1],tt+t.Y>n.ClientArea.Bottom)if(!c||h&&this.OwnerTable.ContinueHeader||o==et.Atleast&&this.RowFormat.Height<n.ClientArea.Bottom)if(tt+t.Y>n.ClientArea.Bottom){if((o==et.Atleast&&this.RowFormat.Height<n.ClientActiveArea.Height&&c||o!=et.Exactly&&t.Y==n.ClientArea.Y||o==et.Auto&&c)&&(u=this.SplitWidgets(t,n,u)),o==et.Exactly&&t.Y==n.ClientArea.Y&&(this.AddWidgetToTable(n,t),b++),h&&this.OwnerTable.ContinueHeader)for(this.OwnerTable.Header=!1,this.OwnerTable.ContinueHeader=!1,this.OwnerTable.HeaderHeight=0,s=n.Pages,e=0;e<s.Count;e++)s[e].RepeatHeaderRowTableWidget&&(s[e].RepeatHeaderRowTableWidget=!1)}else h&&this.OwnerTable.ContinueHeader?(this.AddWidgetToTable(n,t),this.OwnerTable.Header=!0):c||(this.AddWidgetToTable(n,t),this.OwnerTable.Header&&t.Height+this.OwnerTable.HeaderHeight<n.ClientArea.Bottom&&this.RowFormat.Height<n.ClientActiveArea.Bottom&&(t.X=t.X,t.Y=l.Y+this.OwnerTable.HeaderHeight,t.UpdateChildLocation(t.Y+this.OwnerTable.HeaderHeight)));else(o==et.Auto||o==et.Atleast)&&c?this.RowFormat.Height>n.ClientArea.Bottom&&t.Y!=n.ClientArea.Y||(u=this.SplitWidgets(t,n,u)):o==et.Exactly&&t.Y==n.ClientArea.Y&&(this.AddWidgetToTable(n,t),b++);else this.IsVerticalMergedCellContinue()&&c&&(u=this.SplitWidgets(t,n,u));u!=null&&(u!=t?(this.AddWidgetToTable(n,t),this.OwnerTable.UpdateWidgetsToPage(n),rt=this.OwnerTable.TableWidgets.IndexOf(t.ContainerWidget),rt+1>=this.OwnerTable.TableWidgets.length&&this.OwnerTable.AddTableWidget(n.ClientActiveArea),t=u):(this.RowIndex>0&&(this.OwnerTable.UpdateWidgetsToPage(n),this.PreviousNode instanceof i&&this.PreviousNode.TableRowWidgets.length>0?(d=this.PreviousNode.TableRowWidgets[this.PreviousNode.TableRowWidgets.length-1],w.Round(t.Y,2)==w.Round(d.Y+d.Height,2)?(ut=this.OwnerTable.TableWidgets.IndexOf(d.ContainerWidget),ut+1>=this.OwnerTable.TableWidgets.length&&this.OwnerTable.AddTableWidget(n.ClientActiveArea)):this.OwnerTable.AddTableWidget(n.ClientActiveArea)):this.OwnerTable.AddTableWidget(n.ClientActiveArea)),b--),l=this.OwnerTable.TableWidgets[this.OwnerTable.TableWidgets.Count-1],k=null,this.OwnerTable.TableWidgets.length>1?k=this.OwnerTable.TableWidgets[this.OwnerTable.TableWidgets.length-2].ContainerWidget:(v=this.OwnerTable.PreviousBlock,v instanceof r?k=v.ParagraphWidgets[v.ParagraphWidgets.length-1].ContainerWidget:v instanceof y&&(k=v.TableWidgets[v.TableWidgets.length-1].ContainerWidget)),f=0,k!=null&&(f=n.Pages.indexOf(k.Page)),f==n.Pages.length-1||n.Pages[f+1].Section!=this.OwnerTable.Section?(ot=n.CreateNewPage(this.OwnerTable.Section),n.Pages[f+1].Section!=this.OwnerTable.Section&&n.InsertPage(f+1,ot)):(n.Pages[f+1].BoundingRectangle=new a(n.Pages[f+1].BoundingRectangle.X,n.Pages[f].BoundingRectangle.Bottom+20,n.Pages[f+1].BoundingRectangle.Width,n.Pages[f+1].BoundingRectangle.Height),n.UpdateClientArea(this.OwnerTable.Section[0].SectionFormat)),this.OwnerTable.Header&&t.Height<n.ClientArea.Bottom?(n instanceof ft&&(n.CurrentRenderingPage.RepeatHeaderRowTableWidget=!0),n.UpdateClientAreaForBlock(this.OwnerTable,!0),u.X=u.X,u.Y=l.Y+this.OwnerTable.HeaderHeight,g=n instanceof ft?p/2:p,u.UpdateChildLocation(l.Y+this.OwnerTable.HeaderHeight-g)):(n.UpdateClientAreaForBlock(this.OwnerTable,!0),u.X=u.X,u.Y=l.Y,g=n instanceof ft?p/2:p,u.UpdateChildLocation(l.Y-g)))}if(h&&this.OwnerTable.ContinueHeader&&(this.OwnerTable.Header=!0,this.OwnerTable.HeaderHeight=tt+this.OwnerTable.HeaderHeight),h&&this.OwnerTable.GetHeader()!=null&&this.RowIndex==this.OwnerTable.GetHeader().RowIndex&&(nt=this.GetHeaderHeight(this.OwnerTable),(nt>this.OwnerTable.HeaderHeight||nt>this.OwnerTable.HeaderHeight)&&(this.OwnerTable.HeaderHeight=nt),this.OwnerTable.HeaderHeight>n.ClientArea.Height))for(this.OwnerTable.Header=!1,this.OwnerTable.ContinueHeader=!1,this.OwnerTable.HeaderHeight=0,s=n.Pages,e=0;e<s.Count;e++)s[e].RepeatHeaderRowTableWidget&&(s[e].RepeatHeaderRowTableWidget=!1);this.OwnerTable.TableWidgets.Count>2&&this.OwnerTable.Header&&t.Height<n.ClientActiveArea.Bottom&&!n.CurrentRenderingPage.RepeatHeaderRowTableWidget&&n instanceof ft&&(n.CurrentRenderingPage.RepeatHeaderRowTableWidget=!0)}},i.prototype.SplitWidgets=function(n,t,i){return n.IsFirstLineFit(t.ClientArea.Bottom)?(i=n.GetSplittedWidget(t.ClientArea.Bottom),(t.SplittedCellWidgets.length>0||i!=n)&&i.InsertSplittedCellWidgets(t)):i.InsertSplittedCellWidgets(t),i},i.prototype.AddWidgetToTable=function(n,t){var r=this.OwnerTable.TableWidgets[0],u=r.ChildWidgets.length,f=null,o=this.TableRowWidgets.indexOf(t),e,h,s;if(o>0?f=this.TableRowWidgets[o-1]:this.PreviousNode instanceof i&&this.PreviousNode.TableRowWidgets.length>0&&(f=this.PreviousNode.TableRowWidgets[this.PreviousNode.TableRowWidgets.length-1]),f==null){if(u>0){for(e=r.ChildWidgets.length-1;e>=0;e--)if(h=r.ChildWidgets[e],h.TableRow.RowIndex<t.TableRow.RowIndex){u=e+1;break}else u=e;u==0&&r.UpdateWidgetLocation(t)}}else r=f.ContainerWidget,u=r.ChildWidgets.length,r.ChildWidgets.IndexOf(f)>=0&&(u=r.ChildWidgets.IndexOf(f)+1),Math.round(t.Y)!=Math.round(f.Y+f.Height)&&(s=this.OwnerTable.TableWidgets.IndexOf(r),s+1>=this.OwnerTable.TableWidgets.length&&this.OwnerTable.AddTableWidget(n.ClientActiveArea),r=this.OwnerTable.TableWidgets[s+1],u=r.ChildWidgets.length),o>0&&(u=0);this.UpdateRowHeightBySpannedCell(r,t,u);this.UpdateRowHeightByCellSpacing(t,n);r.ChildWidgets.Insert(u,t);t.ContainerWidget=r;r.Height=r.Height+t.Height;r.ContainerWidget!=null&&r.ContainerWidget.ChildWidgets.IndexOf(r)>=0&&(r.ContainerWidget.Height+=t.Height);t.UpdateHeight(n,!1);n.CutFromTop(t.Y+t.Height)},i.prototype.UpdateRowHeightBySpannedCell=function(n,t,i){var u=1,e,r,f,o;if(n.ChildWidgets.length==0||i==0){this.UpdateRowHeight(t,t);return}for(r=0;r<t.ChildWidgets.length;r++)e=t.ChildWidgets[r],u=e.TableCell.CellFormat.RowSpan,u>1&&this.OwnerTable!=null&&(this.OwnerTable.SpannedRowCollection.ContainsKey(this.RowIndex+u-1)||this.OwnerTable.SpannedRowCollection.Add(this.RowIndex+u-1,this.RowIndex));if(this.OwnerTable!=null)for(r=0;r<this.OwnerTable.SpannedRowCollection.Count;r++)if(this.OwnerTable.SpannedRowCollection.Keys[r]==this.RowIndex){for(f=0;f<i;f++)o=n.ChildWidgets[f],this.UpdateRowHeight(o,t);this.OwnerTable.SpannedRowCollection.Remove(this.OwnerTable.SpannedRowCollection.Keys[r]);break}},i.prototype.UpdateRowHeight=function(n,t){for(var i,u,e=this.RowIndex,f=1,r=0;r<n.ChildWidgets.length;r++)i=n.ChildWidgets[r],f=i.TableCell.CellFormat.RowSpan,e-i.TableCell.OwnerRow.RowIndex==f-1&&(u=i.Y+i.Height+i.Margin.Bottom-t.Y,t.Height<u&&(t.Height=u))},i.prototype.UpdateRowHeightByCellSpacing=function(n,t){this.OwnerTable.TableFormat.CellSpacing>0&&this.OwnerTable.TableWidgets.Count>1&&n.Y==this.OwnerTable.Document.OwnerControl.Viewer.ClientArea.Top&&t instanceof ft&&(n.Height=n.Height-this.OwnerTable.TableFormat.CellSpacing/2)},i.prototype.IsRowSpanEnd=function(n){for(var i,u=this.RowIndex,r=1,t=0;t<n.SplittedCellWidgets.length;t++)if(i=n.SplittedCellWidgets[t],r=i.TableCell.CellFormat.RowSpan,u-i.TableCell.OwnerRow.RowIndex==r-1)return!0;return!1},i.prototype.GetMaxTopOrBottomCellMargin=function(n){for(var i,r,t=0,u=0;u<this.Cells.Count;u++)i=this.Cells[u].CellFormat,i.ContainsMargins()?n==0&&i.TopMargin>t?t=i.TopMargin:n==1&&i.BottomMargin>t&&(t=i.BottomMargin):(r=this.Cells[u].OwnerTable.TableFormat,n==0&&r.TopMargin>t?t=r.TopMargin:n==1&&r.BottomMargin>t&&(t=r.BottomMargin));return t},i.prototype.GetNextParagraph=function(){var t=this,i,n;return t.NextNode!=null?(i=t.NextNode.Cells[0],n=i.Blocks[0],n instanceof r?n:n.GetFirstParagraphInFirstCell()):this.OwnerTable.GetNextParagraph()},i.prototype.GetPreviousParagraph=function(){var t=this,i,n;return t.PreviousNode!=null?(i=t.PreviousNode.Cells[t.PreviousNode.Cells.Count-1],n=i.Blocks[i.Blocks.Count-1],n instanceof r?n:n.GetLastParagraphInLastCell()):this.OwnerTable.GetPreviousParagraph()},i.prototype.Contains=function(n){if(this.Cells.Contains(n))return!0;while(n.OwnerTable.IsInsideTable){if(this.Cells.Contains(n))return!0;n=n.OwnerTable.AssociatedCell}return this.Cells.Contains(n)},i.prototype.Highlight=function(n,t,i,r){for(var f,u=0;u<this.Cells.Count;u++)f=this.GetCellLeft(this.Cells[u]),w.Round(i,2)<=w.Round(f,2)&&w.Round(f,2)<w.Round(r,2)&&this.Cells[u].HighlightInternal(n,t)},i.prototype.HighlightInternal=function(n,t,r,u){for(var f=0;f<this.Cells.Count;f++)this.Cells[f].HighlightInternal(n,t);u.Paragraph.IsInsideTable&&this.Contains(u.Paragraph.AssociatedCell)||this.NextNode instanceof i&&this.NextNode.HighlightInternal(n,t,r,u)},i.prototype.GetCellLeft=function(n){var t=0;return n.TableCellWidgets.Count>0&&(t+=n.TableCellWidgets[0].X-n.TableCellWidgets[0].Margin.Left),t},i.prototype.GetSelectedContentAsHtmlInternal=function(n,t,i){var u="<tr ",r,f;for(u+=this.RowFormat.GetAsHtmlStyle(),u+=">",r=0;r<this.Cells.Count;r++)f=this.GetCellLeft(this.Cells[r]),w.Round(t,2)<=w.Round(f,2)&&w.Round(f,2)<w.Round(i,2)&&(u+=this.Cells[r].GetContentAsHtml());return u+"<\/tr>"},i.prototype.GetSelectedContentAsHtml=function(n,t,r){var u="<tr ",f;for(u+=this.RowFormat.GetAsHtmlStyle(),u+=">",f=0;f<this.Cells.Count;f++)u+=this.Cells[f].GetContentAsHtml();return(u+="<\/tr>",r.Paragraph.IsInsideTable&&this.Contains(r.Paragraph.AssociatedCell))?u:this.NextNode instanceof i?u+this.NextNode.GetSelectedContentAsHtml(n,t,r):u},i.prototype.GetContentAsHtml=function(){var n="<tr ",t;for(n+=this.RowFormat.GetAsHtmlStyle(),n+=">",t=0;t<this.Cells.Count;t++)n+=this.Cells[t].GetContentAsHtml();return n+"<\/tr>"},i.prototype.GetPreviousParagraphSelection=function(n){var i=this.Cells[this.Cells.Count-1],u,t;return n.Start.Paragraph.IsInsideTable&&this.OwnerTable.Contains(n.Start.Paragraph.AssociatedCell)&&(u=this.OwnerTable.GetCellInTable(n.Start.Paragraph.AssociatedCell),i=this.GetLastCellInRegion(u,n.UpDownSelectionLength,!0)),t=i.Blocks[i.Blocks.Count-1],t instanceof r?t:t.GetLastParagraphInLastCell()},i.prototype.GetNextParagraphSelection=function(n){var i=this.Cells[0],u,t;return n.Start.Paragraph.IsInsideTable&&this.OwnerTable.Contains(n.Start.Paragraph.AssociatedCell)&&(u=this.OwnerTable.GetCellInTable(n.Start.Paragraph.AssociatedCell),i=this.GetFirstCellInRegion(u,n.UpDownSelectionLength,!1)),t=i.Blocks[0],t instanceof r?t:t.GetFirstParagraphInFirstCell()},i.prototype.GetFirstCellInRegion=function(n,t,i){var f=n.OwnerRow.GetCellLeft(n),o=f+n.CellFormat.CellWidth,e=!0,r,u;if(f<=t&&t<o){for(r=0;r<this.Cells.Count;r++)if(u=this.GetCellLeft(this.Cells[r]),w.Round(f,2)<=w.Round(u,2)&&w.Round(u,2)<w.Round(o,2))return e=!1,this.Cells[r]}else for(r=0;r<this.Cells.Count;r++)if(u=this.GetCellLeft(this.Cells[r]),u<=t&&u+this.Cells[r].CellFormat.CellWidth>t)return e=!1,this.Cells[r];if(e){if(this.PreviousNode!=null&&i)return this.PreviousNode.GetFirstCellInRegion(n,t,i);if(this.NextNode!=null&&!i)return this.NextNode.GetFirstCellInRegion(n,t,i)}return this.Cells[0]},i.prototype.GetLastCellInRegion=function(n,t,i){var f=n.OwnerRow.GetCellLeft(n),o=f+n.CellFormat.CellWidth,e=!0,r,u;if(f<=t&&t<o){for(r=this.Cells.Count-1;r>=0;r--)if(u=this.GetCellLeft(this.Cells[r]),w.Round(f,2)<=w.Round(u,2)&&w.Round(u,2)<w.Round(o,2))return e=!1,this.Cells[r]}else for(r=this.Cells.Count-1;r>=0;r--)if(u=this.GetCellLeft(this.Cells[r]),u<=t&&u+this.Cells[r].CellFormat.CellWidth>t)return e=!1,this.Cells[r];if(e){if(this.PreviousNode!=null&&i)return this.PreviousNode.GetLastCellInRegion(n,t,i);if(this.NextNode!=null&&!i)return this.NextNode.GetLastCellInRegion(n,t,i)}return this.Cells[this.Cells.Count-1]},i.prototype.GetNextSelection=function(n){var u,i,t;return this.NextNode!=null?(u=n.IsEmpty||n.IsForward,u?(i=this.NextNode.Cells[this.NextNode.Cells.Count-1],t=i.Blocks[i.Blocks.Count-1],t instanceof r?t:t.GetLastParagraphInLastCell()):this.NextNode.GetNextParagraphSelection(n)):this.OwnerTable.GetNextSelection(n)},i.prototype.GetPreviousSelection=function(n){if(this.PreviousNode!=null){if(n.IsForward)return this.PreviousNode.GetPreviousParagraphSelection(n);var i=this.PreviousNode.Cells[0],t=i.Blocks[0];return t instanceof r?t:t.GetFirstParagraphInFirstCell()}return this.OwnerTable.GetPreviousSelection(n)},i.prototype.ClearWidgets=function(){var n,t;if(this.TableRowWidgets!=null&&this.TableRowWidgets.Count>0)for(n=0;n<this.TableRowWidgets.Count;n++)t=this.TableRowWidgets[n],t.Dispose(),this.TableRowWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.TableRowWidgets!=null&&(this.ClearWidgets(),this.TableRowWidgets=null),this.Cells!=null){for(this.Cells.Dispose(),n=0;n<this.Cells.Count;n++)t=this.Cells[n],t.Dispose(),this.Cells.Remove(t),n--;this.ChildNodes=null}this.Fields=null;this.FieldCharacter=null},i}(ut);t.TableRowAdv=ri;br=function(){function n(){this.preferredwidth=0;this.minwidth=0;this.maxwidth=0}return Object.defineProperty(n.prototype,"PreferredWidth",{get:function(){return this.preferredwidth},set:function(n){this.preferredwidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MinWidth",{get:function(){return this.minwidth},set:function(n){this.minwidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MaxWidth",{get:function(){return this.maxwidth},set:function(n){this.maxwidth=n},enumerable:!0,configurable:!0}),n}();t.TableColumnAdv=br;ht=function(t){function i(n){t.call(this,n);this.colIndex=0;this.ChildNodes=new ci(this);this.CellFormat=new uu(this);this.TableCellWidgets=new e}return n(i,t),Object.defineProperty(i.prototype,"Blocks",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftMargin",{get:function(){return this.CellFormat.ContainsMargins()?this.CellFormat.LeftMargin:this.OwnerTable!=null&&this.OwnerTable.TableFormat!=null?this.OwnerTable.TableFormat.LeftMargin:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopMargin",{get:function(){return this.CellFormat.ContainsMargins()?this.CellFormat.TopMargin:this.OwnerTable!=null&&this.OwnerTable.TableFormat!=null?this.OwnerTable.TableFormat.TopMargin:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightMargin",{get:function(){return this.CellFormat.ContainsMargins()?this.CellFormat.RightMargin:this.OwnerTable!=null&&this.OwnerTable.TableFormat!=null?this.OwnerTable.TableFormat.RightMargin:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BottomMargin",{get:function(){return this.CellFormat.ContainsMargins()?this.CellFormat.BottomMargin:this.OwnerTable!=null&&this.OwnerTable.TableFormat!=null?this.OwnerTable.TableFormat.BottomMargin:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerRow",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerTable",{get:function(){return this.OwnerRow!=null?this.OwnerRow.OwnerTable:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ColumnIndex",{get:function(){return this.colIndex},set:function(n){this.colIndex=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerColumn",{get:function(){return this.OwnerTable.TableHolder.Columns[this.ColumnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Section",{get:function(){return this.OwnerTable!=null?this.OwnerTable.Section:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CellIndex",{get:function(){return this.OwnerRow!=null?this.OwnerRow.Cells.IndexOf(this):-1},enumerable:!0,configurable:!0}),i.prototype.LayoutItems=function(n,t,i){var e,u,f;for(this.TableCellWidgets!=null&&this.TableCellWidgets.length>0&&this.TableCellWidgets.Clear(),this.AddTableCellWidget(n.ClientActiveArea,t,i),n.UpdateClientAreaForCell(this,!0),this.Blocks.length==0&&(e=null,e=new r(this),this.Blocks.Add(e)),u=0;u<this.Blocks.length;u++)f=this.Blocks[u],n.UpdateClientAreaForBlock(f,!0),f.LayoutItems(n),n.UpdateClientAreaForBlock(f,!1);this.UpdateWidgetToRow(n);n.UpdateClientAreaForCell(this,!1)},i.prototype.AddTableCellWidget=function(n,t,i){var r=new gt(this),e=0,u=0,o=0,h=t,s=0,c=i,f;this.CellFormat.ContainsMargins()?(o=this.CellFormat.LeftMargin,s=this.CellFormat.RightMargin):(o=this.OwnerTable.TableFormat.LeftMargin,s=this.OwnerTable.TableFormat.RightMargin);r.Margin=new fi(o,h,s,c);r.Width=this.CellFormat.CellWidth;this.PreviousNode!=null&&(e=this.PreviousNode.ColumnIndex+this.PreviousNode.CellFormat.ColumnSpan);u=this.OwnerTable.TableFormat.CellSpacing;this.TableCellWidgets.Add(r);f=0;e<this.ColumnIndex&&(f=this.OwnerTable.TableHolder.GetPreviousSpannedCellWidth(e,this.ColumnIndex),e==0&&(f=f-u/2));r.X=n.X+f+r.Margin.Left;r.Y=n.Y+r.Margin.Top+u;r.Width=r.Width-r.Margin.Left-r.Margin.Right;u>0&&(r.X+=u,r.Width-=this.OwnerTable.TableHolder.Columns.Count==1?u*2:this.ColumnIndex==0||this.ColumnIndex==this.OwnerTable.TableHolder.Columns.Count-1?u*2-u/2:u,r.RightBorderWidth=this.CellFormat.Borders.GetCellRightBorder(this).GetLineWidth(),r.Width-=r.RightBorderWidth);r.LeftBorderWidth=this.CellFormat.Borders.GetCellLeftBorder(this).GetLineWidth();r.X+=r.LeftBorderWidth;r.Width-=r.LeftBorderWidth;this.CellIndex==this.OwnerRow.Cells.Count-1&&(r.RightBorderWidth=this.CellFormat.Borders.GetCellRightBorder(this).GetLineWidth(),r.Width-=r.RightBorderWidth);r.Margin.Left=r.Margin.Left+r.LeftBorderWidth;r.Margin.Right=r.Margin.Right+r.RightBorderWidth},i.prototype.UpdateWidgetToRow=function(){var t=this.TableCellWidgets[this.TableCellWidgets.length-1],n=this.OwnerRow.TableRowWidgets[this.OwnerRow.TableRowWidgets.length-1],u=n.X,i,r;n.ChildWidgets.length>0&&(i=n.ChildWidgets[n.ChildWidgets.length-1],u=i.X+i.Width+i.Margin.Right);n.ChildWidgets.Add(t);t.ContainerWidget=n;this.OwnerRow.RowFormat.HeightType!=et.Exactly&&this.OwnerRow.RowFormat.Height>0&&this.CellIndex==0&&(n.Height=n.Height+this.OwnerRow.RowFormat.Height);this.CellFormat.RowSpan==1&&(r=t.Height+t.Margin.Top+t.Margin.Bottom,n.Height-this.OwnerTable.TableFormat.CellSpacing<r&&(n.Height=r+this.OwnerTable.TableFormat.CellSpacing))},i.prototype.GetNextParagraph=function(){if(this.NextNode!=null){var n=this.NextNode.Blocks[0];return n instanceof r?n:n.GetFirstParagraphInFirstCell()}return this.OwnerRow.GetNextParagraph()},i.prototype.GetPreviousParagraph=function(){if(this.PreviousNode!=null){var n=this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1];return n instanceof r?n:n.GetLastParagraphInLastCell()}return this.OwnerRow.GetPreviousParagraph()},i.prototype.GetFirstParagraph=function(){var n=this.Blocks[0];return n instanceof r?n:n.GetFirstParagraphInFirstCell()},i.prototype.GetFirstBlock=function(){return this.Blocks.Count>0?this.Blocks[0]:null},i.prototype.GetLastParagraph=function(){var n=this.Blocks[this.Blocks.Count-1];return n instanceof r?n:n.GetLastParagraphInLastCell()},i.prototype.Contains=function(n){if(this==n)return!0;while(n.OwnerTable.IsInsideTable){if(this==n.OwnerTable.AssociatedCell)return!0;n=n.OwnerTable.AssociatedCell}return!1},i.prototype.GetContainerCell=function(){for(var n=this;n.OwnerTable!=null&&n.OwnerTable.IsInsideTable;)n=n.OwnerTable.AssociatedCell;return n},i.prototype.GetContainerCellOf=function(n){for(var t=this;t.OwnerTable.IsInsideTable;){if(t.OwnerTable.Contains(n))return t;t=t.OwnerTable.AssociatedCell}return t},i.prototype.GetSelectedCell=function(n){var t=this;if(t.OwnerTable==n.OwnerTable)return t;while(t.OwnerTable.IsInsideTable){if(t.OwnerTable.AssociatedCell==n)return t;t=t.OwnerTable.AssociatedCell}return t},i.prototype.IsCellSelected=function(n,t){var i=this.GetLastParagraph(),r=i==t.Paragraph&&t.Offset==i.GetLength()+1;return r||!this.Contains(n.Paragraph.AssociatedCell)||!this.Contains(t.Paragraph.AssociatedCell)},i.prototype.Highlight=function(n,t,i,r){var u,f,e,o;if(r.Paragraph.IsInsideTable)if(u=this.GetContainerCellOf(r.Paragraph.AssociatedCell),u.OwnerTable.Contains(r.Paragraph.AssociatedCell))if(f=this.GetSelectedCell(u),e=r.Paragraph.AssociatedCell.GetSelectedCell(u),u.Contains(r.Paragraph.AssociatedCell))u.IsCellSelected(i,r)?u.HighlightInternal(n,t):f==u?i.Paragraph.Highlight(n,t,i,r):f.HighlightContainer(n,t,i,r);else if(u.HighlightInternal(n,t),u.OwnerRow==e.OwnerRow){for(f=u;f.NextNode!=null;)if(f=f.NextNode,f.HighlightInternal(n,t),f==e)break}else u.OwnerTable.HighlightCells(n,t,u,e);else u.HighlightContainer(n,t,i,r);else o=this.GetContainerCell(),o.HighlightContainer(n,t,i,r)},i.prototype.HighlightInternal=function(n,t){for(var i=0;i<this.TableCellWidgets.Count;i++)this.TableCellWidgets[i].Highlight(n,t)},i.prototype.HighlightContainer=function(n,t,i,r){this.OwnerRow.HighlightInternal(n,t,i,r);var u=this.OwnerTable.GetNextRenderedBlock();u.Highlight(n,t,i,r)},i.prototype.GetCellLeft=function(n){var t=0;return n.TableCellWidgets.Count>0&&(t+=n.TableCellWidgets[0].X-n.TableCellWidgets[0].Margin.Left),t},i.prototype.GetSelectedContentAsHtmlInternal=function(n,t,i){var r="",u,f,e,o;if(i.Paragraph.IsInsideTable)if(u=this.GetContainerCellOf(i.Paragraph.AssociatedCell),u.OwnerTable.Contains(i.Paragraph.AssociatedCell)){if(r+="<table ",r+=u.OwnerTable.TableFormat.GetAsHtmlStyle(),r+=">",f=this.GetSelectedCell(u),e=i.Paragraph.AssociatedCell.GetSelectedCell(u),u.Contains(i.Paragraph.AssociatedCell))u.IsCellSelected(t,i)?(r+="<tr ",r+=u.OwnerRow.RowFormat.GetAsHtmlStyle(),r+=">",r+=u.GetContentAsHtml(),r+="<\/tr>"):r=f==u?t.Paragraph.GetSelectedContentAsHtml(n,t,i):f.GetSelectedContentAsHtml(n,t,i);else if(u.OwnerRow==e.OwnerRow){for(r+="<tr ",r+=u.OwnerRow.RowFormat.GetAsHtmlStyle(),r+=">",r+=u.GetContentAsHtml(),f=u;f.NextNode!=null;)if(f=f.NextNode,r+=f.GetContentAsHtml(),f==e)break;r+="<\/tr>"}else r+=u.OwnerTable.GetSelectedContentAsHtmlInternal(n,u,e);r+="<\/table>"}else r+=u.GetSelectedContentAsHtml(n,t,i);else o=this.GetContainerCell(),r+=o.GetSelectedContentAsHtml(n,t,i);return r},i.prototype.GetSelectedContentAsHtml=function(n,t,i){var r="",u;return r+="<table ",r+=this.OwnerTable.TableFormat.GetAsHtmlStyle(),r+=">",r+=this.OwnerRow.GetSelectedContentAsHtml(n,t,i),r+="<\/table>",u=this.OwnerTable.GetNextRenderedBlock(),r+u.GetSelectedContentAsHtml(n,t,i)},i.prototype.GetContentAsHtml=function(){var n="<td ",t;for(n+=this.CellFormat.GetAsHtmlStyle(),n+=">",t=0;t<this.Blocks.Count;t++)n+=this.Blocks[t].GetContentAsHtml();return n+"<\/td>"},i.prototype.GetNextSelection=function(n){var t;return this.NextNode!=null?n.IsEmpty||n.IsForward?(t=this.NextNode.Blocks[this.NextNode.Blocks.Count-1],t instanceof r?t:t.GetLastParagraphInLastCell()):(t=this.NextNode.Blocks[0],t instanceof r?t:t.Rows[0].GetNextParagraphSelection(n)):this.OwnerRow.GetNextSelection(n)},i.prototype.GetPreviousSelection=function(n){var t;return this.PreviousNode!=null?n.IsForward?(t=this.PreviousNode.Blocks[this.PreviousNode.Blocks.Count-1],t instanceof r?t:t.Rows[t.Rows.Count-1].GetPreviousParagraphSelection(n)):(t=this.PreviousNode.Blocks[0],t instanceof r?t:t.GetFirstParagraphInLastRow()):this.OwnerRow.GetPreviousSelection(n)},i.prototype.ClearWidgets=function(){var n,t;if(this.TableCellWidgets!=null&&this.TableCellWidgets.Count>0)for(n=0;n<this.TableCellWidgets.Count;n++)t=this.TableCellWidgets[n],t.Dispose(),this.TableCellWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.CellFormat.Dispose(),this.TableCellWidgets!=null&&(this.ClearWidgets(),this.TableCellWidgets=null),this.Blocks!=null){for(this.Blocks.Dispose(),n=0;n<this.Blocks.Count;n++)t=this.Blocks[n],t.Dispose(),this.Blocks.Remove(t),n--;this.ChildNodes=null}this.Fields=null;this.FieldCharacter=null},i}(ut);t.TableCellAdv=ht;r=function(t){function i(n){t.call(this,n);this.ChildNodes=new or(this);this.CharacterFormat=new vr(this);this.ParagraphFormat=new di(this);this.paragraphWidgets=new e}return n(i,t),Object.defineProperty(i.prototype,"Inlines",{get:function(){return this.ChildNodes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ParagraphWidgets",{get:function(){return this.paragraphWidgets},enumerable:!0,configurable:!0}),i.prototype.IsEmpty=function(){return this.Inlines.length==0?!0:!1},i.prototype.GetTabWidth=function(n){var i,t;if(n.ClientActiveArea.X<n.ClientArea.X)return n.ClientArea.X-n.ClientActiveArea.X;if(i=n.ClientActiveArea.X-(n.ClientArea.X-this.LeftIndent),t=this.Document.DefaultTabWidth,i==0||t==0)return t;var u=Math.round(i)*100%(Math.round(t)*100)/100,f=(Math.round(i)-u)/Math.round(t),r=(f+1)*t;return r-i>0?r-i:t},i.prototype.AddParagraphWidget=function(n){var t=new pt(this);if(this.IsEmpty()&&(this.ParagraphFormat.TextAlignment==nt.Center||this.ParagraphFormat.TextAlignment==nt.Right)){var i=this.GetParagraphMarkSize(0,0),f=i.TopMargin,e=i.BottomMargin,r=i.Width,u=n.Left;u+=this.ParagraphFormat.TextAlignment==nt.Center?(n.Width-r)/2:n.Width-r;t.Width=r;t.X=n.X;t.Y=n.Y}else t.Width=n.Width,t.X=n.X,t.Y=n.Y;this.ParagraphWidgets.push(t)},i.prototype.LayoutItems=function(n){var t,i;if(this.paragraphWidgets!=null&&this.paragraphWidgets.Count>0&&this.paragraphWidgets.Clear(),this.AddParagraphWidget(n.ClientActiveArea),n.IsFieldCode||this.ParagraphFormat.ListFormat!=null&&this.ParagraphFormat.ListFormat.List!=null&&this.ParagraphFormat.ListFormat.ListLevelNumber>=0&&this.ParagraphFormat.ListFormat.ListLevelNumber<9&&this.LayoutList(n),this.IsEmpty())this.LayoutEmptyLineWidget(n);else for(t=0;t<this.Inlines.length;t++)t==0&&n.UpdateClientWidth(-this.ParagraphFormat.FirstLineIndent),i=this.Inlines[t],i.LayoutItems(n);this.UpdateWidgetToPage(n)},i.prototype.LayoutList=function(n){var r,i,t;(n.UpdateClientWidth(-this.ParagraphFormat.FirstLineIndent),r=this.Document,i=this.ParagraphFormat.ListFormat.ListLevel,i!=null)&&(t=new rt(this,i,!1),t.Text=i.ListLevelPattern==v.Bullet?i.NumberFormat:r.GetListNumber(this.ParagraphFormat.ListFormat),o.UpdateTextSize(t),n.CutFromLeft(n.ClientActiveArea.X+t.Width),n.LineElements.Add(t),i.FollowCharacter!=ou.None)&&(t=new rt(this,i,!0),i.FollowCharacter==ou.Tab?(t.Text="\t",t.Width=this.GetTabWidth(n)):(t.Text=" ",o.UpdateTextSize(t)),n.CutFromLeft(n.ClientActiveArea.X+t.Width),n.LineElements.Add(t),n.UpdateClientWidth(this.ParagraphFormat.FirstLineIndent))},i.prototype.LayoutEmptyLineWidget=function(n){var p=o.GetParagraphMarkSize(this.CharacterFormat),r=p.Height,w=r-p.BaselineOffset,l,v,y,c;!isNaN(n.LineElements.MaxTextElementHeight)&&r<n.LineElements.MaxTextElementHeight&&(r=n.LineElements.MaxTextElementHeight,w=r-n.LineElements.MaxTextElementBaselineOffset);l=this.GetBeforeSpacing();n.CurrentHeaderFooter==null&&n.ClientActiveArea.Height<l+r&&n.ClientActiveArea.Y!=n.ClientArea.Y&&this.MoveToNextPage(n);var s=this.GetLineSpacing(r),f=this.AddLineWidget(),i=0,u=0,h=0,e=r,a=0,t=null;n.LineElements.Count>0&&(t=n.LineElements[0]);t!=null&&(v=t.BaselineOffset,i=n.LineElements.MaxBaselineOffset-v,t.Height<r?a=r-w-(t.Height-(t.Height-v)):e=t.Height);y=this.ParagraphFormat.LineSpacingType;y==bt.Multiple?s>r?u+=s-r:i+=s-r:y==bt.Exactly?i+=s-(i+e+u):s>i+e+u&&(i+=s-(i+e+u));i+=l;u+=this.ParagraphFormat.AfterSpacing;t!=null&&(c=this.ParagraphFormat.TextAlignment,c==nt.Right?h=n.ClientArea.Width-t.Width:c==nt.Center&&(h=(n.ClientArea.Width-t.Width)/2),t.Margin=new fi(h,a+i,0,u),t.CurrentLineWidget=f,f.Height=i+e+u,f.Children.Add(t));n.LineElements.Count>1&&n.LineElements[1]instanceof rt&&(t=n.LineElements[1],c=this.ParagraphFormat.TextAlignment,c==nt.Right?h=n.ClientArea.Width-t.Width:c==nt.Center&&(h=(n.ClientArea.Width-t.Width)/2),t.Margin=new fi(h,a+i,0,u),t.CurrentLineWidget=f,f.Height=i+e+u,f.Children.Add(t));f.Height=i+e+u;n.CutFromTop(n.ClientActiveArea.Y+f.Height);n.LineElements.Clear()},i.prototype.MoveToNextPage=function(n){var u=this.ParagraphWidgets[this.ParagraphWidgets.length-1],f=null,r,t,h,o,e,s;if(n.LineElements.length>0&&(f=n.LineElements.ToList(),n.LineElements.Clear()),r=null,u.ChildWidgets.Count>0?(this.UpdateWidgetToPage(n),r=u.ContainerWidget):this.PreviousBlock instanceof i?r=this.PreviousBlock.ParagraphWidgets[this.PreviousBlock.ParagraphWidgets.Count-1].ContainerWidget:this.PreviousBlock instanceof y&&(r=this.PreviousBlock.TableWidgets[this.PreviousBlock.TableWidgets.Count-1].ContainerWidget),t=0,r!=null&&(t=n.Pages.IndexOf(r.Page)),t==n.Pages.Count-1||n.Pages[t+1].Section!=this.Section?(h=n.CreateNewPage(this.Section),n.Pages[t+1].Section!=this.Section&&n.InsertPage(t+1,h)):(n.Pages[t+1].BoundingRectangle=new a(n.Pages[t+1].BoundingRectangle.X,n.Pages[t].BoundingRectangle.Bottom+20,n.Pages[t+1].BoundingRectangle.Width,n.Pages[t+1].BoundingRectangle.Height),n.UpdateClientArea(this.Section.SectionFormat)),n.UpdateClientAreaForBlock(this,!0),u.ChildWidgets.Count>0?this.AddParagraphWidget(n.ClientActiveArea):u.UpdateClientAreaLocation(n.ClientActiveArea),f!=null&&n.LineElements.Count==0){for(o=n.ClientActiveArea.X,e=0;e<f.Count;e++)s=f[e],o+=s.Width,n.LineElements.Add(s);n.CutFromLeft(o)}},i.prototype.UpdateWidgetToPage=function(n){var t=this.ParagraphWidgets[this.ParagraphWidgets.length-1],i;this.IsInsideTable?(i=this.AssociatedCell.TableCellWidgets[this.AssociatedCell.TableCellWidgets.length-1],t.Height=n.ClientActiveArea.Y-t.Y,i.Height=n instanceof ft?this.AssociatedCell.OwnerRow.RowFormat.HeightType==et.Exactly?this.AssociatedCell.OwnerRow.RowFormat.Height:this.AssociatedCell.TableCellWidgets.Count<=1&&this.AssociatedCell.OwnerRow.RowFormat.HeightType==et.Atleast?Math.max(this.AssociatedCell.OwnerRow.RowFormat.Height,i.Height+t.Height):i.Height+t.Height:i.Height+t.Height,i.ChildWidgets.Add(t),t.ContainerWidget=i):(t.Height=n.ClientActiveArea.Y-t.Y,this._UpdateWidgetsToBody(n,t))},i.prototype.GetBeforeSpacing=function(){var n=0;return this.PreviousBlock instanceof i?this.PreviousBlock.ParagraphFormat.AfterSpacing<this.ParagraphFormat.BeforeSpacing&&(n=this.ParagraphFormat.BeforeSpacing-this.PreviousBlock.ParagraphFormat.AfterSpacing):n=this.ParagraphFormat.BeforeSpacing,n},i.prototype.GetLineSpacing=function(n){var t=0;switch(this.ParagraphFormat.LineSpacingType){case bt.AtLeast:case bt.Exactly:t=this.ParagraphFormat.LineSpacing;break;default:t=this.ParagraphFormat.LineSpacing*n}return t},i.prototype.GetParagraphMarkSize=function(n,t){var i=o.GetParagraphMarkSize(this.CharacterFormat),e=i.BaselineOffset,r=i.Height,s=e,f,u,c,h;return this.paragraphWidgets.Count>0&&this.paragraphWidgets[0].ChildWidgets.Count>0&&(f=this.paragraphWidgets[0].ChildWidgets[0],f.Children.Count>0&&f.Children[0]instanceof rt&&r<f.Children[0].Height&&(r=f.Children[0].Height,s=f.Children[0].BaselineOffset)),u=this.GetLineSpacing(r),c=this.GetBeforeSpacing(),n=s-e,t=r-s-(i.Height-e),h=this.ParagraphFormat.LineSpacingType,h==bt.Multiple?u>r?t+=u-r:n+=u-r:h==bt.Exactly?n+=u-(n+i.Height+t):u>n+i.Height+t&&(n+=u-(n+i.Height+t)),n+=c,t+=this.ParagraphFormat.AfterSpacing,{Width:i.Width,Height:i.Height,TopMargin:n,BottomMargin:t}},i.prototype.AddLineWidget=function(){var n=null,t;return t=this.ParagraphWidgets[this.ParagraphWidgets.length-1],n=new ki(t),n.Width=t.Width,t.ChildWidgets.push(n),n.CurrentParagraphWidget=t,n},i.prototype.GetStartOffset=function(){for(var n,t=0,i=0;i<this.Inlines.length;i++)if(n=this.Inlines[i],n.Length!=0){if(n instanceof p||n instanceof d||n instanceof u&&n.IsLinkedFieldCharacter())return t;t+=n.Length}return t},i.prototype.GetLength=function(){for(var t=0,n=0;n<this.Inlines.length;n++)t+=this.Inlines[n].Length;return t},i.prototype.GetOffset=function(n,t){var r,i;if(n==null)return t;for(r=t,i=0;i<this.Inlines.length;i++){if(n==this.Inlines[i])break;r+=this.Inlines[i].Length}return r},i.prototype.GetLineWidget=function(n){var t=null;if(this.IsEmpty())this.paragraphWidgets.Count>0&&this.paragraphWidgets[0].ChildWidgets.Count>0&&(t=this.paragraphWidgets[0].ChildWidgets[0]);else{var i=0,r=this.GetInline(n,i),u=r.inline;i=r.index;t=u.GetLineWidget(i)}return t},i.prototype.GetLineWidgetInternal=function(n,t){var i=null;if(this.IsEmpty())this.paragraphWidgets.Count>0&&this.paragraphWidgets[0].ChildWidgets.Count>0&&(i=this.paragraphWidgets[0].ChildWidgets[0]);else{var r=0,u=this.GetInline(n,r),f=u.inline;r=u.index;i=f.GetLineWidgetInternal(r,t)}return i},i.prototype.GetPhysicalPosition=function(n){return this.GetPhysicalPositionInternal(n,!0)},i.prototype.GetPhysicalPositionInternal=function(n,t){var u,f;if(this.IsEmpty()){u=this.paragraphWidgets[0].X;this.paragraphWidgets[0].ChildWidgets.length>0&&(f=this.paragraphWidgets[0].ChildWidgets[0],u=f.GetLeft());var e=0,s=this.GetParagraphMarkSize(e,0);return n>0&&(u+=s.Width),new k(u,this.paragraphWidgets[0].Y+e)}var r=0,o=this.GetInline(n,r),i=o.inline;return r=o.index,i.Length==r&&i.NextNode!=null&&i.Elements.Count>0&&i.NextNode.Elements.Count>0&&i.Elements[i.Elements.Count-1].CurrentLineWidget!=i.NextNode.Elements[0].CurrentLineWidget&&(i=i.NextNode,r=0),i.GetPhysicalPosition(r,t)},i.prototype.GetEndPosition=function(){var n=this.paragraphWidgets[this.paragraphWidgets.Count-1],i=n.X,r=n.Y,t=null;n.ChildWidgets.Count>0&&(t=n.ChildWidgets[n.ChildWidgets.Count-1],i+=t.GetWidth(!1));t!=null&&(r=t.GetTop());var u=this.GetParagraphMarkSize(0,0);return new k(i,r+u.TopMargin)},i.prototype.GetInline=function(n,t){for(var i=null,r=0,f=!1,e=0;e<this.Inlines.length;e++){if(i=this.Inlines[e],!f&&(i instanceof p||i instanceof d||i instanceof u&&i.IsLinkedFieldCharacter())&&(f=!0),f&&n<=r+i.Length)return t=n-r,t<0&&(t=0),{inline:i,index:t};r+=i.Length}return n>r&&(t=i==null?n:i.Length),{inline:i,index:t}},i.prototype.HighlightSelectedContent=function(n,t,i,r){var u,s,l,p,a,v,c,y,b;if(i.Paragraph.IsInsideTable&&(!r.Paragraph.IsInsideTable||i.Paragraph.AssociatedCell!=r.Paragraph.AssociatedCell||i.Paragraph.AssociatedCell.IsCellSelected(i,r)))i.Paragraph.AssociatedCell.Highlight(n,t,i,r);else{if(u=null,s=0,this==r.Paragraph)if(i.Offset+1==r.Offset)l=this.GetInline(r.Offset,s),u=l.inline,s=l.index,u instanceof d&&(p=this.GetOffset(u,0),p!=i.Offset&&(u=null));else{var e=0,w=i.Paragraph.GetInline(i.Offset,e),o=w.inline;e=w.index;e==o.Length&&(o=o.GetNextRenderedInline(e));a=r.Paragraph.GetInline(r.Offset,e);v=a.inline;e=a.index;o instanceof f&&v instanceof h&&o.fieldSeparator!=null&&(c=o.fieldSeparator.NextNode,c instanceof d&&c.NextNode==v&&(u=c))}u instanceof d&&n.OwnerControl.IsDocumentLoaded?(y=u.GetElementBoxInternal(s),b=y.element,s=y.index):this.Highlight(n,t,i,r)}},i.prototype.Highlight=function(n,t,i,r){var y=0,h=0,p=null,c=null,w=this.GetStartLineWidget(i,p,y),u=w.lineWidget,l,s,a,e,d,f,v,b,o,k;if(p=w.startElement,y=w.lineIndex,l=this.GetEndLineWidget(r,c,h),s=l.lineWidget,c=l.endElement,h=l.lineIndex,a=0,e=0,u!=null&&(a=u.GetTop(),e=u.GetLeftInternal(p,y)),u!=null&&u==s)d=s.GetLeftInternal(c,h),n.CreateHighlightBorder(t,u,d-e,e,a);else{if(f=this,u!=null)for(f!=u.CurrentParagraphWidget.CurrentNode&&(f=u.CurrentParagraphWidget.CurrentNode),n.CreateHighlightBorder(t,u,u.GetWidth(!0)-(e-u.CurrentParagraphWidget.X),e,a),v=u.CurrentParagraphWidget.ChildWidgets.IndexOf(u),b=f.ParagraphWidgets.IndexOf(u.CurrentParagraphWidget),o=b;o<f.ParagraphWidgets.Count;o++){if(o==b&&(v+=1),f.ParagraphWidgets[o].Highlight(n,t,v,s,c,h),f.ParagraphWidgets[o]==s.CurrentParagraphWidget)return;v=0}k=f.GetNextRenderedBlock();k!=null&&k.Highlight(n,t,i,r)}},i.prototype.GetStartLineWidget=function(n,t,i){var h=this==n.Paragraph?n.Offset:this.GetStartOffset(),c=this.GetInline(h,i),r=c.inline,f,e,o,s;return i=c.index,r instanceof u&&(f=r.GetRenderedInline(i),r=f.Inline,i=f.InlineIndex),h==this.GetLength()+1&&i++,r==null?this.ParagraphWidgets.Count>0?(e=this.ParagraphWidgets[0],{lineWidget:e.ChildWidgets.Count>0?e.ChildWidgets[0]:null,lineIndex:i,startElement:t}):null:(o=r.GetElementBoxInternal(i),t=o.element,i=o.index,s=t.CurrentLineWidget,t==null&&(s=r.GetLineWidget(i)),{lineWidget:s,lineIndex:i,startElement:t})},i.prototype.GetEndLineWidget=function(n,t,i){var s=n.Paragraph.GetInline(n.Offset,i),r=s.inline,e,f,o;return i=s.index,r instanceof u&&(e=r.GetRenderedInline(i),r=e.Inline,i=e.InlineIndex),r==null?(n.Offset==n.Paragraph.GetLength()+1&&(i=1),n.Paragraph.ParagraphWidgets.Count>0?(f=n.Paragraph.ParagraphWidgets[n.Paragraph.ParagraphWidgets.Count-1],{lineWidget:f.ChildWidgets.Count>0?f.ChildWidgets[f.ChildWidgets.Count-1]:null,lineIndex:i,endElement:t}):null):(n.Offset==n.Paragraph.GetLength()+1&&(i=r.Length+1),o=r.GetElementBoxInternal(i),t=o.element,i=o.index,t==null)?{lineWidget:r.GetLineWidget(i),lineIndex:i,endElement:t}:{lineWidget:t.CurrentLineWidget,lineIndex:i,endElement:t}},i.prototype.HasValidInline=function(n,t){for(var i,r=this.Inlines.IndexOf(n);r<this.Inlines.Count;r++)if(i=this.Inlines[r],i.Length!=0){if(i==t)return!1;if(i instanceof p||i instanceof d||i instanceof u&&i.IsLinkedFieldCharacter())return!0}return!1},i.prototype.GetPreviousValidOffset=function(n){var r,i,f,t;if(n==0)return 0;for(r=0,i=0,f=0;f<this.Inlines.Count;f++)if(t=this.Inlines[f],t.Length!=0){if(n<=i+t.Length)return n-1==i?r:n-1;(t instanceof p||t instanceof d||t instanceof u&&t.IsLinkedFieldCharacter())&&(r=i+t.Length);i+=t.Length}return n-1==i?r:n-1},i.prototype.GetEndOffset=function(){for(var n,i=0,r=0,t=0;t<this.Inlines.Count;t++)(n=this.Inlines[t],this.Inlines.length!=0)&&((n instanceof p||n instanceof d||n instanceof u&&n.IsLinkedFieldCharacter())&&(i=r+n.Length),r+=n.Length);return i},i.prototype.GetNextStartInline=function(n){var i=0,e=this.GetInline(n,i),t=e.inline,r;return i=e.index,t!=null&&i==t.Length&&t.NextNode instanceof u&&(r=t.NextNode.GetNextValidInline(),r instanceof f&&(t=r)),t},i.prototype.GetNextValidOffset=function(n){for(var t,i=0,r=0;r<this.Inlines.Count;r++)if(t=this.Inlines[r],t.Length!=0){if(n<i+t.Length&&(t instanceof p||t instanceof d||t instanceof u&&t.IsLinkedFieldCharacter()))return(n>i?n:i)+1;i+=t.Length}return n},i.prototype.SplitByBreakCharacter=function(n,t,r){for(var f,o,e=new i(this),u=0;u<n.Inlines.Count;u++)e.Inlines.Add(n.Inlines[u]);for(n.Section.Blocks.Remove(n),f=new i(this),f.ParagraphFormat.CopyFormat(n.ParagraphFormat),f.CharacterFormat.CopyFormat(n.CharacterFormat),o=new i(this),f.ParagraphFormat.CopyFormat(n.ParagraphFormat),f.CharacterFormat.CopyFormat(n.CharacterFormat),u=0;u<r;u++)f.Inlines.Add(e.Inlines[u]);for(u=r+1;u<e.Inlines.Count;u++)o.Inlines.Add(e.Inlines[u]);t.SplitByBreakCharacter(t,t.Text,f,o)},i.prototype.GetSelectedContent=function(n,t,i){return t.Paragraph.IsInsideTable&&(!i.Paragraph.IsInsideTable||t.Paragraph.AssociatedCell!=i.Paragraph.AssociatedCell||t.Paragraph.AssociatedCell.IsCellSelected(t,i))?t.Paragraph.AssociatedCell.GetSelectedContentAsHtmlInternal(n,t,i):this.GetSelectedContentAsHtml(n,t,i)},i.prototype.GetSelectedContentAsHtml=function(n,t,i){var r="",u=null,c=null,l=null,a=0,v=0,e=null,o,y,b;if(this.ParagraphFormat.ListFormat!=null&&(e=this.ParagraphFormat.ListFormat.ListLevel),i.Paragraph==this){if(i.Paragraph.IsEmpty())return(i.Offset=this.GetStartOffset())?"":(e!=null?(r+=this.GetHtmlList(e,t),r+="<li "):r+="<p ",r+=this.ParagraphFormat.GetAsHtmlStyle()+"/>",r.indexOf("<ul")>-1?r+="<\/ul>":r.indexOf("<ol")>-1&&(r+="<\/ol>"),r);o=this.GetInline(i.Offset,0);l=o.inline;v=o.index}for(t.Paragraph==this?t.Offset==this.GetLength()+1||(e!=null?(r+=this.GetHtmlList(e,t),r+="<li "):r+="<p ",r+=this.ParagraphFormat.GetAsHtmlStyle()+">",this.IsEmpty()||(o=this.GetInline(t.Offset,0),u=c=o.inline,a=o.index)):(e!=null?(r+=this.GetHtmlList(e,t),r+="<li "):r+="<p ",r+=this.ParagraphFormat.GetAsHtmlStyle()+">",this.Inlines.Count>0&&(u=this.Inlines[0])),y=this,u==null&&r!=null&&(r+="&nbsp;");u!=null;){if(u instanceof p)r+="<span ",r+=u.CharacterFormat.GetAsHtmlStyle(),r+=">",r+=l==u?l==c?this.DecodeHtmlNames(u.Text.substring(a,v)):this.DecodeHtmlNames(u.Text.substring(0,v)):c==u?this.DecodeHtmlNames(u.Text.substring(a,c.Length)):this.DecodeHtmlNames(u.Text),r+="<\/span>";else if(u instanceof d)r+="<img ",r+='width="'+u.Width+'" ',r+='height="'+u.Height+'" ',r+='src="'+u.ImageString+'" ',r+=u.CharacterFormat.GetAsHtmlStyle(),r+="/>";else if(u instanceof f&&u.IsLinkedFieldCharacter()){var s=u.GetFieldCode(),k=s.toLowerCase(),w=k.indexOf("hyperlink");w>-1&&(s=s.substr(w+9).trim(),r+="<a href="+s+">");u=u.fieldSeparator}else if(u instanceof h&&u.IsLinkedFieldCharacter()){var s=u.FieldBegin.GetFieldCode(),k=s.toLowerCase(),w=k.indexOf("hyperlink");w>-1&&(r+="<\/a>")}if(y=u.OwnerParagraph,u==l)break;u=u.NextNode}return r!=""&&(e!=null?(r+="<\/li>",r.indexOf("<ul")>-1?r+="<\/ul>":r.indexOf("<ol")>-1&&(r+="<\/ol>")):r+="<\/p>"),i.Paragraph!=y&&(b=this.GetNextRenderedBlock(),b!=null&&(r+=b.GetSelectedContentAsHtml(n,t,i))),r},i.prototype.GetContentAsHtml=function(){var i=null,n,r,t;for(this.ParagraphFormat.ListFormat!=null&&(i=this.ParagraphFormat.ListFormat.ListLevel),n="",i!=null?(n+=this.GetHtmlList(i,null),n+="<li "):n+="<p ",n+=this.ParagraphFormat.GetAsHtmlStyle(),n+=">",this.Inlines.length==0&&(n+="&nbsp;"),r=0;r<this.Inlines.length;r++)t=this.Inlines[r],t instanceof p?(n+="<span ",n+=t.CharacterFormat.GetAsHtmlStyle(),n+=">",n+=this.DecodeHtmlNames(t.Text),n+="<\/span>"):t instanceof d&&(n+="<img ",n+='width="'+t.Width+'" ',n+='height="'+t.Height+'" ',n+='src="'+t.ImageString+'" ',n+=t.CharacterFormat.GetAsHtmlStyle(),n+="/>");return i!=null?(n+="<\/li>",n.indexOf("<ul")>-1?n+="<\/ul>":n.indexOf("<ol")>-1&&(n+="<\/ol>")):n+="<\/p>",n},i.prototype.GetHtmlList=function(n){var t="";if(n.ListLevelPattern==v.Bullet){t+='<ul type="';switch(n.NumberFormat){case at.SQUAREBULLET:n.CharacterFormat.FontFamily!=null&&n.CharacterFormat.FontFamily=="Wingdings"&&(t+="square");break;case at.DOTBULLET:n.CharacterFormat.FontFamily!=null&&n.CharacterFormat.FontFamily=="Symbol"&&(t+="disc");break;case at.CIRCLEBULLET:n.CharacterFormat.FontFamily!=null&&n.CharacterFormat.FontFamily=="Symbol"&&(t+="circle")}t+='">'}else{t+='<ol type="';switch(n.ListLevelPattern){case v.Number:case v.Arabic:case v.Ordinal:t+="1";break;case v.LowLetter:t+="a";break;case v.UpLetter:t+="A";break;case v.LowRoman:t+="i";break;case v.UpRoman:t+="I"}t+='" start="'+n.StartAt.toString()+'">'}return t},i.prototype.ClearWidgets=function(){var n,t;if(this.paragraphWidgets!=null&&this.paragraphWidgets.Count>0)for(n=0;n<this.paragraphWidgets.Count;n++)t=this.paragraphWidgets[n],t.Dispose(),this.paragraphWidgets.Remove(t),n--},i.prototype.Dispose=function(){var n,t;if(this.CharacterFormat.Dispose(),this.ParagraphFormat.Dispose(),this.SetOwner(null),this.paragraphWidgets!=null&&(this.ClearWidgets(),this.paragraphWidgets=null),this.Inlines!=null){for(this.Inlines.Dispose(),n=0;n<this.Inlines.Count;n++)t=this.Inlines[n],t.Dispose(),this.Inlines.Remove(t),n--;this.ChildNodes=null}this.Fields=null;this.FieldCharacter=null},i.prototype.DecodeHtmlNames=function(n){var t,i,r;if(n=="\t")return"&emsp;";if(t=n.split(" "),i="",t.length>0)for(i=t[0],r=0;r<t.length-1;r++)i+="&nbsp;"+t[r+1];return i},i}(wi);t.ParagraphAdv=r;yt=function(t){function i(n){t.call(this,n);this.WordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","”"];this.characterFormat=new vr(this);this.Elements=new e}return n(i,t),Object.defineProperty(i.prototype,"CharacterFormat",{get:function(){return this.characterFormat},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OwnerParagraph",{get:function(){return this.Owner},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Length",{get:function(){return 1},enumerable:!0,configurable:!0}),i.prototype.LayoutFieldCharacter=function(n){var i,t,r;this instanceof f?(t=this,!n.IsFieldCode&&(t.fieldEnd!=null||t.HasFieldEnd)&&(n.FieldStack.push(t),n.IsFieldCode=!0)):n.FieldStack.Count>0&&(this instanceof ui?(t=n.FieldStack.Last(),i=this,t.fieldSeparator==i&&(t.fieldEnd!=null||t.HasFieldEnd)&&(n.IsFieldCode=!1)):(t=n.FieldStack.Last(),r=this,t.fieldEnd==r&&(n.FieldStack.RemoveAt(n.FieldStack.length-1),n.IsFieldCode=!1,t.HasFieldEnd&&(t.HasFieldEnd=!1))))},i.prototype.LayoutItems=function(n){var s,f;if(this instanceof u){this.LayoutFieldCharacter(n);this.NextNode!=null||n.IsFieldCode||n.LineElements.length!=0&&this.MoveToNextLine(n);return}if(!n.IsFieldCode){this.Elements!=null&&this.Elements.Count>0&&this.Elements.Clear();this.AddElementBox(n);var t=this.Elements[0],e="",r=0;for(this instanceof p&&(s=this,e=s.Text);r<this.Elements.Count;)t=this.Elements[r],t instanceof c&&t==this.Elements[0]&&(o.GetTextSize(t,this.CharacterFormat),e=="\t"&&(t.Width=this.OwnerParagraph.GetTabWidth(n))),n.CurrentHeaderFooter==null&&n.ClientActiveArea.Height<t.Height&&n.ClientActiveArea.Y!=n.ClientArea.Y&&this.OwnerParagraph.MoveToNextPage(n),f=this.PreviousNode instanceof i?this.PreviousNode:null,f!=null&&f instanceof p&&f.Text=="\v"&&(this.MoveToNextLine(n),t.Width=t.Width),t.Width<n.ClientActiveArea.Width?this.AddElementToline(n,t):t instanceof c?t.Text=="\t"?(this.MoveToNextLine(n),t.Width=this.OwnerParagraph.GetTabWidth(n),this.AddElementToline(n,t)):this.SplitTextForClientArea(n,t,t.Text,t.Width,this.CharacterFormat):this.SplitElementForClientArea(t,n),r=this.Elements.IndexOf(t)+1,r>=this.Elements.Count&&this.NextNode==null&&this.MoveToNextLine(n)}},i.prototype.GetSubWidth=function(n,t,i,r){for(var e,h,v,s,f=0,l=!0,u="",a=n.LineElements.length-1;a>=0;a--)e=n.LineElements[a],e instanceof c?(h=e.Text,u=h+u,l&&h.trim()!=""?(/ $/.test(h)?(v=h.replace(/\s\s*$/,""),f+=o.MeasureTextExcludIngSpaceAtEnd(v,this.CharacterFormat).Width):f+=e.Width,l=!1):l||(f+=e.Width)):(u="a"+u,l=!1,f+=e.Width),t||(f=Math.round(f));return u=u.trim(),i=u.length-u.replace(/\s/g,"").length,s=n.ClientArea.Width-r-f,s<=0||i==0&&t?(i=0,s=0):t&&(s=s/i),{subWidth:s,spaceCount:i}},i.prototype.IsParagraphFirstLine=function(n){if(n.ParagraphWidgets.length==1){var t=n.ParagraphWidgets[0];return t.ChildWidgets==null||t.ChildWidgets.length==0}return!1},i.prototype.IsParagraphLastLine=function(n,t){var i=t.Inlines[t.Inlines.length-1];return this==i?i.Elements.Count==0||n.LineElements.Contains(i.Elements[i.Elements.Count-1]):!1},i.prototype.AlignLineElements=function(n,t,i,r,u,f,e,s,h,l){var y,p,w,a,v;return t instanceof c||t instanceof rt?(y=t,p=t instanceof c?y.BaselineOffset:t.BaselineOffset,i+=n.LineElements.MaxBaselineOffset-p,r+=u-(t.Height-p),y!=null&&s==nt.Justify&&h>0&&(w=y.Width,a=y.Text,f||(a=a.replace(/^\s\s*/,""),f=a.length>0),f&&(v=a.length-a.replace(/\s/g,"").length,l&&(v-=a.length-a.replace(/\s\s*$/,"").length),h<v&&(w=o.MeasureTextExcludIngSpaceAtEnd(a,this.CharacterFormat).Width,v=h),v>0&&(y.Width=w+e*v,h-=v)))):(f=!0,i+=n.LineElements.MaxBaselineOffset-t.Height,r+=u),{topMargin:i,bottomMargin:r,addSubWidth:f,whiteSpaceCount:h}},i.prototype.MoveToNextLine=function(n){var e=this.Owner,l=e.ParagraphFormat,ft=this.IsParagraphFirstLine(e),g=this.IsParagraphLastLine(n,e),s=0,tt=0,w=0,i=0,it=0,r,b,k,c;ft&&(w=e.GetBeforeSpacing(),it=l.FirstLineIndent);g&&(tt=l.AfterSpacing);r=0;isNaN(n.LineElements.MaxTextElementHeight)?(b=o.MeasureText("a",e.CharacterFormat),r=b.Height,s=r-b.BaselineOffset):(r=n.LineElements.MaxTextElementHeight,s=r-n.LineElements.MaxTextElementBaselineOffset);n.CurrentHeaderFooter==null&&n.ClientActiveArea.Height<w+n.LineElements.MaxBaselineOffset+s&&n.ClientActiveArea.Y!=n.ClientArea.Y&&e.MoveToNextPage(n);i=e.GetLineSpacing(r);l.LineSpacingType==bt.Exactly&&i<s+n.LineElements.MaxBaselineOffset&&(i=s+n.LineElements.MaxBaselineOffset);var a=0,v=0,h=l.TextAlignment;h==nt.Left||h==nt.Justify&&g||(k=this.GetSubWidth(n,h==nt.Justify,v,it),a=k.subWidth,v=k.spaceCount);var y=this.OwnerParagraph.AddLineWidget(),rt=!1,ut=l.LineSpacingType;for(c=0;c<n.LineElements.length;c++){var t=0,u=0,d=0,f=n.LineElements[c],p=this.AlignLineElements(n,f,t,u,s,rt,a,h,v,c==n.LineElements.length-1);t=p.topMargin;u=p.bottomMargin;rt=p.addSubWidth;v=p.whiteSpaceCount;ut==bt.Multiple?i>r?u+=i-r:t+=i-r:ut==bt.Exactly?t+=i-(t+f.Height+u):i>t+f.Height+u&&(t+=i-(t+f.Height+u));t+=w;u+=tt;c==0&&(y.Height=t+f.Height+u,h==nt.Right?d=a:h==nt.Center&&(d=a/2));f.Margin=new fi(d,t,0,u);f.CurrentLineWidget=y;y.Children.Add(f)}n.CutFromTop(n.ClientActiveArea.Y+y.Height);n.LineElements.Clear()},i.prototype.AddElementToline=function(n,t){var i=this;n.CutFromLeft(n.ClientActiveArea.X+t.Width);this.OwnerParagraph.ParagraphFormat.TextAlignment==nt.Justify&&t instanceof c&&this.SplitTextElementWordByWord(t,n);this instanceof d&&(n.LineElements.SkipClipImage=!i.IsInlineImage);n.LineElements.push(t)},i.prototype.CheckPreviousElement=function(n,t){for(var f,l,a,r,u,v,h=!1,s=0,i=n.LineElements.length-1;i>=0;i--)if(n.LineElements[i]instanceof c){if(f=n.LineElements[i],l=f.Text,s=i,/ $/.test(l)){if(i==n.LineElements.length-1)return this.MoveToNextLine(n),!0;h=!0;break}else if(l.indexOf(" ")>=0){h=!0;a=l.lastIndexOf(" ")+1;r=new c(f.Inline);r.Index=f.Index+a;r.Length=f.Length-a;f.Length-=r.Length;this.Elements.Add(r);o.GetTextSize(r,t);f.Width-=r.Width;f.Height=r.Height;n.LineElements.splice(i+1,0,r);break}}else{s=i;h=!0;break}if(h){while(s<n.LineElements.length-1)s++;if(s++,u=new e,s<n.LineElements.Count){for(v=0,i=s;i<n.LineElements.Count;i++)v+=n.LineElements[i].Width,u.Add(n.LineElements[i]),n.LineElements.splice(i,1),i--;n.UpdateClientWidth(v)}for(this.MoveToNextLine(n),u.length>0&&u[0]instanceof c&&u[0].Text=="\t"&&(u[0].Width=this.OwnerParagraph.GetTabWidth(n)),i=0;i<u.length;i++)this.AddElementToline(n,u[i]);u.Clear()}return h},i.prototype.SplitTextForClientArea=function(n,t,i,r,u){var f=!0,e=-1,s;i.substring(0,1)==" "?e=1:(s=r,(e=i.replace(/\s\s*$/,"").indexOf(" ")+1)>0&&(s=o.MeasureTextExcludIngSpaceAtEnd(i.slice(0,e),u).Width),n.ClientActiveArea.Width<s&&(f=this.CheckPreviousElement(n,u),f&&(f=s<=n.ClientActiveArea.Width)));r<=n.ClientActiveArea.Width?this.AddElementToline(n,t):f&&(e>0||i.indexOf(" ")>0)?this.SplitByWord(n,t,i,r,u):this.SplitByCharacter(n,t,i,r,u)},i.prototype.SplitByWord=function(n,t,i,r,u){var e=this.GetSplitIndexByWord(n.ClientActiveArea.Width,i,r,u),f,s;e>0&&e<t.Length&&(f=new c(t.Inline),i=i.substring(e),i[0]==" "&&(s=i.length,i=i.replace(/^\s\s*/,""),e+=s-i.Length),f.Index=t.Index+e,f.Length=t.Length-e,t.Length-=f.Length,this.Elements.Add(f),o.GetTextSize(f,u),t.Width-=f.Width,t.Height=f.Height,this.AddElementToline(n,t),this.MoveToNextLine(n))},i.prototype.GetSplitIndexByWord=function(n,t,i,r){for(var f=0,e=t.length,u,s;f<e;)if(u=this.GetTextIndexAfterSpace(t,f),(u==0||u==e)&&(u=e-1),s=i,(u<e-1||u==e-1&&t[u-1]==" ")&&f!=u&&(s=o.MeasureTextExcludIngSpaceAtEnd(t.slice(0,u),r).Width),s<=n)f=u;else{f==0&&t[0]==" "&&(f=this.GetTextIndexAfterSpace(t,0));break}return f},i.prototype.GetTextIndexAfterSpace=function(n,t){var r=n.length,i=n.indexOf(" ",t)+1;if(i==0||i==r)return i;while(n[i]==" ")if(i++,i==r)break;return i},i.prototype.SplitByCharacter=function(n,t,i,r,u){var e=this.GetTextSplitIndexByCharacter(n.ClientArea.Width,n.ClientActiveArea.Width,i,r,u),s=0,f;e<t.Length&&(s=o.MeasureTextExcludIngSpaceAtEnd(i.substring(0,e),u).Width,i=i.substring(e));s>n.ClientActiveArea.Width&&n.LineElements.length>0&&this.MoveToNextLine(n);e<t.Length?(f=new c(t.Inline),f.Index=t.Index+e,f.Length=t.Length-e,t.Length-=f.Length,this.Elements.Add(f),o.GetTextSize(f,u),t.Width-=f.Width,t.Height=f.Height,this.AddElementToline(n,t),this.MoveToNextLine(n)):this.AddElementToline(n,t)},i.prototype.GetTextSplitIndexByCharacter=function(n,t,i,r,u){for(var e,s=i.length,f=0;f<s;f++)if(e=r,f+1<s&&(e=o.MeasureTextExcludIngSpaceAtEnd(i.substring(0,f+1),u).Width),e>t)return f==0&&e>n?s>1&&i[1]==" "?this.GetTextIndexAfterSpace(i,1):1:f;return 0},i.prototype.SplitTextElementWordByWord=function(n,t){var r=n.Text,f,u,e;if(r.trim().indexOf(" ")>=0){f=this.CharacterFormat;for(var s=f.FontSize,h=f.BaselineAlignment,l=f.Bold,a=f.Italic,i=n.Length-r.replace(/^\s\s*/,"").length;i<n.Length;){if(i=this.GetTextIndexAfterSpace(r,i),i==0||i==n.Length)break;i<n.Length&&(u=new c(n.Inline),e=r.substring(0,i),r=r.substring(i),r.substring(0,1)==" "&&(i+=r.length-r.replace(/^\s\s*/,"").length),u.Index=n.Index,u.Length=i,this.Elements.splice(this.Elements.indexOf(n),0,u),o.GetTextSize(u,f),t.LineElements.push(u),n.Index+=i,n.Length-=i,n.Width-=u.Width,i=0)}}},i.prototype.SplitElementForClientArea=function(n,t){t.LineElements.length>0&&this.MoveToNextLine(t);t.LineElements.length==0&&this.AddElementToline(t,n)},i.prototype.GetPhysicalPosition=function(n,t){var l=this.GetElementBox(n,t),i=l.element,r,e,f,s,h,a,c;return(n=l.index,i==null||i.CurrentLineWidget==null)?this instanceof u?this.GetFieldCharacterPosition():new k(0,0):(r=0,e=0,r=i.CurrentLineWidget.GetTop(),i instanceof li?(f=this.OwnerParagraph.CharacterFormat,s=this.GetPreviousTextInline(),s!=null?f=s.CharacterFormat:(h=this.GetNextTextInline(),h!=null&&(f=h.CharacterFormat)),a=o.MeasureText("a",f),c=a.BaselineOffset,i.Margin.Top+i.Height-c>0&&(r+=i.Margin.Top+i.Height-c)):r+=i.Margin.Top>0?i.Margin.Top:0,e=i.CurrentLineWidget.GetLeftInternal(i,n),new k(e,r))},i.prototype.GetFieldCharacterPosition=function(){var n=this,t,i;return this instanceof f&&n.IsLinkedFieldCharacter()&&(n=n.fieldSeparator==null?n.fieldEnd:n.fieldSeparator),t=null,n.NextNode!=null&&(t=n.NextNode.GetNextValidInline()),t==null?(i=n.OwnerParagraph,i.GetEndPosition()):t.GetPhysicalPosition(0,!0)},i.prototype.GetText=function(n,t,r,u){var e="",o=this,h,s;do{if(o==t)return o instanceof p?(h=o,h.Text==null||h.Text==""||(e=h.Text.length<r?e+h.Text:e+h.Text.substring(0,r))):o instanceof d&&u&&r==o.Length&&(e=e+i.OBJECT_CHARACTER),e;if(o instanceof p?e=e+o.Text:o instanceof d&&u?e=e+i.OBJECT_CHARACTER:o instanceof f&&o.fieldEnd!=null&&(o=o.fieldSeparator!=null?o.fieldSeparator:o.fieldEnd),o.NextNode==null)break;o=o.NextNode}while(1);if(n==this.OwnerParagraph)return e;for(s=this.OwnerParagraph.GetNextParagraph();s!=null&&s.IsEmpty();){if(e=e+"\r",s==n)return e;s=s.GetNextParagraph()}return s==null||s.IsEmpty()||(e=e+"\r"+s.Inlines[0].GetText(n,t,r,u)),e},i.prototype.GetElementBox=function(n,t){var r=null,i,u;if(this.Elements.Count>0&&(r=this.Elements[this.Elements.Count-1]),r instanceof c)for(i=0;i<this.Elements.Count;i++){if(u=this.Elements[i]instanceof c?this.Elements[i].Length:1,u>=n||u+1==n&&i==this.Elements.Count-1){r=this.Elements[i];t&&n==u&&i<this.Elements.Count-1&&r.CurrentLineWidget!=this.Elements[i+1].CurrentLineWidget&&(r=this.Elements[i+1],n=0);break}n-=u}return{index:n,element:r}},i.prototype.GetElementBoxInternal=function(n){var i=null,t,r;if(this.Elements.Count>0&&(i=this.Elements[this.Elements.Count-1]),i instanceof c)for(t=0;t<this.Elements.Count;t++){if(r=this.Elements[t]instanceof c?this.Elements[t].Length:1,r>=n||r+1==n&&t==this.Elements.Count-1){i=this.Elements[t];break}n-=r}return{element:i,index:n}},i.prototype.GetPreviousTextInline=function(){return this.PreviousNode instanceof p?this.PreviousNode:this.PreviousNode!=null?this.PreviousNode.GetPreviousTextInline():null},i.prototype.GetNextTextInline=function(){return this.NextNode instanceof p?this.NextNode:this.NextNode!=null?this.NextNode.GetNextTextInline():null},i.prototype.GetLineWidget=function(n){return this.GetLineWidgetInternal(n,!0)},i.prototype.GetLineWidgetInternal=function(n,t){var s=this.GetElementBox(n,t),h=s.element,i,r,u,o,e;return(n=s.index,h!=null)?h.CurrentLineWidget:(i=this,this instanceof f&&i.IsLinkedFieldCharacter()&&(i=i.fieldSeparator==null?i.fieldEnd:i.fieldSeparator),r=null,i.NextNode!=null&&(r=i.NextNode.GetNextValidInline()),r==null?(u=i.OwnerParagraph,o=null,u.ParagraphWidgets.Count>0&&(e=u.ParagraphWidgets[u.ParagraphWidgets.Count-1],e.ChildWidgets.Count>0&&(o=e.ChildWidgets[e.ChildWidgets.Count-1])),o):r.GetLineWidget(0))},i.prototype.GetCaretHeight=function(n,t,i,r,f){var w=this.GetElementBox(n,!1),e,v,s,h,c,p,l,a;if(n=w.index,e=w.element,v=this,e==null)return v instanceof u?v.GetFieldCharacterHeight(t,i,r,f):{Height:o.MeasureText("a",t).Height,TopMargin:r,IsItalic:f};if(s=0,e instanceof li)if(h=this.GetPreviousTextInline(),c=this.GetNextTextInline(),h==null&&c==null){var b=0,k=0,y=this.OwnerParagraph.GetParagraphMarkSize(b,k);b=y.TopMargin;k=y.BottomMargin;s=y.Height;f=this.OwnerParagraph.CharacterFormat.Italic;i||(s+=this.OwnerParagraph.ParagraphFormat.AfterSpacing)}else{if(h==null)return f=c.CharacterFormat.Italic,c.GetCaretHeight(0,c.CharacterFormat,i,r,f);if(c!=null&&e instanceof li){var d=o.MeasureText("a",e.Inline.CharacterFormat),g=d.Height,nt=d.BaselineOffset;s=e.Margin.Top<0&&nt>e.Margin.Top+e.Height?e.Margin.Top+e.Height+g-nt:g;i||(s+=e.Margin.Bottom)}else return f=h.CharacterFormat.Italic,h.GetCaretHeight(h.Length,h.CharacterFormat,i,r,f)}else p=t.BaselineAlignment,l=e.Height,p!=ct.Normal&&i&&(l=l/1.5,p==ct.Subscript&&(r=e.Height-l)),s=(e.Margin.Top<0?e.Margin.Top:0)+l,i||(s+=e.Margin.Bottom);return i?(a=o.MeasureText("a",t).Height,a>s&&(a=s),{Height:a,TopMargin:r,IsItalic:f}):{Height:s,TopMargin:r,IsItalic:f}},i.prototype.GetFieldCharacterHeight=function(n,t,i,r){var u=this,e;if(u instanceof f&&u.IsLinkedFieldCharacter()&&(u=u.fieldSeparator==null?u.fieldEnd:u.fieldSeparator),e=null,u.NextNode!=null&&(e=u.NextNode.GetNextValidInline()),e==null){var v=u.OwnerParagraph,h=o.GetParagraphMarkSize(n).Height,a=0,c=0,l=v.GetParagraphMarkSize(a,c),s=l.Height;return(a=l.TopMargin,c=l.BottomMargin,!t)?(s+=c,{Height:s,TopMargin:i,IsItalic:r}):(h>s&&(h=s),{Height:h,TopMargin:i,IsItalic:r})}return e.GetCaretHeight(0,n,t,i,r)},i.prototype.GetPreviousValidInline=function(){for(var n=this,t=null;n instanceof u;)n.IsLinkedFieldCharacter()&&(n instanceof f?t=n:n instanceof h?(t=n,n.FieldSeparator==null&&(n=n.FieldBegin,t=n)):(n=n.fieldBegin,t=n)),n=n.PreviousNode;return t==null?n:t},i.prototype.ValidateTextPosition=function(n){var t=this,i,r;return t.Length==n&&t.NextNode instanceof u?(i=t.NextNode.GetNextValidInline(),i instanceof h&&(t=i,n=1)):n==0&&t.PreviousNode instanceof u&&(r=t.PreviousNode.GetPreviousValidInline(),t=r,n=t instanceof u?0:t.Length,t instanceof h&&n++),{inline:t,index:n}},i.prototype.GetNextValidInline=function(){for(var n=this,t=null;n instanceof u;){if(n instanceof f&&n.fieldEnd!=null)return t==null?n:t;n instanceof h&&n.FieldBegin!=null&&(t=n);n=n.NextNode}return t==null?n:t},i.prototype.IsLastRenderedInline=function(n){for(var t=this,r,i,e;n==t.Length&&t.NextNode instanceof u;)if(r=t.NextNode.GetNextValidInline(),n=0,r instanceof f&&(t=r),t instanceof f&&t.fieldEnd!=null)if(i=t,i.fieldSeparator==null)t=i.fieldEnd,n=1;else if(t=i.fieldSeparator,e=t.OwnerParagraph,n=1,e!=i.fieldEnd.OwnerParagraph||e.HasValidInline(t,i.fieldEnd))break;else t=i.fieldEnd;return n==t.Length&&t.NextNode==null},i.prototype.GetNextRenderedInline=function(n){var t=this,r,i;if(t instanceof f){if(i=t,t=i.GetRenderedField(),i==t)return i;n=1}while(n==t.Length&&t.NextNode instanceof u)if(r=t.NextNode.GetNextValidInline(),r instanceof f){if(i=r,t=i.GetRenderedField(),i==t)return i;n=1}else t=r;return t},i.prototype.IsExistAfter=function(n){return this.OwnerParagraph==n.OwnerParagraph?this.OwnerParagraph.Inlines.IndexOf(this)>this.OwnerParagraph.Inlines.IndexOf(n):this.OwnerParagraph.Owner==n.OwnerParagraph.Owner?this.OwnerParagraph.IsInsideTable?this.OwnerParagraph.AssociatedCell.Blocks.IndexOf(this.OwnerParagraph)>n.OwnerParagraph.AssociatedCell.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.Owner instanceof s?this.OwnerParagraph.Owner.Blocks.IndexOf(this.OwnerParagraph)>n.OwnerParagraph.Owner.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.Section.Blocks.IndexOf(this.OwnerParagraph)>n.OwnerParagraph.Section.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.IsExistAfter(n.OwnerParagraph)},i.prototype.IsExistBefore=function(n){return this.OwnerParagraph==n.OwnerParagraph?this.OwnerParagraph.Inlines.IndexOf(this)<this.OwnerParagraph.Inlines.IndexOf(n):this.OwnerParagraph.Owner==n.OwnerParagraph.Owner?this.OwnerParagraph.IsInsideTable?this.OwnerParagraph.AssociatedCell.Blocks.IndexOf(this.OwnerParagraph)<n.OwnerParagraph.AssociatedCell.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.Owner instanceof s?this.OwnerParagraph.Owner.Blocks.IndexOf(this.OwnerParagraph)<n.OwnerParagraph.Owner.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.Section.Blocks.IndexOf(this.OwnerParagraph)<n.OwnerParagraph.Section.Blocks.IndexOf(n.OwnerParagraph):this.OwnerParagraph.IsExistBefore(n.OwnerParagraph)},i.prototype.Find=function(n,t,i,r,u,e){var o=this,a=new String,nt=new kt,v,rt,y,ut,w,k,l,g,h,et;do{if(o instanceof p&&o.Text!=null&&o.Text!=""?(nt.Add(o,a.length),a=o==this?a+o.Text.substring(i):a+o.Text):o instanceof f&&(v=o,v.fieldEnd!=null&&(o=v.fieldSeparator==null?v.fieldEnd:v.fieldSeparator)),o.NextNode==null)break;o=o.NextNode}while(1);for(rt=a.toString(),y=[];(ut=n.exec(rt))!=null;)y.push(ut);for(w=0;w<y.length;w++){var c=y[w],ft=nt.Keys,b=new ei(e),tt=new ei(e);for(k=0;k<ft.Count;k++){var s=ft[k],d=nt.Get(s),it=s.Length;if(s==this&&(it-=i),b.Paragraph==null&&c.index<=d+it&&(l=c.index-d,s==this&&(l+=i),g=s.OwnerParagraph.GetOffset(s,l),b.SetPositionParagraph(s.OwnerParagraph,g)),c.index+c[0].length<=d+it){l=c.index+c[0].length-d;s==this&&(l+=i);g=s.OwnerParagraph.GetOffset(s,l);tt.SetPositionParagraph(s.OwnerParagraph,g);break}}if(tt.UpdateTextPositionOnFieldCharacter(b),r)return e.Selection.SelectRange(b,tt,!0),!0}for(h=o.OwnerParagraph.GetNextParagraph();h!=null&&h.Inlines.Count==0;)h=h.GetNextParagraph();return h!=null&&h.Inlines.Count>0?(et=h.Inlines[0],et.Find(n,t,0,r,u,e)):!1},i.prototype.ClearElements=function(n){var t,i;if(this.Elements!=null)for(t=0;t<this.Elements.Count;t++)i=this.Elements[t],this.Elements.Remove(i),t--;n&&this.Elements.Clear()},i.OBJECT_CHARACTER="￼",i.WordSplitCharacters=[],i}(dt);t.Inline=yt;p=function(t){function i(n){t.call(this,n);this.text=""}return n(i,t),Object.defineProperty(i.prototype,"Text",{get:function(){return this.text},set:function(n){this.text=n;this.OnTextChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Length",{get:function(){return this.text.length},enumerable:!0,configurable:!0}),i.prototype.OnTextChanged=function(){if(this.OwnerParagraph instanceof r){var n=this.OwnerParagraph.Inlines.indexOf(this);n>-1&&this.Text!="\t"&&this.Text!="\v"&&this.Text.length>=1&&this.SplitByTabOrLineBreakCharacter(n)}},i.prototype.AddElementBox=function(){var n=new c(this);n.Index=0;n.Length=this.Text.length;this.Elements.Add(n)},i.prototype.SplitByTabOrLineBreakCharacter=function(n){var r=this.Text,u=r.indexOf("\t"),e=r.indexOf("\v"),t=-1,o,f;t=u>-1&&e>-1?u<e?u:e:u>-1?u:e;t>-1&&(o=r.substring(t+1),f=new i(null),f.CharacterFormat.CopyFormat(this.CharacterFormat),this.OwnerParagraph.Inlines.Insert(n+1,f),t>0?(f.Text=r.substring(t),this.Text=r.substring(0,t)):o!=""&&(f.Text=o,this.Text=r.substring(t,t+1)))},i.prototype.SplitByBreakCharacter=function(n,t,u,f){var v=n,c=t.indexOf("\r"),o=t.substring(c+1),s=new i(null),e,a,l,h;s.CharacterFormat.CopyFormat(n.CharacterFormat);e=n.OwnerParagraph;u==null&&(u.ParagraphFormat.CopyFormat(e.ParagraphFormat),u.CharacterFormat.CopyFormat(e.CharacterFormat));e.Inlines.Contains(n)&&e.Inlines.Remove(n);c>0&&(s.Text=t.substring(0,c));s.Text!=""&&u.Inlines.Add(s);u.Inlines.Count>0&&(e.IsInsideTable?e.AssociatedCell.Blocks.Add(u):e.Section.Blocks.Add(u));a=o.indexOf("\r");a>0?(l=null,this.SplitByBreakCharacter(v,o,l,l)):o!=null&&o!=""&&(h=new i(null),h.CharacterFormat.CopyFormat(n.CharacterFormat),f==null&&(f=new r(this),f.ParagraphFormat.CopyFormat(e.ParagraphFormat),f.CharacterFormat.CopyFormat(e.CharacterFormat)),h.Text=o,f.Inlines.Insert(0,h),e.IsInsideTable?e.AssociatedCell.Blocks.Add(f):e.Section.Blocks.Add(f))},i.prototype.GetNextWordOffset=function(n,t,i,r,u,f){var s,e,o,h;if(this.Text=="\t"){if(i){u.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,n));r=!1;return}n==0?(r=!0,s=this.OwnerParagraph.GetOffset(this,0),u.Offset==s?u.SetPositionParagraph(this.OwnerParagraph,s+this.Length):u.SetPositionParagraph(this.OwnerParagraph,s)):this.NextNode!=null&&this.NextNode.GetNextWordOffset(0,t,i,r,u,f)}else if(e=0,n==0&&r&&this.WordSplitCharacters.indexOf(this.Text[0])==-1){if(u.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,n)),i)return}else if(n<this.Length)if(o=n>0&&this.Text.length-1>=n?this.Text.slice(n,this.Length):this.Text,e=st.IndexOfAny(o,this.WordSplitCharacters),e!=-1){if(i){r=!1;return}if(h=this.OwnerParagraph.GetOffset(this,e+n),(f||o[e]!=" ")&&!r&&this.OwnerParagraph==u.Paragraph&&h!=u.Offset){r=!0;u.SetPositionParagraph(this.OwnerParagraph,h);return}for(e++;e<o.length&&this.WordSplitCharacters.indexOf(o[e])!=-1;){if(o[e]!=" "&&o[e-1]==" ")break;e++}if(r=!0,e<o.length)u.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,e+n));else if(this.NextNode!=null)this.NextNode.GetNextWordOffset(0,t,i,r,u,f);else{if(i){r=!1;return}u.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,e+n))}}else if(this.NextNode!=null)this.NextNode.GetNextWordOffset(0,t,i,r,u,f);else{if(i){r=!1;return}u.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetEndOffset())}else this.NextNode!=null&&this.NextNode.GetNextWordOffset(0,t,i,r,u,f)},i.prototype.GetPreviousWordOffset=function(n,t,i,r,u,f){var s,e,o,h;if(this.Text=="\t"){if(i){u=!1;return}n==0?(u=!0,s=this.OwnerParagraph.GetOffset(this,this.Length),s==f.Offset?f.SetPositionParagraph(this.OwnerParagraph,s-this.Length):f.SetPositionParagraph(this.OwnerParagraph,s)):this.PreviousNode!=null&&this.PreviousNode.GetPreviousWordOffset(this.PreviousNode.Length,t,i,r,u,f)}else{if(e=0,!r){while(n>0&&this.Text[n-1]==" ")n--;f.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,n))}if(n>0){if(r=!0,n==0&&u&&this.WordSplitCharacters.indexOf(this.Text[0])==-1){f.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,n));u=!0;return}if(o=this.Text.length>n?this.Text.slice(0,n):this.Text,e=st.LastIndexOfAny(o,this.WordSplitCharacters),e!=-1){if(i){u=!1;return}while(e>0&&u&&o[e]!=" "&&this.WordSplitCharacters.indexOf(o[e-1])!=-1)e--;o[e]!=" "&&u||e++;u=!0;e>0?(h=this.OwnerParagraph.GetOffset(this,e),this.OwnerParagraph==f.Paragraph&&h==f.Offset?this.GetPreviousWordOffset(n,t,i,r,u,f):f.SetPositionParagraph(this.OwnerParagraph,h)):this.PreviousNode!=null?this.PreviousNode.GetPreviousWordOffset(this.PreviousNode.Length,t,i,r,u,f):f.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,0))}else this.PreviousNode!=null?this.PreviousNode.GetPreviousWordOffset(this.PreviousNode.Length,t,i,r,u,f):f.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetStartOffset())}else this.PreviousNode!=null?this.PreviousNode.GetPreviousWordOffset(this.PreviousNode.Length,t,i,r,u,f):f.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetStartOffset())}},i.prototype.Dispose=function(){this.CharacterFormat.Dispose();this.Text="";this.SetOwner(null)},i}(yt);t.SpanAdv=p;d=function(t){function i(n,i,r){t.call(this,n);this.imageString="";this.width=0;this.height=0;this.isInlineImage=!0;this.isMetaFile=!1;this.isInlineImage=i;this.isMetaFile=r}return n(i,t),Object.defineProperty(i.prototype,"ImageString",{get:function(){return this.imageString},set:function(n){this.imageString=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Width",{get:function(){return this.width},set:function(n){this.width=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Height",{get:function(){return this.height},set:function(n){this.height=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsInlineImage",{get:function(){return this.isInlineImage},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsMetaFile",{get:function(){return this.isMetaFile},enumerable:!0,configurable:!0}),i.prototype.AddElementBox=function(){var n=new li(this);n.Height=this.Height;n.Width=this.Width;this.Elements.Add(n)},i.prototype.GetNextWordOffset=function(n,t,i,r,u,f){if(i){u.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,n));r=!1;return}if(n==0){var e=this.OwnerParagraph.GetOffset(this,0);r=!0;u.Offset==e?this.NextNode==null?u.SetPositionParagraph(this.OwnerParagraph,e+this.Length):this.NextNode.GetNextWordOffset(0,t,i,r,u,f):u.SetPositionParagraph(this.OwnerParagraph,e)}else this.NextNode!=null&&this.NextNode.GetNextWordOffset(0,t,i,r,u,f)},i.prototype.GetPreviousWordOffset=function(n,t,i,r,u,f){if(i){f.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetOffset(this,n));u=!1;return}if(n==this.Length){var e=this.OwnerParagraph.GetOffset(this,this.Length);e==f.Offset?f.SetPositionParagraph(this.OwnerParagraph,e-this.Length):f.SetPositionParagraph(this.OwnerParagraph,e)}else this.PreviousNode!=null&&this.PreviousNode.GetPreviousWordOffset(this.PreviousNode.Length,t,i,r,u,f)},i.prototype.Dispose=function(){this.CharacterFormat.Dispose();this.ImageString="";this.SetOwner(null);this.ClearElements(!0)},i}(yt);t.ImageAdv=d;u=function(t){function i(){t.apply(this,arguments)}return n(i,t),i.prototype.AddElementBox=function(){},i.prototype.GetRenderedInline=function(n){for(var r=this.GetPreviousValidInline(),t;r instanceof i;)r=r.GetPreviousTextInline(),r instanceof i&&(r=r.PreviousNode);if(r!=null)return n=r.Length,{Inline:r,InlineIndex:n};if(n=0,t=this.GetNextRenderedInline(0),t instanceof f)for(t=t.fieldSeparator,t=t.NextNode;t instanceof i;)t instanceof f&&t.IsLinkedFieldCharacter()&&(t=t.fieldSeparator==null?t.fieldEnd:t.fieldSeparator),t=t.NextNode;return{Inline:r,InlineIndex:n}},i.prototype.Dispose=function(){this.CharacterFormat.Dispose();this.SetOwner(null);this.ClearElements(!0)},i}(yt);t.FieldCharacterAdv=u;f=function(t){function i(n){t.call(this,n);this.FieldSeparator=null;this.FieldEnd=null}return n(i,t),Object.defineProperty(i.prototype,"fieldSeparator",{get:function(){return this.FieldSeparator},set:function(n){if(this.FieldSeparator!=n){var t=this.fieldSeparator;this.FieldSeparator=n;t!=null&&(t.fieldBegin=null,t=null);this.fieldSeparator!=null&&(this.fieldSeparator.fieldBegin=this)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fieldEnd",{get:function(){return this.FieldEnd},set:function(n){if(this.FieldEnd!=n){var t=this.fieldEnd;this.FieldEnd=n;t!=null&&(t.fieldBegin=null,t=null);this.fieldEnd!=null&&(this.fieldEnd.fieldBegin=this)}},enumerable:!0,configurable:!0}),i.prototype.IsLinkedFieldCharacter=function(){return!0},i.prototype.CheckUnlinkFieldCharacter=function(n,t){if(this.fieldSeparator!=null){if(t){var i=this.fieldSeparator.OwnerParagraph.GetHierarchicalIndex("");if(i.indexOf(n)>=0)return}this.fieldSeparator.fieldBegin=null;this.fieldSeparator=null}},i.prototype.AddToLinkedFields=function(){var n=this;n.RemoveAfterLinking(n);n.FieldSeparator!=null&&n.RemoveAfterLinking(n.FieldSeparator);n.RemoveAfterLinking(n.FieldEnd);this.Owner.AddFields(this)},i.prototype.IsUnlinkFieldCharacters=function(){if(this.fieldEnd==null)return!1;var n=this.fieldEnd.OwnerParagraph.GetHierarchicalIndex("");return!(n.indexOf(n)>=0)},i.prototype.UnlinkFieldCharacter=function(n,t){var i,r;this.fieldSeparator!=null&&(i=!0,t&&(r=this.fieldSeparator.OwnerParagraph.GetHierarchicalIndex(""),r.indexOf(n)>=0&&(i=!1)),i?(this.fieldSeparator.Owner.AddFieldCharacter(this.fieldSeparator),this.fieldSeparator.fieldBegin=null,this.fieldSeparator=null):this.fieldSeparator.Owner.AddFieldCharacter(this.fieldSeparator));this.fieldEnd!=null&&(this.fieldEnd.Owner.AddFieldCharacter(this.fieldEnd),this.fieldEnd.fieldBegin=null,this.fieldEnd=null);this.Owner.Fields.Contains(this)&&this.Owner.Fields.Remove(this);t&&this.Owner.AddFieldCharacter(this)},i.prototype.RemoveAfterLinking=function(n){this.Owner.RemoveFieldCharacter(n)},i.prototype.GetRenderedField=function(){var n=this,t;if(this.FieldSeparator==null)n=this.FieldEnd;else{if(n=this.FieldSeparator,t=n.OwnerParagraph,t!=this.FieldEnd.OwnerParagraph||t.HasValidInline(n,this.FieldEnd))return this;n=this.FieldEnd}return n},i.prototype.GetFieldCode=function(){if(this.fieldEnd==null||this.OwnerParagraph==null)return"";return this.OwnerParagraph.GetFieldCode(this,!1,!1,this)},i.prototype.InlineIsInFieldResult=function(n){return this.fieldEnd!=null&&this.fieldSeparator!=null&&this.fieldSeparator.IsExistBefore(n)?this.fieldEnd.IsExistAfter(n):!1},i.prototype.ParagraphIsInFieldResult=function(n){return this.fieldEnd!=null&&this.fieldSeparator!=null&&(this.fieldSeparator.Owner==n||this.fieldSeparator.OwnerParagraph.IsExistBefore(n))?this.fieldEnd.Owner!=n&&this.fieldEnd.OwnerParagraph.IsExistAfter(n):!1},i.prototype.GetNextWordOffset=function(n,t,i,r,u,f){var o=this.OwnerParagraph.GetOffset(this,0),s=o+this.Length,e;if(this.FieldSeparator==null)this.fieldEnd.GetNextWordOffset(0,t,i,r,u,f);else if(this.fieldEnd!=null&&t!=0){if(e=this.FieldSeparator,e.OwnerParagraph!=this.FieldEnd.OwnerParagraph||e.OwnerParagraph.HasValidInline(e,this.FieldEnd)||(e=this.FieldEnd),e.GetNextWordOffset(0,t,!(u.Paragraph==this.OwnerParagraph&&u.Offset==o),r,u,f),r&&this.fieldSeparator!=null&&u.Paragraph==this.OwnerParagraph&&u.Offset==this.fieldSeparator.OwnerParagraph.GetOffset(this.fieldSeparator,this.fieldSeparator.Length)){u.SetPositionParagraph(this.OwnerParagraph,o);return}r||u.SetPositionParagraph(this.fieldEnd.OwnerParagraph,this.fieldEnd.OwnerParagraph.GetOffset(this.fieldEnd,this.fieldEnd.Length))}},i.prototype.GetPreviousWordOffset=function(n,t,i,r,u,f){var e=this.OwnerParagraph.GetOffset(this,0),o=e+this.Length;f.Offset==o&&f.SetPositionParagraph(this.OwnerParagraph,e);this.PreviousNode!=null?(this.PreviousNode.GetPreviousWordOffset(this.PreviousNode.Length,t,!1,r,u,f),f.Offset==e&&f.SetPositionParagraph(this.OwnerParagraph,o)):f.SetPositionParagraph(this.OwnerParagraph,this.OwnerParagraph.GetStartOffset())},i}(u);t.FieldBeginAdv=f;ui=function(t){function i(n){t.call(this,n);this.FieldBegin=null;this.FieldEnd=null}return n(i,t),Object.defineProperty(i.prototype,"fieldBegin",{get:function(){return this.FieldBegin},set:function(n){if(this.FieldBegin!=n){var t=this.FieldBegin;this.FieldBegin=n;t!=null&&(t.fieldSeparator=null,t=null);this.fieldBegin!=null&&(this.fieldBegin.fieldSeparator=this)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fieldEnd",{get:function(){return this.FieldEnd},set:function(n){if(this.FieldEnd!=n){var t=this.FieldEnd;this.FieldEnd=n;t!=null&&(t.fieldSeparator=null,t=null);this.fieldEnd!=null&&(this.fieldEnd.fieldSeparator=this)}},enumerable:!0,configurable:!0}),i.prototype.IsLinkedFieldCharacter=function(){return this.fieldBegin!=null&&this.fieldEnd!=null},i.prototype.GetNextWordOffset=function(n,t,i,r,u,f){this.NextNode!=null&&this.NextNode.GetNextWordOffset(0,t,i,r,u,f)},i.prototype.GetPreviousWordOffset=function(n,t,i,r,u,f){this.FieldBegin.GetPreviousWordOffset(this.FieldBegin.Length,t,i,r,u,f)},i.prototype.UnlinkFieldCharacter=function(n,t){var i,r;this.fieldBegin!=null&&(i=!0,t&&(r=this.fieldBegin.OwnerParagraph.GetHierarchicalIndex(""),r.indexOf(n)>=0&&(i=!1)),this.fieldEnd!=null,i?(this.fieldBegin.Owner.AddFieldCharacter(this.fieldBegin),this.fieldBegin.fieldSeparator=null,this.fieldBegin=null):this.fieldBegin.Owner.AddFieldCharacter(this.fieldBegin));this.fieldEnd!=null&&(i=!0,t&&(r=this.fieldEnd.OwnerParagraph.GetHierarchicalIndex(""),r.indexOf(n)>0&&(i=!1)),i?(this.fieldEnd.Owner.AddFieldCharacter(this.fieldEnd),this.fieldEnd.fieldSeparator=null,this.fieldEnd=null):this.fieldEnd.Owner.AddFieldCharacter(this.fieldEnd));t&&this.Owner.AddFieldCharacter(this)},i.prototype.CheckUnlinkFieldCharacter=function(n,t){var i;if(this.fieldBegin!=null){if(t&&(i=this.fieldBegin.OwnerParagraph.GetHierarchicalIndex(""),i.indexOf(n)>=0))return;this.fieldBegin.fieldSeparator=null;this.fieldBegin=null}if(this.fieldEnd!=null){if(t&&(i=this.fieldEnd.OwnerParagraph.GetHierarchicalIndex(""),i.indexOf(n)>=0))return;this.fieldEnd.fieldSeparator=null;this.fieldEnd=null}},i}(u);t.FieldSeparatorAdv=ui;h=function(t){function i(n){t.call(this,n);this.FieldBegin=null;this.FieldSeparator=null}return n(i,t),Object.defineProperty(i.prototype,"fieldBegin",{get:function(){return this.FieldBegin},set:function(n){if(this.FieldBegin!=n){var t=this.FieldBegin;this.FieldBegin=n;t!=null&&(t.fieldEnd=null,t=null);this.fieldBegin!=null&&(this.fieldBegin.fieldEnd=this)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fieldSeparator",{get:function(){return this.FieldSeparator},set:function(n){if(this.FieldSeparator!=n){var t=this.FieldSeparator;this.FieldSeparator=n;t!=null&&(t.fieldEnd=null,t=null);this.fieldSeparator!=null&&(this.fieldSeparator.fieldEnd=this)}},enumerable:!0,configurable:!0}),i.prototype.IsLinkedFieldCharacter=function(){return this.fieldBegin!=null},i.prototype.CheckUnlinkFieldCharacter=function(n,t){if(this.fieldSeparator!=null){if(t){var i=this.fieldSeparator.OwnerParagraph.GetHierarchicalIndex("");if(i.indexOf(n)>=0)return}this.fieldSeparator.fieldEnd=null;this.fieldSeparator=null}},i.prototype.UnlinkFieldCharacter=function(n,t){var i,r;this.fieldBegin.Owner.Fields.Contains(this.fieldBegin)&&this.fieldBegin.Owner.Fields.Remove(this.fieldBegin);this.fieldBegin.Owner.AddFieldCharacter(this.fieldBegin);this.fieldBegin.fieldEnd=null;this.fieldBegin=null;this.fieldSeparator!=null&&(i=!0,t&&(r=this.fieldSeparator.OwnerParagraph.GetHierarchicalIndex(""),r.indexOf(n)>0&&(i=!1)),i?(this.fieldSeparator.Owner.AddFieldCharacter(this.fieldSeparator),this.fieldSeparator.fieldEnd=null,this.fieldSeparator=null):this.fieldSeparator.Owner.AddFieldCharacter(this.fieldSeparator));t&&this.Owner.AddFieldCharacter(this)},i.prototype.GetNextWordOffset=function(n,t,i,r,u,f){var e=this.OwnerParagraph.GetOffset(this,0),o=e+this.Length;(u.Offset!=e||(u.SetPositionParagraph(this.OwnerParagraph,o),this.NextNode!=null))&&(this.NextNode!=null?(this.NextNode.GetNextWordOffset(0,t,!1,r,u,f),u.Offset==o&&u.SetPositionParagraph(this.OwnerParagraph,e)):u.SetPositionParagraph(this.OwnerParagraph,e),r=!0)},i.prototype.GetPreviousWordOffset=function(n,t,i,r,u,f){var o=this.OwnerParagraph.GetOffset(this,0),s=o+this.Length,e;if(this.FieldSeparator==null)this.fieldBegin.GetPreviousWordOffset(0,t,i,r,u,f);else if(this.fieldBegin!=null&&t!=0){if(e=this.PreviousNode,e!=null&&(e.OwnerParagraph!=this.fieldBegin.OwnerParagraph||e.OwnerParagraph.HasValidInline(e,this.fieldBegin))||(e=this.fieldBegin),e.GetPreviousWordOffset(e.Length,t,!(f.Paragraph==this.OwnerParagraph&&f.Offset==s),r,u,f),u&&f.Paragraph==this.OwnerParagraph&&f.Offset==o){f.SetPositionParagraph(this.OwnerParagraph,s);return}u||f.SetPositionParagraph(this.fieldBegin.OwnerParagraph,this.fieldBegin.OwnerParagraph.GetOffset(this.fieldBegin,0))}},i}(u);t.FieldEndAdv=h;cu=function(){function n(n){this.hyperLink=n}return Object.defineProperty(n.prototype,"Hyperlink",{get:function(){return this.hyperLink},enumerable:!0,configurable:!0}),n}();t.RequestNavigateEventArgs=cu;kr=function(){function n(n){var t=n.GetFieldCode(),i=t.toLowerCase();t=t.substring(i.indexOf("hyperlink")+9);this.ParseFieldValues(t.trim())}return Object.defineProperty(n.prototype,"NavigationLink",{get:function(){return this.navigationLink},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LinkType",{get:function(){return this.linkType},enumerable:!0,configurable:!0}),n.prototype.ParseFieldValue=function(n,t,i){n.string=n.string.substring(1);var r=n.string.indexOf(i);r==-1?r=n.string.length:this.navigationLink==null&&(this.navigationLink=n.string.substring(0,r));n.string=n.string.substring(r+1).trim()},n.prototype.ParseFieldValues=function(n){for(var t={string:n},i=0,r;t.string.length>0;){r=t.string.substring(0,1);switch(r){case'"':this.ParseFieldValue(t,i,'"');i=0;break;case"\\l":case"\\t":n=n.substring(2);default:this.ParseFieldValue(t,i," ");i=0}t.string=t.string.trim()}this.navigationLink=this.navigationLink.trim();this.navigationLink.match("http://")||this.navigationLink.match("https://")?this.linkType=nr.Webpage:this.navigationLink.match("mailto:")?this.linkType=nr.Email:this.navigationLink.match("www.")?(this.navigationLink="http://"+this.navigationLink,this.linkType=nr.Webpage):this.navigationLink.match("@")?(this.navigationLink="mailto:"+this.navigationLink,this.linkType=nr.Email):this.linkType=nr.File},n}();t.HyperLink=kr;a=function(){function n(n,t,i,r){this.X=this._left=n;this.Y=this._top=t;this._right=n+i;this._bottom=t+r;this.Width=i;this.Height=r}return Object.defineProperty(n.prototype,"Left",{get:function(){return this.X},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Top",{get:function(){return this.Y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Bottom",{get:function(){return this._bottom},enumerable:!0,configurable:!0}),n}();t.Rect=a;fi=function(){function n(n,t,i,r){this.left=n;this.top=t;this.right=i;this.bottom=r}return Object.defineProperty(n.prototype,"Left",{get:function(){return this.left},set:function(n){this.left=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Top",{get:function(){return this.top},set:function(n){this.top=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Right",{get:function(){return this.right},set:function(n){this.right=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Bottom",{get:function(){return this.bottom},set:function(n){this.bottom=n},enumerable:!0,configurable:!0}),n}();t.Margin=fi;k=function(){function n(n,t){this.x=0;this.y=0;this.x=n;this.y=t}return Object.defineProperty(n.prototype,"X",{get:function(){return this.x},set:function(n){this.x=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Y",{get:function(){return this.y},set:function(n){this.y=n},enumerable:!0,configurable:!0}),n}();t.Point=k;ei=function(){function n(n){this.currentParagraph=null;this.offset=0;this.location=new k(0,0);this.ownerControl=n}return Object.defineProperty(n.prototype,"OwnerControl",{get:function(){return this.ownerControl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Document",{get:function(){return this.OwnerControl.Document},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Paragraph",{get:function(){return this.currentParagraph},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Offset",{get:function(){return this.offset},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Location",{get:function(){return this.location},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsAtParagraphStart",{get:function(){return this.offset==this.Paragraph.GetStartOffset()},enumerable:!0,configurable:!0}),n.prototype.SetPosition=function(n,t){this.currentParagraph=n;this.offset=t?n.GetStartOffset():n.GetLength()+1;this.UpdatePhysicalPosition()},n.prototype.SetPositionInternal=function(n){this.currentParagraph=n.currentParagraph;this.offset=n.offset;this.location=n.location},n.prototype.SetPositionForCurrentIndex=function(n){var t={Index:n},i=this.OwnerControl.Document.GetParagraph(t);this.offset=parseFloat(t.Index);this.SetPositionParagraph(i,this.offset)},n.prototype.SetPositionParagraph=function(n,t){this.currentParagraph=n;this.offset=t;this.UpdatePhysicalPosition()},n.prototype.UpdatePhysicalPosition=function(){this.currentParagraph.ParagraphWidgets.Count>0&&(this.location=this.currentParagraph.GetPhysicalPosition(this.offset))},n.prototype.UpdatePhysicalPositionInternal=function(n){this.currentParagraph.ParagraphWidgets.Count>0&&(this.location=this.currentParagraph.GetPhysicalPositionInternal(this.offset,n))},n.prototype.SetPositionForSelection=function(n,t,i,r){var f=!1;t==null?this.currentParagraph=n:(this.currentParagraph=t.OwnerParagraph,t.NextNode instanceof u&&i>t.Length&&(f=t.IsLastRenderedInline(t.Length)));this.location=r;this.offset=f?this.currentParagraph.GetLength()+1:this.currentParagraph.GetOffset(t,i)},n.prototype.ValidateBackwardFieldSelection=function(t,i){var u=new n(this.OwnerControl),o,e,c,l,v,y;for(u.SetPositionForCurrentIndex(t),o=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal();t!=i&&n.IsForwardSelection(i,t);){var s=0,a=u.Paragraph.GetInline(u.Offset,s),r=a.inline;if(s=a.index,r!=null&&(e=r.GetNextRenderedInline(s),e instanceof f&&(c=e.fieldEnd.OwnerParagraph.GetOffset(e.fieldEnd,1),l=e.fieldEnd.OwnerParagraph.GetHierarchicalIndex(c.toString()),n.IsForwardSelection(l,o)||(this.OwnerControl.Selection.Start.SetPositionParagraph(e.fieldEnd.OwnerParagraph,c),o=l))),r instanceof h&&r.FieldBegin!=null){if(v=r.FieldBegin.OwnerParagraph.GetOffset(r.FieldBegin,0),y=r.FieldBegin.OwnerParagraph.GetHierarchicalIndex(v.toString()),!n.IsForwardSelection(i,y)){this.MoveToInline(r.FieldBegin,0);return}u.MoveToInline(r.FieldBegin,0)}else u.MovePreviousPosition();t=u.GetHierarchicalIndexInternal()}},n.prototype.ValidateForwardFieldSelection=function(t,i){var u=new n(this.OwnerControl),o,c,a,s,v,y,p;for(u.SetPositionForCurrentIndex(t),o=!1;t!=i&&n.IsForwardSelection(t,i);){if(!o&&(u.MoveNextPosition(),c=u.GetHierarchicalIndexInternal(),t==c))break;var e=0,l=u.Paragraph.GetInline(u.Offset,e),r=l.inline;if(e=l.index,r!=null){if(a=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),e==r.Length&&r instanceof h){if(r.OwnerParagraph.GetOffset(r,0)==this.offset)return;s=r.FieldBegin.OwnerParagraph.GetOffset(r.FieldBegin,0);v=r.FieldBegin.OwnerParagraph.GetHierarchicalIndex(s.toString());n.IsForwardSelection(a,v)||this.OwnerControl.Selection.Start.SetPositionParagraph(r.FieldBegin.OwnerParagraph,s)}r=r.GetNextRenderedInline(e)}if(o=r instanceof f&&r.fieldEnd!=null){if(r.OwnerParagraph.GetOffset(r,0)==this.offset)return;if(y=r.fieldEnd.OwnerParagraph.GetOffset(r.fieldEnd,1),p=r.fieldEnd.OwnerParagraph.GetHierarchicalIndex(y.toString()),!n.IsForwardSelection(p,i)){this.MoveToInline(r.fieldEnd,1);return}u.MoveToInline(r.fieldEnd,1)}t=u.GetHierarchicalIndexInternal()}},n.prototype.MoveToInline=function(n,t){this.currentParagraph=n.OwnerParagraph;this.offset=this.currentParagraph.GetOffset(n,t);this.UpdatePhysicalPosition()},n.prototype.MovePreviousPosition=function(){var t=0,i=this.currentParagraph.GetInline(this.offset,t),n=i.inline,e,r,o;t=i.index;n instanceof h&&n.FieldBegin!=null&&this.MovePreviousPositionInternal(n);e=this.currentParagraph.GetPreviousValidOffset(this.offset);this.offset>e?this.offset=e:(r=this.currentParagraph.GetPreviousParagraph(),r!=null&&(this.currentParagraph=r,this.offset=r.GetEndOffset()));t=0;i=this.currentParagraph.GetInline(this.offset,t);n=i.inline;t=i.index;n instanceof u&&(o=n.GetPreviousValidInline(),o!=null&&(n=o,this.currentParagraph=n.OwnerParagraph,this.offset=this.currentParagraph.GetOffset(n,n.Length),n instanceof f&&this.offset--));this.UpdatePhysicalPosition()},n.prototype.MoveNextPosition=function(){var n=this.currentParagraph.GetNextStartInline(this.offset),r,t,e,o,i;if(n instanceof f&&n.fieldEnd!=null){this.MoveNextPositionInternal(n);this.MoveNextPosition();return}r=this.currentParagraph.GetNextValidOffset(this.offset);t=0;r>this.offset?(this.offset=r,i=this.currentParagraph.GetInline(this.offset,t),n=i.inline,t=i.index,n!=null&&t==n.Length&&n.NextNode instanceof u&&(e=n.NextNode.GetNextValidInline(),e instanceof h&&(n=e,this.offset=this.currentParagraph.GetOffset(n,1)))):(o=this.currentParagraph.GetNextParagraph(),o!=null&&(this.currentParagraph=o,this.offset=this.currentParagraph.GetStartOffset()),i=this.currentParagraph.GetInline(this.offset,t),n=i.inline,t=i.index,n instanceof h&&this.offset++);this.UpdatePhysicalPosition()},n.prototype.MoveNextPositionInternal=function(n){var t;n.fieldSeparator==null?t=n.fieldEnd:(t=n.fieldSeparator,this.currentParagraph=t.OwnerParagraph,this.currentParagraph!=n.fieldEnd.OwnerParagraph||this.currentParagraph.HasValidInline(t,n.fieldEnd)||(t=n.fieldEnd));this.currentParagraph=t.OwnerParagraph;this.offset=this.currentParagraph.GetOffset(t,1)},n.prototype.MovePreviousPositionInternal=function(n){var t;t=n.FieldSeparator==null?n.FieldBegin.GetPreviousValidInline():n.GetPreviousValidInline();this.currentParagraph=t.OwnerParagraph;this.offset=this.currentParagraph.GetOffset(t,t instanceof u?0:t.Length)},n.prototype.UpdateTextPositionOnFieldCharacter=function(t){var r=new n(this.OwnerControl),l,v,s,y,p,w;r.SetPositionInternal(t);for(var u=t.GetHierarchicalIndexInternal(),o=this.GetHierarchicalIndexInternal(),c=!1;u!=o&&n.IsForwardSelection(u,o);){if(!c&&(r.MoveNextPosition(),l=r.GetHierarchicalIndexInternal(),u==l))break;var e=0,a=r.Paragraph.GetInline(r.Offset,e),i=a.inline;if(e=a.index,i!=null){if(v=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),e==i.Length&&i instanceof h){if(i.OwnerParagraph.GetOffset(i,0)==this.offset)return;s=i.FieldBegin.OwnerParagraph.GetOffset(i.FieldBegin,0);y=i.FieldBegin.OwnerParagraph.GetHierarchicalIndex(s.toString());n.IsForwardSelection(v,y)||t.SetPositionParagraph(i.FieldBegin.OwnerParagraph,s)}i=i.GetNextRenderedInline(e)}if(c=i instanceof f&&i.fieldEnd!=null){if(i.OwnerParagraph.GetOffset(i,0)==this.offset)return;if(p=i.fieldEnd.OwnerParagraph.GetOffset(i.fieldEnd,1),w=i.fieldEnd.OwnerParagraph.GetHierarchicalIndex(p.toString()),!n.IsForwardSelection(w,o)){this.MoveToInline(i.fieldEnd,1);return}r.MoveToInline(i.fieldEnd,1)}u=r.GetHierarchicalIndexInternal()}},n.prototype.MoveForward=function(){var i=0,y=this.currentParagraph.GetInline(this.offset,i),t=y.inline,b,e,c,l,a,r,o,k,v;if(i=y.index,t!=null){if(!this.OwnerControl.Selection.IsEmpty&&i==t.Length&&t instanceof h){var d=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),p=t.FieldBegin.OwnerParagraph.GetOffset(t.FieldBegin,0),g=t.FieldBegin.OwnerParagraph.GetHierarchicalIndex(p.toString());if(!n.IsForwardSelection(d,g)){this.OwnerControl.Selection.Start.SetPositionParagraph(t.FieldBegin.OwnerParagraph,p);return}}t=t.GetNextRenderedInline(i)}if(t instanceof f&&t.fieldEnd!=null){var nt=this.OwnerControl.Selection.Start.Paragraph,s=0,w=nt.GetInline(this.OwnerControl.Selection.Start.Offset,s),tt=w.inline;if(s=w.index,b=tt.GetNextRenderedInline(s),b==t)this.MoveNextPositionInternal(t);else{t=t.fieldEnd;this.currentParagraph=t.OwnerParagraph;this.offset=this.currentParagraph.GetOffset(t,1);this.UpdatePhysicalPosition();return}}else(t instanceof f||t instanceof h)&&(this.currentParagraph=t.OwnerParagraph,this.offset=this.currentParagraph.GetOffset(t,1));i=0;e=this.currentParagraph.GetNextValidOffset(this.offset);c=this.currentParagraph.GetLength()-1;this.offset<=e&&this.offset<c+1?this.offset==e?this.offset=c+1:(this.offset=e,l=this.currentParagraph.GetInline(this.offset,i),t=l.inline,i=l.index,t!=null&&i==t.Length&&t.NextNode instanceof u&&(a=t.NextNode.GetNextValidInline(),a instanceof h&&(t=a,this.offset=this.currentParagraph.GetOffset(t,1)))):(r=this.currentParagraph.GetNextSelection(this.OwnerControl.Selection),r!=null&&(o=!1,r.Owner instanceof ht&&(this.OwnerControl.Selection.Start.Paragraph.IsInsideTable?(k=this.OwnerControl.Selection.Start.Paragraph.AssociatedCell.GetContainerCellOf(r.AssociatedCell),o=!k.Contains(r.AssociatedCell)):o=!0),this.currentParagraph=r,this.offset=o?this.currentParagraph.GetLength()+1:1),v=this.currentParagraph.GetInline(this.offset,i),t=v.inline,i=v.index,t instanceof h&&this.offset++);this.UpdatePhysicalPosition()},n.prototype.MoveBackward=function(){var i=0,o=this.currentParagraph.GetInline(this.offset,i),t=o.inline,r,p,l,e,s,w,a;if(i=o.index,!this.OwnerControl.Selection.IsEmpty&&t!=null&&(r=t.GetNextRenderedInline(i),r instanceof f)){var v=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),c=r.fieldEnd.OwnerParagraph.GetOffset(r.fieldEnd,1),y=r.fieldEnd.OwnerParagraph.GetHierarchicalIndex(c.toString());if(!n.IsForwardSelection(y,v)){this.OwnerControl.Selection.Start.SetPositionParagraph(r.fieldEnd.OwnerParagraph,c);return}}if(t instanceof h&&t.FieldBegin!=null){var v=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),c=t.OwnerParagraph.GetOffset(t,1),y=t.OwnerParagraph.GetHierarchicalIndex(c.toString());if(!n.IsForwardSelection(v,y)){p=t.FieldBegin.OwnerParagraph.GetOffset(t.FieldBegin,0);this.currentParagraph=t.FieldBegin.OwnerParagraph;this.offset=p;this.UpdatePhysicalPosition();return}this.MovePreviousPositionInternal(t)}l=this.currentParagraph.GetPreviousValidOffset(this.offset);this.offset>l?this.offset=l:(e=this.currentParagraph.GetPreviousSelection(this.OwnerControl.Selection),e!=null&&(s=!1,e.Owner instanceof ht&&(this.OwnerControl.Selection.Start.Paragraph.IsInsideTable?(w=this.OwnerControl.Selection.Start.Paragraph.AssociatedCell.GetContainerCellOf(e.AssociatedCell),s=!w.Contains(e.AssociatedCell)):s=!0),this.currentParagraph=e,this.offset=s?this.currentParagraph.GetStartOffset():this.currentParagraph.GetEndOffset()));i=0;o=this.currentParagraph.GetInline(this.offset,i);t=o.inline;i=o.index;t instanceof u&&(a=t.GetPreviousValidInline(),a!=null&&(t=a,this.currentParagraph=t.OwnerParagraph,this.offset=this.currentParagraph.GetOffset(t,t instanceof f?0:t.Length)));this.UpdatePhysicalPosition()},n.prototype.MoveToWordEnd=function(n,t){var i=this.currentParagraph.GetEndOffset(),r,f,e;if(this.offset==i||this.offset==i+1)if(this.offset==i&&n!=0)this.SetPositionParagraph(this.currentParagraph,i+1);else{if(r=this.currentParagraph.GetNextParagraph(),r==null)return;this.currentParagraph=r;this.offset=this.currentParagraph.GetStartOffset();n==1&&((this.OwnerControl.Selection.Start.Paragraph.IsInsideTable||this.Paragraph.IsInsideTable)&&(this.OwnerControl.Selection.Start.Paragraph.AssociatedCell!=this.Paragraph.AssociatedCell||this.OwnerControl.Selection.Start.Paragraph.AssociatedCell.IsCellSelected(this.OwnerControl.Selection.Start,this))?this.MoveToNextParagraphInTable():this.MoveToWordEnd(n,t))}else{var u=0,o=this.currentParagraph.GetInline(this.Offset,u),s=o.inline;u=o.index;s.GetNextWordOffset(u,n,!1,{endSelection:!1}.endSelection,this,t)}n!=0&&(f=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),e=this.GetHierarchicalIndexInternal(),f!=e&&this.ValidateForwardFieldSelection(f,e));this.UpdatePhysicalPosition()},n.prototype.MoveToWordStart=function(n){var t=this.currentParagraph.GetEndOffset(),i,u,f;if(n!=2||this.offset!=t&&this.offset!=t+1){if(this.offset==t+1)this.offset=t;else if(this.offset==this.currentParagraph.GetStartOffset()){if(i=this.currentParagraph.GetPreviousParagraph(),i==null)return;this.currentParagraph=i;this.offset=this.currentParagraph.GetEndOffset()}else{var r=0,e=this.currentParagraph.GetInline(this.offset,r),o=e.inline;r=e.index;o.GetPreviousWordOffset(r,n,o instanceof h,!1,!1,this)}n==1&&(u=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal(),f=this.GetHierarchicalIndexInternal(),u!=f&&this.ValidateBackwardFieldSelection(u,f));this.UpdatePhysicalPosition()}},n.prototype.MoveToLineStart=function(n){var h=this.currentParagraph.GetLineWidgetInternal(this.offset,n),i=h.GetFirstElementInternal(),s=this.currentParagraph.GetStartOffset(),r,e,t,o;i==null&&this.offset>s?this.offset=s:i!=null&&(r=i.GetIndexInInline(),this.currentParagraph=i.Inline.OwnerParagraph,this.offset=this.currentParagraph.GetOffset(i.Inline,r),r=0,e=this.currentParagraph.GetInline(this.offset,r),t=e.inline,r=e.index,t instanceof u&&(o=t.GetPreviousValidInline(),o!=null&&(t=o,this.currentParagraph=t.OwnerParagraph,this.offset=this.currentParagraph.GetOffset(t,t.Length),t instanceof f&&this.offset--)));this.UpdatePhysicalPosition()},n.prototype.MoveToLineEnd=function(n){var o=this.currentParagraph.GetLineWidget(this.offset),h=o.GetFirstElementInternal(),r,i,t,s,e;if(h==null&&this.offset==this.Paragraph.GetStartOffset())this.offset=this.Paragraph.GetLength()+1,this.UpdatePhysicalPosition();else if(h!=null){if(r=o.Children[o.Children.Count-1],i=r.GetIndexInInline(),i+=r instanceof c?r.Length:1,this.currentParagraph=r.Inline.OwnerParagraph,i==r.Inline.Length&&r.Inline.NextNode==null)this.offset=this.currentParagraph.GetLength()+1;else{for(t=r.Inline;t!=null&&t.Length==i&&t.NextNode instanceof u;)s=t.NextNode.GetNextValidInline(),t!=s&&(t=s,i=0),t instanceof f&&t.fieldEnd!=null&&(e=t,e.fieldSeparator==null?t=e.fieldEnd:(t=e.fieldSeparator,this.currentParagraph=t.OwnerParagraph,this.currentParagraph!=e.fieldEnd.OwnerParagraph||this.currentParagraph.HasValidInline(t,e.fieldEnd)||(t=e.fieldEnd)),this.currentParagraph=t.OwnerParagraph),t instanceof u&&(i=1);i==t.Length&&t.NextNode==null&&i++;this.offset=this.currentParagraph.GetOffset(t,i)}this.UpdatePhysicalPositionInternal(n)}},n.prototype.MoveToNextLine=function(t){var r=new n(this.OwnerControl),e,a,f,s,h,c,l;r.SetPositionInternal(this);e=this.GetHierarchicalIndexInternal();a=this.currentParagraph.GetLineWidget(this.offset);this.MoveToLineEnd(!0);f=!r.IsAtSamePosition(this);r.SetPositionInternal(this);this.currentParagraph.IsInsideTable?this.MoveDownInTable():this.MoveForward();var i=this.currentParagraph.GetLineWidget(this.offset),u=i.GetLeft(),o=i.GetFirstElementInternal(),v=o==null?i.GetWidth(!0):i.GetLeftInternal(o,1)-u;u<t&&v/2<t-u?(s=i.GetTop(),h=new k(t,s),i.UpdateTextPositionWidget(this.OwnerControl,h,this,!0),c=i.GetWidth(!0),c<t-u&&this.MoveToLineEnd(!0)):f&&this.currentParagraph.IsInsideTable&&this.currentParagraph.Owner==this.OwnerControl.Selection.Start.currentParagraph.Owner?this.SetPositionInternal(r):f||this.MoveToLineEnd(!0);l=this.GetHierarchicalIndexInternal();this.ValidateForwardFieldSelection(e,l)},n.prototype.MoveDownInTable=function(){var u=!1,o=this.OwnerControl.Selection.IsEmpty||this.OwnerControl.Selection.IsForward,r,e,s,t;if(u=this.OwnerControl.Selection.Start.Paragraph.IsInsideTable){var f=this.OwnerControl.Selection.Start.Paragraph.AssociatedCell,n=this.currentParagraph.AssociatedCell,i=f.GetContainerCellOf(n);if(u=i.OwnerTable.Contains(n)){if(f=f.GetSelectedCell(i),n=n.GetSelectedCell(i),r=i.Contains(this.currentParagraph.AssociatedCell),e=i.IsCellSelected(this.OwnerControl.Selection.Start,this),(r&&e||!r)&&n.OwnerRow.NextNode!=null){s=n.OwnerRow.NextNode;t=s.GetLastCellInRegion(i,this.OwnerControl.Selection.UpDownSelectionLength,!1);this.SetPosition(t.GetLastParagraph(),!1);return}(r&&e&&n.OwnerRow.NextNode==null||!r)&&(o?(n=n.OwnerRow.Cells[n.OwnerRow.Cells.Count-1],this.SetPosition(n.GetLastParagraph(),!1)):(n=n.OwnerRow.Cells[0],this.SetPosition(n.GetFirstParagraph(),!0)))}}u||(t=this.currentParagraph.AssociatedCell.GetContainerCell(),o?(t=t.OwnerRow.Cells[t.OwnerRow.Cells.Count-1],this.SetPosition(t.GetLastParagraph(),!1)):(t=t.OwnerRow.Cells[0],this.SetPosition(t.GetFirstParagraph(),!0)));this.MoveForward()},n.prototype.MoveToPreviousLine=function(n){var f=this.GetHierarchicalIndexInternal(),e=this.currentParagraph.GetLineWidget(this.offset),i,r,u;this.MoveToLineStart(!0);this.currentParagraph.IsInsideTable?this.MoveUpInTable():this.MoveBackward();var t=this.currentParagraph.GetLineWidget(this.offset),o=t.GetLeft(),s=t.GetWidth(!0);s+o>=n&&e!=t&&(i=t.GetTop(),r=new k(n,i),t.UpdateTextPositionWidget(this.OwnerControl,r,this,!0));u=this.GetHierarchicalIndexInternal();this.ValidateBackwardFieldSelection(f,u)},n.prototype.MoveUpInTable=function(){var f=!1,e=this.OwnerControl.Selection.End,s=!this.OwnerControl.Selection.IsEmpty,r,u,h,t;if(f=e.Paragraph.IsInsideTable){var n=this.currentParagraph.AssociatedCell,o=e.Paragraph.AssociatedCell,i=o.GetContainerCellOf(n);if(f=i.OwnerTable.Contains(n)){if(o=o.GetSelectedCell(i),n=n.GetSelectedCell(i),r=i.Contains(this.currentParagraph.AssociatedCell),u=i.IsCellSelected(this,e),u||(u=this.currentParagraph==i.GetFirstParagraph()&&this.IsAtParagraphStart),(r&&u||!r)&&n.OwnerRow.PreviousNode!=null){h=n.OwnerRow.PreviousNode;t=h.GetFirstCellInRegion(i,this.OwnerControl.Selection.UpDownSelectionLength,!0);this.SetPosition(t.GetFirstParagraph(),!0);return}(r&&u&&n.OwnerRow.PreviousNode==null||!r)&&(s?(n=n.OwnerRow.Cells[0],this.SetPosition(n.GetFirstParagraph(),!0)):(n=n.OwnerRow.Cells[n.OwnerRow.Cells.Count-1],this.SetPosition(n.GetLastParagraph(),!1)))}}f||(t=this.currentParagraph.AssociatedCell.GetContainerCell(),s?(t=t.OwnerRow.Cells[0],this.SetPosition(t.GetFirstParagraph(),!0)):(t=t.OwnerRow.Cells[t.OwnerRow.Cells.Count-1],this.SetPosition(t.GetLastParagraph(),!1)));this.MoveBackward()},n.prototype.MoveToParagraphStart=function(n){var r=this.currentParagraph.GetStartOffset(),t,i;this.offset==r&&n?(this.OwnerControl.Selection.Start.Paragraph.IsInsideTable||this.Paragraph.IsInsideTable)&&(this.OwnerControl.Selection.Start.Paragraph.AssociatedCell!=this.Paragraph.AssociatedCell||this.OwnerControl.Selection.Start.Paragraph.AssociatedCell.IsCellSelected(this.OwnerControl.Selection.Start,this))?this.MoveToPreviousParagraphInTable():this.currentParagraph.GetPreviousParagraph()!=null&&(this.currentParagraph=this.currentParagraph.GetPreviousParagraph(),this.offset=this.currentParagraph.GetStartOffset()):this.offset=this.currentParagraph.GetStartOffset();t=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal();i=this.GetHierarchicalIndexInternal();t!=i&&this.ValidateBackwardFieldSelection(t,i);this.UpdatePhysicalPosition()},n.prototype.MoveToParagraphEnd=function(n){var u=this.OwnerControl.Selection.Start.Paragraph,r=this.currentParagraph.GetEndOffset()+1,t,i;this.offset==r&&n?(this.OwnerControl.Selection.Start.Paragraph.IsInsideTable||this.Paragraph.IsInsideTable)&&(this.OwnerControl.Selection.Start.Paragraph.AssociatedCell!=this.Paragraph.AssociatedCell||this.OwnerControl.Selection.Start.Paragraph.AssociatedCell.IsCellSelected(this.OwnerControl.Selection.Start,this))?this.MoveToNextParagraphInTable():this.currentParagraph.GetNextParagraph()!=null&&(this.currentParagraph=this.currentParagraph.GetNextParagraph(),this.offset=this.currentParagraph.GetEndOffset()+1):this.offset=this.currentParagraph.GetEndOffset()+1;t=this.OwnerControl.Selection.Start.GetHierarchicalIndexInternal();i=this.GetHierarchicalIndexInternal();t!=i&&this.ValidateForwardFieldSelection(t,i);this.UpdatePhysicalPosition()},n.prototype.MoveToPreviousParagraphInTable=function(){var n;(n=this.currentParagraph.IsInsideTable?this.currentParagraph.AssociatedCell.GetPreviousSelection(this.OwnerControl.Selection):this.currentParagraph.GetPreviousParagraph(),n!=null)&&(this.currentParagraph=n,this.offset=this.currentParagraph.GetStartOffset())},n.prototype.MoveToNextParagraphInTable=function(){var n;(n=this.currentParagraph.IsInsideTable?this.currentParagraph.AssociatedCell.GetNextSelection(this.OwnerControl.Selection):this.currentParagraph.GetNextParagraph(),n!=null)&&(this.currentParagraph=n,this.offset=this.currentParagraph.GetEndOffset()+1)},n.prototype.MoveToPreviousParagraph=function(){var n=this.currentParagraph.GetStartOffset();this.offset==n&&this.currentParagraph.GetPreviousParagraph()!=null?(this.currentParagraph=this.currentParagraph.GetPreviousParagraph(),this.offset=this.currentParagraph.GetStartOffset()):this.offset=this.currentParagraph.GetStartOffset();this.UpdatePhysicalPosition()},n.prototype.MoveToNextParagraph=function(){this.currentParagraph.GetNextParagraph()!=null&&(this.currentParagraph=this.currentParagraph.GetNextParagraph(),this.offset=this.currentParagraph.GetStartOffset(),this.UpdatePhysicalPosition())},n.prototype.IsInSameDocument=function(n){if(n==null)throw new RangeError("The textPosition cannot be null.");return this.Document==n.Document},n.prototype.IsAtSamePosition=function(n){return this.currentParagraph==n.currentParagraph&&this.offset==n.offset},n.prototype.IsExistBefore=function(n){if(n==null)throw new Error("textPosition is null.");if(!this.IsInSameDocument(n))throw new Error("textPosition is not in the same document.");return this.currentParagraph==n.currentParagraph?this.offset<n.offset:this.currentParagraph.Owner==n.currentParagraph.Owner?this.currentParagraph.IsInsideTable?this.currentParagraph.AssociatedCell.Blocks.IndexOf(this.currentParagraph)<n.currentParagraph.AssociatedCell.Blocks.IndexOf(n.currentParagraph):this.currentParagraph.Owner instanceof s?this.currentParagraph.Owner.Blocks.indexOf(this.currentParagraph)<n.currentParagraph.Owner.Blocks.indexOf(n.currentParagraph):this.currentParagraph.Section.Blocks.indexOf(this.currentParagraph)<n.currentParagraph.Section.Blocks.indexOf(n.currentParagraph):this.currentParagraph.IsExistBefore(n.currentParagraph)},n.prototype.IsExistAfter=function(n){if(n==null)throw new Error("textPosition is null.");if(!this.IsInSameDocument(n))throw new Error("textPosition is not in the same document.");return this.currentParagraph==n.currentParagraph?this.offset>n.offset:this.currentParagraph.Owner==n.currentParagraph.Owner?this.currentParagraph.IsInsideTable?this.currentParagraph.AssociatedCell.Blocks.IndexOf(this.currentParagraph)>n.currentParagraph.AssociatedCell.Blocks.IndexOf(n.currentParagraph):this.currentParagraph.Owner instanceof s?this.currentParagraph.Owner.Blocks.IndexOf(this.currentParagraph)>n.currentParagraph.Owner.Blocks.IndexOf(n.currentParagraph):this.currentParagraph.Section.Blocks.IndexOf(this.currentParagraph)>n.currentParagraph.Section.Blocks.IndexOf(n.currentParagraph):this.currentParagraph.IsExistAfter(n.currentParagraph)},n.prototype.Clone=function(){var t=new n(this.OwnerControl);return t.currentParagraph=this.currentParagraph,t.offset=this.offset,t.location=this.location,t},n.prototype.GetHierarchicalIndexInternal=function(){return this.Paragraph.GetHierarchicalIndex(this.Offset.toString())},n.prototype.Dispose=function(){this.currentParagraph=null;this.location=null},n.IsForwardSelection=function(n,t){var i,f,e;if(n==t)return!0;n=n.replace(/C;/g,"");t=t.replace(/C;/g,"");var o=n.split(";"),r=t.split(";"),u=o.length;for(u>r.length&&(u=r.length-1),i=0;i<u;i++)if(f=parseFloat(o[i]),e=parseFloat(r[i]),f!=e)return f<e;return!1},n}();t.TextPosition=ei;lu=function(){function n(n){this.SelectedWidgets=null;this.ownerControl=n;this.SelectedWidgets=new kt}return Object.defineProperty(n.prototype,"Start",{get:function(){return this.start==null&&this.ownerControl!=null&&this.ownerControl.Document!=null&&(this.start=this.ownerControl.Document.DocumentStart),this.start},set:function(n){this.start=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"End",{get:function(){return this.end==null&&this.Start!=null&&(this.end=this.Start.Clone()),this.end},set:function(n){this.end=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsEmpty",{get:function(){return this.Start==null?!0:this.Start.IsAtSamePosition(this.End)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsForward",{get:function(){return this.Start.IsExistBefore(this.End)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OwnerControl",{get:function(){return this.ownerControl},enumerable:!0,configurable:!0}),n.prototype.ClearSelectionHighlight=function(){for(var t=this.SelectedWidgets.Keys,n=0;n<t.Count;n++)this.RemoveSelectionHighlight(t[n]);this.SelectedWidgets.Clear()},n.prototype.ClearSelectionHighlightInternal=function(n){this.RemoveSelectionHighlight(n);this.SelectedWidgets.Remove(n)},n.prototype.RemoveSelectionHighlight=function(n){var u=0,f=0,e=0,o=0,t=null,r,h,i,s,c;if(n instanceof ki){if(r=n,t=r.CurrentParagraphWidget.GetPage(),t==null)return;i=this.SelectedWidgets.Get(n);e=i.Width;u=i.Left;f=r.GetTop();o=r.Height}if(n instanceof gt){if(h=n,t=h.GetPage(),t==null)return;i=this.SelectedWidgets.Get(n);e=i.Width;u=i.Left;f=n.Y;o=n.Height}t!=null&&(s=document.getElementById(t.Id+"_selection"),s!=null)&&(c=s.getContext("2d"),c.clearRect(u,f,e,o))},n.prototype.AddSelectionHighlight=function(n,t,i){if(this.SelectedWidgets.ContainsKey(t)){var u=t.Height,r=this.SelectedWidgets.Get(t),f=r.Width,e=r.Left;n.fillStyle="gray";n.globalAlpha=.4;n.fillRect(e,i,f,u)}},n.prototype.AddSelectionHighlightTable=function(n,t){if(this.SelectedWidgets.ContainsKey(t)){var i=this.SelectedWidgets.Get(t),r=i.Left,u=t.Y,f=i.Width,e=t.Height;n.fillStyle="gray";n.globalAlpha=.4;n.fillRect(r,u,f,e)}},n.prototype.GetSelectedContentAsHTML=function(){return this.IsForward?this.Start.Paragraph.GetSelectedContent(this.OwnerControl.Selection,this.Start,this.End):this.End.Paragraph.GetSelectedContent(this.OwnerControl.Selection,this.End,this.Start)},n.prototype.Dispose=function(){this.start!=null&&(this.start.Dispose(),this.start=null);this.end!=null&&(this.end.Dispose(),this.end=null);this.ClearSelectionHighlight();this.ownerControl=null},n}();t.SelectionRange=lu;dr=function(){function n(n){this.ranges=new e;this.ownerControl=n}return Object.defineProperty(n.prototype,"Count",{get:function(){return this.ranges!=null?this.ranges.length:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OwnerControl",{get:function(){return this.ownerControl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"First",{get:function(){return this.ranges!=null&&this.ranges.Count>0?this.ranges[0]:null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Last",{get:function(){return this.ranges!=null&&this.ranges.Count>0?this.ranges[this.ranges.length-1]:null},enumerable:!0,configurable:!0}),n.prototype.Get=function(n){return n>-1&&n<this.ranges.length?this.ranges[n]:null},n.prototype.Clear=function(){this.ranges!=null&&this.ranges.Count>0&&(this.ownerControl.Viewer.ClearSelectionHighlight(),this.ranges.Clear())},n.prototype.Contains=function(n){if(n==null)throw new ReferenceError("SelectionRange cannot be null.");return this.ranges==null?!1:this.ranges.Contains(n)},n.prototype.Remove=function(n){if(n==null)throw new ReferenceError("SelectionRange cannot be null.");return this.ranges!=null&&this.ranges.Contains(n)?(n.ClearSelectionHighlight(),this.ranges.Remove(n),!0):!1},n.prototype.AddSelection=function(n,t){this.ranges==null&&(this.ranges=new e);var i=new lu(this.ownerControl);i.Start.SetPositionInternal(n);i.End.SetPositionInternal(t);i.IsEmpty||(i.IsForward?i.End.UpdateTextPositionOnFieldCharacter(i.Start):i.Start.UpdateTextPositionOnFieldCharacter(i.End),this.CheckSelectionRangesIsExist(i.Start,i.End));this.ranges.Add(i)},n.prototype.CheckSelectionRangesIsExist=function(n,t){var r=n,u=t,f;if(!r.IsAtSamePosition(u))for(n.IsExistBefore(t)||(r=t,u=n),f=0;f<this.ranges.Count-1;f++){var i=this.ranges[f],e=i.Start,o=i.End;i.Start.IsExistBefore(i.End)||(e=i.End,o=i.Start);(r.IsAtSamePosition(e)||u.IsAtSamePosition(o)||r.IsExistBefore(e)&&u.IsExistAfter(e)||r.IsExistBefore(o)&&u.IsExistAfter(o)||r.IsExistAfter(e)&&u.IsExistBefore(o))&&(this.Remove(i),f--)}},n.prototype.UpdateSelectionRange=function(){var i=this.Last,r=i.Start,u=i.End,o,n;for(i.Start.IsExistBefore(i.End)||(r=i.End,u=i.Start),o=!r.IsAtSamePosition(u),n=0;n<this.ranges.Count-1;n++){var t=this.ranges[n],f=t.Start,e=t.End;f.IsAtSamePosition(e)?(this.ranges.RemoveAt(n),n--):o&&(t.Start.IsExistBefore(t.End)||(f=t.End,e=t.Start),(r.IsAtSamePosition(f)||u.IsAtSamePosition(e)||r.IsExistBefore(f)&&u.IsExistAfter(f)||r.IsExistBefore(e)&&u.IsExistAfter(e)||r.IsExistAfter(f)&&u.IsExistBefore(e))&&(this.Remove(t),n--))}o||this.ranges.RemoveAt(this.ranges.Count-1)},n.prototype.ClearSelection=function(){if(this.ranges!=null&&this.ranges.Count>0){this.ownerControl.Viewer.ClearSelectionHighlight();for(var n=0;n<this.ranges.Count-1;n++)this.ranges[n].Dispose(),this.ranges.RemoveAt(n),n--}},n.prototype.ClearMultiSelection=function(){if(this.ranges!=null&&this.ranges.length>1){this.ownerControl.Viewer.ClearSelectionHighlight();for(var n=0;n<this.ranges.Count-1;n++)this.ranges[n].Dispose(),this.ranges.RemoveAt(n),n--}},n.prototype.Dispose=function(){if(this.ranges!=null&&this.ranges.Count>0){for(var n=0;n<this.ranges.Count-1;n++)this.ranges[n].Dispose(),n--;this.ranges.Clear();this.ranges=null}this.ownerControl=null},n.prototype.RemoveSelectionHighlight=function(n){if(this.ranges!=null)for(var t=0;t<this.ranges.Count;t++)this.ranges[t].SelectedWidgets.ContainsKey(n)&&this.ranges[t].RemoveSelectionHighlight(n)},n.prototype.ClearSelectionHighlightInternal=function(n){if(this.ranges!=null)for(var t=0;t<this.ranges.Count;t++)this.ranges[t].SelectedWidgets.ContainsKey(n)&&this.ranges[t].ClearSelectionHighlightInternal(n)},n.prototype.ClearSelectionHighlight=function(){if(this.ranges!=null)for(var n=0;n<this.ranges.Count;n++)this.ranges[n].ClearSelectionHighlight()},n.prototype.AddSelectionHighlight=function(n,t,i){if(this.ranges!=null)for(var r=0;r<this.ranges.Count;r++)this.ranges[r].AddSelectionHighlight(n,t,i)},n.prototype.AddSelectionHighlightTable=function(n,t){if(this.ranges!=null)for(var i=0;i<this.ranges.Count;i++)this.ranges[i].AddSelectionHighlightTable(n,t)},n}();t.SelectionRangeCollection=dr;gr=function(){function n(n){this.ownerControl=null;this.UpDownSelectionLength=0;this.ownerControl=n;this.selectionRanges=new dr(n)}return Object.defineProperty(n.prototype,"SelectionRanges",{get:function(){return this.selectionRanges},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"OwnerControl",{get:function(){return this.ownerControl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Text",{get:function(){return this.GetText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Start",{get:function(){if(this.OwnerControl!=null&&this.OwnerControl.Document!=null){if(this.SelectionRanges==null&&(this.SelectionRanges=new dr(this.OwnerControl)),this.OwnerControl.Selection.SelectionRanges.Count==0){var n=this.ownerControl.Document.DocumentStart;this.OwnerControl.Selection.SelectionRanges.AddSelection(n,n)}if(this.OwnerControl.Selection.SelectionRanges.Count>0)return this.OwnerControl.Selection.SelectionRanges.Get(this.OwnerControl.Selection.SelectionRanges.Count-1).Start}return null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"End",{get:function(){return this.OwnerControl.Selection.SelectionRanges!=null&&this.OwnerControl.Selection.SelectionRanges.Count>0?this.OwnerControl.Selection.SelectionRanges.Get(this.OwnerControl.Selection.SelectionRanges.Count-1).End:null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsEmpty",{get:function(){return this.Start==null?!0:this.Start.IsAtSamePosition(this.End)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsForward",{get:function(){return this.Start.IsExistBefore(this.End)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CurrentSelectionRange",{get:function(){return this.OwnerControl.IsDocumentLoaded&&this.OwnerControl.Selection.SelectionRanges!=null&&this.OwnerControl.Selection.SelectionRanges.Count>0?this.OwnerControl.Selection.SelectionRanges.Get(this.OwnerControl.Selection.SelectionRanges.Count-1):null},enumerable:!0,configurable:!0}),n.prototype.ExtendBackward=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveBackward(),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.ExtendForward=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveForward(),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.SelectCurrentWord=function(n){var t=this.Start.Clone(),i=this.End.Clone();this.SelectCurrentWordRange(t,i,!1);this.SelectRange(t,i,n)},n.prototype.SelectCurrentWordRange=function(n,t,i){if(n!=null){if(n.Offset>0){var r=n.Clone(),f=0,e=n.Paragraph.GetInline(n.Offset,f),u=e.inline;f=e.index;u!=null&&u instanceof h?n.Offset>2&&(u.FieldSeparator!=null||u.FieldBegin==null)?(r.SetPositionParagraph(r.Paragraph,n.Offset-2),r.MoveToWordEnd(0,!1),r.Paragraph==n.Paragraph&&r.Offset==n.Offset-1||n.MoveToWordStart(2)):n.Offset>3&&u.FieldSeparator==null&&(r.SetPositionParagraph(r.Paragraph,n.Offset-3),r.MoveToWordEnd(0,!1),r.Paragraph==n.Paragraph&&r.Offset==n.Offset||n.MoveToWordStart(2)):(r.SetPositionParagraph(r.Paragraph,n.Offset-1),r.MoveToWordEnd(0,!1),r.Paragraph==n.Paragraph&&r.Offset==n.Offset||n.MoveToWordStart(2))}t.MoveToWordEnd(2,i)}},n.prototype.SelectCurrentParagraph=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.Start.MoveToParagraphStart(!1),this.End.MoveToParagraphEnd(!1),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.Select=function(n,t,i,r,u){u&&this.SelectionRanges.ClearMultiSelection();this.Start.SetPositionForSelection(n,t,i,r);this.End.SetPositionInternal(this.Start);this.UpDownSelectionLength=r.X;this.FireSelectionChanged(!0)},n.prototype.SelectRange=function(n,t,i){i&&this.SelectionRanges.ClearMultiSelection();this.Start.SetPositionInternal(n);this.End.SetPositionInternal(t);this.UpDownSelectionLength=this.End.Location.X;this.FireSelectionChanged(!0)},n.prototype.FireSelectionChanged=function(n){this.IsEmpty||(this.IsForward?(this.Start.UpdatePhysicalPositionInternal(!0),this.End.UpdatePhysicalPositionInternal(!1)):(this.Start.UpdatePhysicalPositionInternal(!1),this.End.UpdatePhysicalPositionInternal(!0)));this.ownerControl.Viewer.ClearSelectionHighlight();this.HighlightSelection(n);n&&this.OwnerControl.RaiseClientEvent(vi.SelectionChange,null)},n.prototype.HighlightSelection=function(n){var i,t;if(!this.IsEmpty)if(this.SelectionRanges.Count>0)for(i=0;i<this.SelectionRanges.Count;i++)t=this.SelectionRanges.Get(i),t.IsForward?t.Start.Paragraph.HighlightSelectedContent(this,t,t.Start,t.End):t.End.Paragraph.HighlightSelectedContent(this,t,t.End,t.Start);else this.IsForward?this.Start.Paragraph.HighlightSelectedContent(this,this.CurrentSelectionRange,this.Start,this.End):this.End.Paragraph.HighlightSelectedContent(this,this.CurrentSelectionRange,this.End,this.Start);n&&this.OwnerControl.Viewer.ScrollToPosition(this.Start,this.End)},n.prototype.CreateHighlightBorder=function(n,t,i,r,u){var o=t.CurrentParagraphWidget.GetPage(),s=t.Height,h=new nu(r,i),e,f;n.SelectedWidgets.Add(t,h);e=document.getElementById(o.Id+"_selection");e!=null&&(f=e.getContext("2d"),f.fillStyle="gray",f.globalAlpha=.4,f.fillRect(r,u,i,s))},n.prototype.CreateHighlightBorderInsideTable=function(n,t,i){var c=n.GetPage(),f=document.getElementById(c.Id+"_selection"),u=null,e=n.X-n.Margin.Left+n.LeftBorderWidth,o=n.Width+n.Margin.Left+n.Margin.Right-n.LeftBorderWidth-n.RightBorderWidth,s=n.Y,h=n.Height,r;i.SelectedWidgets.ContainsKey(n)?(u=i.SelectedWidgets.Get(n),f!=null&&(r=f.getContext("2d"),r.clearRect(u.Left,s,u.Width,h))):(u=new nu(e,o),i.SelectedWidgets.Add(n,u));f!=null&&(r=f.getContext("2d"),r.fillStyle="gray",r.globalAlpha=.4,r.fillRect(e,s,o,h))},n.prototype.MoveTextPosition=function(n,t,i){var s,c,l,a,e,o;if(this.Start!=null){if(t&&this.selectionRanges.ClearMultiSelection(),s=this.OwnerControl.Viewer.GetLineWidgetInternal(n,!0),s!=null&&s.UpdateTextPositionWidget(this.OwnerControl,n,i,!0),this.UpDownSelectionLength=i.Location.X,c=i.Paragraph.GetLength(),!this.IsEmpty&&!this.IsForward&&i.Offset>c){var f=0,v=i.Paragraph.GetInline(c,f),r=v.inline;f=v.index;l=i.Paragraph;a=0;r!=null&&(r=r.GetPreviousValidInline(),f=r instanceof u?0:r.Length,r instanceof h&&f++,a=r.OwnerParagraph.GetOffset(r,f),l=r.OwnerParagraph);i.SetPositionParagraph(l,a)}e=this.Start.GetHierarchicalIndexInternal();o=this.End.GetHierarchicalIndexInternal();e!=o&&(ei.IsForwardSelection(e,o)?i.ValidateForwardFieldSelection(e,o):i.ValidateBackwardFieldSelection(e,o));this.FireSelectionChanged(!0)}},n.prototype.ExtendToWordStart=function(n,t){this.Start!=null&&(t&&this.SelectionRanges.ClearMultiSelection(),(this.Start.Paragraph.IsInsideTable||this.End.Paragraph.IsInsideTable)&&(this.Start.Paragraph.AssociatedCell!=this.End.Paragraph.AssociatedCell||this.Start.Paragraph.AssociatedCell.IsCellSelected(this.Start,this.End))?this.End.MoveToPreviousParagraphInTable():this.End.MoveToWordStart(n?0:1),n&&this.Start.SetPositionInternal(this.End),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.ExtendToWordEnd=function(n,t){this.Start!=null&&(t&&this.SelectionRanges.ClearMultiSelection(),(this.Start.Paragraph.IsInsideTable||this.End.Paragraph.IsInsideTable)&&(this.Start.Paragraph.AssociatedCell!=this.End.Paragraph.AssociatedCell||this.Start.Paragraph.AssociatedCell.IsCellSelected(this.Start,this.End))?this.End.MoveToNextParagraphInTable():this.End.MoveToWordEnd(n?0:1,!1),n&&this.Start.SetPositionInternal(this.End),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.ExtendToLineStart=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveToLineStart(!0),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.ExtendToLineEnd=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveToLineEnd(!0),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.ExtendToParagraphStart=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveToParagraphStart(!0),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.ExtendToParagraphEnd=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveToParagraphEnd(!0),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.ExtendToPreviousLine=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveToPreviousLine(this.UpDownSelectionLength),this.FireSelectionChanged(!0))},n.prototype.ExtendToNextLine=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveToNextLine(this.UpDownSelectionLength),this.FireSelectionChanged(!0))},n.prototype.MoveToPreviousParagraph=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveToPreviousParagraph(),this.Start.SetPositionInternal(this.End),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.MoveToNextParagraph=function(n){this.Start!=null&&(n&&this.SelectionRanges.ClearMultiSelection(),this.End.MoveToNextParagraph(),this.Start.SetPositionInternal(this.End),this.UpDownSelectionLength=this.End.Location.X,this.FireSelectionChanged(!0))},n.prototype.Copy=function(){this.IsEmpty||this.CopySelectedContent(!1)},n.prototype.CopySelectedContent=function(){for(var t="",n=0;n<this.SelectionRanges.Count;n++)t+=this.SelectionRanges.Get(n).GetSelectedContentAsHTML();this.CopyToClipboard(t)},n.prototype.CopyToClipboard=function(n){var i=window.getSelection(),t,r,u;i.removeAllRanges();t=document.createElement("div");t.innerHTML=n;document.body.appendChild(t);r=document.createRange();r.selectNodeContents(t);i.addRange(r);u=!1;try{u=document.execCommand("copy")}catch(f){}finally{i.removeAllRanges();t.parentNode.removeChild(t)}return u},n.prototype.GetHyperlinkField=function(){var t,i;if(this.End==null)return null;t=0;i=this.End.Paragraph.GetInline(this.End.Offset,t);t=i.index;var r=i.inline,n=new e,u=null;return u=r==null?this.End.Paragraph.GetHyperlinkFields(this.End.Paragraph,n):r.OwnerParagraph.GetHyperlinkField(r,n),n.Clear(),n=null,u},n.prototype.GetText=function(n){var t,e,r,s,u;if(this.Start==null||this.End==null||this.Start.Paragraph==null||this.End.Paragraph==null)return null;if(t="",this.IsEmpty)return t;e=this.Start;r=this.End;this.IsForward||(e=this.End,r=this.Start);var f=0,o=0,h=e.Paragraph.GetInline(e.Offset,f),c=r.Paragraph.GetInline(r.Offset,f),i=h.inline;if(f=h.index,s=c.inline,o=c.index,i instanceof d&&n&&f==0?t=yt.OBJECT_CHARACTER:i instanceof p&&(t=i.Text==""||i.Text==null||i.Text.length<f?t:i.Text.substring(f)),e.Paragraph==r.Paragraph)i instanceof yt&&(i==s?t=t.length<o-f?t:t.substring(0,o-f):i.NextNode instanceof yt&&(t=t+i.NextNode.GetText(r.Paragraph,s,o,n)));else if(i instanceof yt&&i.NextNode instanceof yt)t=t+i.NextNode.GetText(r.Paragraph,null,0,n);else{for(u=e.Paragraph.GetNextParagraph(),t=t+"\r";u!=null&&u.IsEmpty();){if(t=t+"\r",u==r.Paragraph)return t;u=u.GetNextParagraph()}u==null||u.IsEmpty()||(t=t+u.Inlines[0].GetText(r.Paragraph,s,o,n))}return r.Offset==r.Paragraph.GetEndOffset()+1&&(t=t+"\r"),t},n}();t.SelectionAdv=gr;nu=function(){function n(n,t){this.left=0;this.width=0;this.left=n;this.width=t}return Object.defineProperty(n.prototype,"Left",{get:function(){return this.left},set:function(n){this.left=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Width",{get:function(){return this.width},set:function(n){this.width=n},enumerable:!0,configurable:!0}),n}();t.SelectionWidgetInfo=nu;au=function(){function n(n){var t,i,r,u;if(this.CurrentPage=null,this.tableLeft=[],this.Pages=new e,this.selectionStartPage=null,this.selectionEndPage=null,this.zoomFactor=1,this.touchStart=null,this.touchEnd=null,this.IsTouchInput=!1,this.IsFieldCode=!1,this.CurrentHeaderFooter=null,this.SplittedCellWidgets=null,this.isMousedown=!1,this.isSelectionChangedOnMouseMoved=!1,this.HorizontalScrollBar=null,this.VerticalScrollBar=null,this.preZoomFactor=0,this.preDifference=-1,this.PointerCount=0,this.Pointers=[],this.ScrollStartX=-1,this.ScrollStartY=-1,this.LineElements=new su,this.FieldStack=new e,n!=null){if(this.Pages=new e,this.SplittedCellWidgets=new e,this.OwnerControl=n,t=this,this.OwnerControl.DocumentEditorElement==null)return;this.ViewerContatiner=document.createElement("div");this.ViewerContatiner.style.touchAction="pan-x pan-y";this.OwnerControl.DocumentEditorElement.appendChild(this.ViewerContatiner);this.Container=document.createElement("div");this.Container.setAttribute("id",this.OwnerControl.ContainerId+"_viewerContainer");this.Container.style.overflow="hidden";this.Container.style.cssFloat="left";this.Container.style.position="relative";this.Container.style.pointerEvents="none";this.Container.style.backgroundColor="#EEEEEE";this.ViewerContatiner.appendChild(this.Container);this.ViewerContatiner.tabIndex=0;this.ViewerContatiner.style.outline="none";i=this.OwnerControl.ej.buildTag("div","",{display:"none",float:"right"},{id:this.OwnerControl.ContainerId+"_verticalScrollBar"});i.ejScrollBar({orientation:"vertical",minimum:0,width:18,height:0,infiniteScrolling:!1,scroll:$.proxy(this.VerticalScrollBar_ValueChanged,this)});this.VerticalScrollBar=i.data("ejScrollBar");this.ViewerContatiner.appendChild(i[0]);r=this.OwnerControl.ej.buildTag("div","",{display:"none"},{id:this.OwnerControl.ContainerId+"_horizontalScrollBar"});r.ejScrollBar({orientation:"horizontal",minimum:0,width:0,height:18,infiniteScrolling:!1,scroll:$.proxy(this.HorizontalScrollBar_ValueChanged,this)});this.HorizontalScrollBar=r.data("ejScrollBar");this.ViewerContatiner.appendChild(r[0]);this.UpdateViewerSize();this.InitContextMenu();u=0;window.addEventListener("resize",function(){u&&clearTimeout(u);u=setTimeout(function(){t.UpdateViewerSizeOnWindowResize()},100)});this.ViewerContatiner.addEventListener("mousedown",function(n){t.OnMouseDownInternal(n)});this.ViewerContatiner.addEventListener("mousemove",function(n){t.OnMouseMoveInternal(n)});this.ViewerContatiner.addEventListener("mouseup",function(n){t.OnMouseUpInternal(n)});this.ViewerContatiner.addEventListener("mousewheel",function(n){t.OnMouseWheelInternal(n)});navigator.userAgent.match("Firefox")&&this.ViewerContatiner.addEventListener("DOMMouseScroll",function(n){t.OnMouseWheelInternal(n)});this.ViewerContatiner.addEventListener("contextmenu",function(n){t.OnContextMenuInternal(n)});this.ViewerContatiner.addEventListener("keydown",function(n){t.OnkeyDownInternal(n)});window.addEventListener("mousedown",function(){t.HideContextMenu()});window.addEventListener("keyup",function(n){n.keyCode==27&&t.HideContextMenu()});t.InitTouchEvents()}}return Object.defineProperty(n.prototype,"VisibleBounds",{get:function(){return this.visibleBounds},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"CurrentRenderingPage",{get:function(){return this.Pages.length==0?null:this.Pages[this.Pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SelectionStartPage",{get:function(){return this.selectionStartPage},set:function(n){this.selectionStartPage=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SelectionEndPage",{get:function(){return this.selectionEndPage},set:function(n){this.selectionEndPage=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ZoomFactor",{get:function(){return this.zoomFactor},set:function(n){this.zoomFactor=n;this.OnZoomFactorChanged()},enumerable:!0,configurable:!0}),n.prototype.InitContextMenu=function(){var n,u,t,o,f,i,s,e,r,h;st.AddCssStyle("."+l.ContextMenuItem+":hover{ background-color: #86CBEA }");st.AddCssStyle("."+l.ContextMenuItem+"{display:block}");st.AddCssStyle("."+l.DisabledContextMenuItem+"{opacity:0.5;}");st.AddCssStyle("."+l.HiddenContextMenuItem+"{display:none;}");this.ContextMenu=document.createElement("nav");this.ContextMenu.id=this.OwnerControl.ContainerId+"_"+l.ContextMenu;this.ContextMenu.style.zIndex="10";this.ContextMenu.style.display="none";this.ContextMenu.style.position="absolute";this.ContextMenu.style.width="260px";this.ContextMenu.style.background="#FFFFFF";this.ContextMenu.style.border="1px solid #D3D3D3";this.ContextMenu.style.padding="4px 0px";this.ViewerContatiner.appendChild(this.ContextMenu);n=document.createElement("ul");n.id=this.OwnerControl.ContainerId+"_"+l.ContextMenuUlList;n.style.listStyle="none";n.style.margin="0px";n.style.padding="0px";this.ContextMenu.appendChild(n);u=document.createElement("li");u.style.display="block";n.appendChild(u);t=document.createElement("a");t.className=l.ContextMenuItem;t.id=l.ContextMenuCopy;this.SetStyleToContextMenuItem(t);u.appendChild(t);o=document.createElement("span");o.innerText="Copy";t.appendChild(o);f=document.createElement("li");f.style.display="block";n.appendChild(f);i=document.createElement("a");i.className=l.ContextMenuItem;i.id=l.ContextMenuOpenHyperlink;this.SetStyleToContextMenuItem(i);f.appendChild(i);s=document.createElement("span");s.innerText="Open link";i.appendChild(s);e=document.createElement("li");e.style.display="block";n.appendChild(e);r=document.createElement("a");r.className=l.ContextMenuItem;r.id=l.ContextMenuCopyHyperlink;this.SetStyleToContextMenuItem(r);e.appendChild(r);h=document.createElement("span");h.innerText="Copy link address";r.appendChild(h)},n.prototype.SetStyleToContextMenuItem=function(n){n.style.color="#333333";n.style.textDecoration="none";n.style.fontSize="12px";n.style.fontFamily="Segoe UI";n.style.cursor="default";n.style.position="relative";n.style.lineHeight="27px";n.style.padding="4px 20px"},n.prototype.OnContextMenuInternal=function(n){(n.preventDefault(),n.target==this.ViewerContatiner)&&this.OwnerControl.ej.browserInfo().name!="webkit"&&(this.AddContextMenuItems(),this.ShowContextMenu(),this.PositionContextMenu(n))},n.prototype.AddContextMenuItems=function(){var r=document.getElementById(l.ContextMenuCopy),n=document.getElementById(l.ContextMenuOpenHyperlink),t=document.getElementById(l.ContextMenuCopyHyperlink),i;r.className=this.OwnerControl.Selection.IsEmpty?l.DisabledContextMenuItem:l.ContextMenuItem;i=this.OwnerControl.Selection.GetHyperlinkField();i==null?(n.className=l.HiddenContextMenuItem,t.className=l.HiddenContextMenuItem):(n.className=l.ContextMenuItem,t.className=l.ContextMenuItem)},n.prototype.ShowContextMenu=function(){this.ContextMenu.style.display=="none"&&(this.ContextMenu.style.display="block")},n.prototype.HideContextMenu=function(){this.ContextMenu.style.display!="none"&&(this.ContextMenu.style.display="none")},n.prototype.PositionContextMenu=function(n){var t=this.GetContextMenuPosition(n),i=t.X,r=t.Y,u=this.ContextMenu.offsetWidth+4,f=this.ContextMenu.offsetHeight+4,e=window.innerWidth,o=window.innerHeight;this.ContextMenu.style.left=e-i<u?e-u+"px":i+"px";this.ContextMenu.style.top=o-r<f?o-f+"px":r+"px"},n.prototype.GetContextMenuPosition=function(n){var t=0,i=0;return n||(n=window.event),n.pageX||n.pageY?(t=n.pageX,i=n.pageY):(n.clientX||n.clientY)&&(t=n.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=n.clientY+document.body.scrollTop+document.documentElement.scrollTop),new k(t,i)},n.prototype.GetContextMenuItem=function(n,t){var i=n.srcElement||n.target;if(i.classList.contains(t))return i;while((i=i.parentNode)!=null)if(i.classList&&i.classList.contains(t))return i;return null},n.prototype.HandleContextMenuItem=function(n){var t;switch(n){case l.ContextMenuCopy:this.OwnerControl.Selection.Copy();break;case l.ContextMenuOpenHyperlink:t=this.OwnerControl.Selection.GetHyperlinkField();this.OwnerControl.FireRequestNavigate(t);break;case l.ContextMenuCopyHyperlink:var i=this.OwnerControl.Selection.GetHyperlinkField(),r=new kr(i),u=new gr(null);u.CopyToClipboard(r.NavigationLink)}},n.prototype.UpdateViewerSizeOnWindowResize=function(){var n=this,t=this.OwnerControl.DocumentEditorElement;n.UpdateViewerSize();n.UpdateScrollBars()},n.prototype.UpdateViewerSize=function(){var r=this.OwnerControl.DocumentEditorElement,n=r.getBoundingClientRect(),t=0,i=0;i=n.height>0?n.height:200;t=n.width>0?n.width:200;this.ViewerContatiner.style.height=i.toString()+"px";this.ViewerContatiner.style.width=t.toString()+"px";this.Container.style.height=i.toString()+"px";this.Container.style.width=t.toString()+"px";this.visibleBounds=new a(0,0,t,i)},n.prototype.ValidateFocus=function(){this.ViewerContatiner.focus()},n.prototype.InitTouchEvents=function(){var n=this;navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?(this.ViewerContatiner.addEventListener("pointerdown",function(t){n.OnPointerDownInternal(t)}),this.ViewerContatiner.addEventListener("pointermove",function(t){n.OnPointerMoveInternal(t)}),this.ViewerContatiner.addEventListener("pointerup",function(t){n.OnPointerUpInternal(t)}),this.ViewerContatiner.addEventListener("pointerleave",function(t){n.OnPointerUpInternal(t)})):(navigator.userAgent.match("Edge")||navigator.userAgent.match("Chrome")||navigator.userAgent.match("FireFox")||navigator.userAgent.match("Safari"))&&(this.ViewerContatiner.addEventListener("touchstart",function(t){n.OnTouchStartInternal(t)}),this.ViewerContatiner.addEventListener("touchmove",function(t){n.OnTouchMoveInternal(t)}),this.ViewerContatiner.addEventListener("touchend",function(t){n.OnTouchEndInternal(t)}),this.ViewerContatiner.addEventListener("touchcancel",function(t){n.OnTouchEndInternal(t)}))},n.prototype.InitTouchEllipse=function(){this.touchStart=document.createElement("div");this.touchStart.style.backgroundColor="transparent";this.touchStart.style.borderStyle="solid";this.touchStart.style.borderColor="black";this.touchStart.style.borderWidth="1px";this.touchStart.style.borderRadius="50%";this.touchStart.style.width="12px";this.touchStart.style.height="13px";this.touchStart.style.position="relative";this.touchStart.style.display="none";this.Container.appendChild(this.touchStart);this.touchEnd=document.createElement("div");this.touchEnd.style.backgroundColor="transparent";this.touchEnd.style.borderStyle="solid";this.touchEnd.style.borderColor="black";this.touchEnd.style.borderWidth="1px";this.touchEnd.style.borderRadius="50%";this.touchEnd.style.width="12px";this.touchEnd.style.height="13px";this.touchEnd.style.position="relative";this.touchEnd.style.display="none";this.Container.appendChild(this.touchEnd)},n.prototype.OnPointerDownInternal=function(n){n.pointerType=="touch"&&(this.PointerCount=this.PointerCount+1,this.PointerCount<=2&&(n.preventDefault(),this.Pointers.push(n),this.PointerCount==2&&(this.PointerCount=0),this.ScrollStartX==-1&&this.ScrollStartY==-1&&(navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET"))&&(this.ScrollStartY=n.pageY,this.ScrollStartX=n.pageX)),this.IsTouchInput=!1)},n.prototype.OnPointerMoveInternal=function(n){var r,u,f,i,t,e;if(n.pointerType=="touch"&&(this.PointerCount==1&&(r=n.pageX-this.ViewerContatiner.offsetLeft,f=n.pageY-this.ViewerContatiner.offsetTop,r<this.Container.clientWidth&&f<this.Container.clientHeight&&this.ScrollContainer(n)),this.Pointers.length==2&&(r=this.Pointers[0].pageX-this.ViewerContatiner.offsetLeft,u=this.Pointers[1].pageX-this.ViewerContatiner.offsetLeft,r<this.Container.offsetWidth&&u<this.Container.offsetWidth))){for(i=0;i<this.Pointers.length;i++)if(n.pointerId==this.Pointers[i].pointerId){this.Pointers[i]=n;break}t=Math.sqrt(Math.pow(this.Pointers[0].clientX-this.Pointers[1].clientX,2)+Math.pow(this.Pointers[0].clientY-this.Pointers[1].clientY,2));this.preDifference>-1&&(t>this.preDifference?this.OnPinchOutInternal(n):t<this.preDifference&&this.OnPinchInInternal(n));e=this.VerticalScrollBar.value;e==0||(t>this.preDifference?this.OnPinchOutInternal(n):t<this.preDifference&&this.OnPinchInInternal(n));this.preDifference=t}},n.prototype.OnPointerUpInternal=function(n){n.pointerType=="touch"&&(this.Pointers=[],this.PointerCount=0,this.preDifference=-1,this.IsTouchInput=!1,this.ScrollStartX=-1,this.ScrollStartY=-1)},n.prototype.OnTouchStartInternal=function(n){this.IsTouchInput=!0;var t=n.touches;t.length==1;this.ScrollStartX==-1&&this.ScrollStartY==-1&&(this.ScrollStartY=t[0].pageY,this.ScrollStartX=t[0].pageX);n.preventDefault()},n.prototype.OnTouchMoveInternal=function(n){var t=n.touches,r,u,i;t.length==1&&(r=t[0].pageX-this.ViewerContatiner.offsetLeft,u=t[0].pageY-this.ViewerContatiner.offsetTop,r<this.Container.clientWidth&&u<this.Container.clientHeight&&this.ScrollContainer(n));t.length>1&&(i=Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2)),this.preDifference>-1?i>this.preDifference?this.OnPinchOutInternal(n):i<this.preDifference&&this.OnPinchInInternal(n):this.ZoomFactor<2?this.preDifference!=-1&&i>this.preDifference&&this.OnPinchInInternal(n):this.preDifference==-1&&this.ZoomFactor>2&&i>this.preDifference&&this.OnPinchInInternal(n),this.preDifference=i);n.preventDefault()},n.prototype.OnTouchEndInternal=function(n){n.touches.length==1;this.ScrollStartX=-1;this.ScrollStartY=-1;this.preDifference=-1;this.IsTouchInput=!1;n.preventDefault()},n.prototype.OnPinchInInternal=function(){if(this.preZoomFactor=this.ZoomFactor,this.ZoomFactor=this.ZoomFactor-.01,this.ZoomFactor<5&&this.ZoomFactor>2&&(this.ZoomFactor=this.ZoomFactor-.01),this.ZoomFactor<.1&&(this.ZoomFactor=.1),this.ZoomFactor>=.1){var n=this.VerticalScrollBar.model.value/this.preZoomFactor*this.ZoomFactor;this.VerticalScrollBar.scroll(n)}},n.prototype.OnPinchOutInternal=function(){if(this.preZoomFactor=this.ZoomFactor,this.ZoomFactor=this.ZoomFactor+.01,this.ZoomFactor>2&&(this.ZoomFactor=this.ZoomFactor+.01),this.ZoomFactor>5&&(this.ZoomFactor=5),this.ZoomFactor<=5){var n=this.VerticalScrollBar.model.value/this.preZoomFactor*this.ZoomFactor;this.VerticalScrollBar.scroll(n)}},n.prototype.ScrollContainer=function(n){var t,i;navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?(t=this.ScrollStartX-n.pageX,i=this.ScrollStartY-n.pageY):(t=this.ScrollStartX-n.touches[0].pageX,i=this.ScrollStartY-n.touches[0].pageY);t<0&&(t=-t);i<0&&(i=-i);t>i?this.ScrollHorizontal(n):this.ScrollVertical(n)},n.prototype.ScrollHorizontal=function(n){var t=this.HorizontalScrollBar.model.value,i;navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?(n.preventDefault(),i=n.pageX,this.preDifference!=-1&&(t=this.preDifference>i?t+10:t-10),this.preDifference=i):n instanceof TouchEvent&&(n.preventDefault(),i=n.touches[0].pageX,this.preDifference!=-1&&(t=this.preDifference>i?t+10:t-10),this.preDifference=i);t<0&&(t=0);t>this.HorizontalScrollBar.model.maximum&&(t=this.HorizontalScrollBar.model.maximum);this.HorizontalScrollBar.scroll(t)},n.prototype.ScrollVertical=function(n){var t=this.VerticalScrollBar.model.value,i;navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?(n.preventDefault(),i=n.pageY,this.preDifference!=-1&&(t=this.preDifference>i?t+10:t-10),this.preDifference=i):n instanceof TouchEvent&&(n.preventDefault(),i=n.touches[0].pageY,this.preDifference!=-1&&(t=this.preDifference>i?t+10:t-10),this.preDifference=i);t<0&&(t=0);t>this.VerticalScrollBar.model.maximum&&(t=this.VerticalScrollBar.model.maximum);this.VerticalScrollBar.scroll(t)},n.prototype.OnMouseDownInternal=function(n){var i,t,r;if(this.IsTouchInput){n.preventDefault();return}if(i=this.GetContextMenuItem(n,l.ContextMenuItem),i!=null){this.HandleContextMenuItem(i.id);return}if(n.target==this.ViewerContatiner&&(this.ValidateFocus(),t=new k(n.offsetX,n.offsetY),!(t.X>this.Container.clientWidth))&&!(t.Y>this.Container.clientHeight)){if(r=this.FindFocusedPage(t),n.which==3&&!this.OwnerControl.Selection.IsEmpty&&!this.UpdateCursorPosition(r)){n.preventDefault();return}this.isMousedown=!0;this.isSelectionChangedOnMouseMoved=!1;n.preventDefault()}},n.prototype.OnMouseMoveInternal=function(n){var i,t,r,u;if(this.IsTouchInput){n.preventDefault();return}if(this.isMousedown){if(i=new k(n.offsetX,n.offsetY),t=this.FindFocusedPage(i),this.CurrentPage!=null&&(r=t.X,u=t.Y,this.isSelectionChangedOnMouseMoved||this.UpdateTextPositionforSelection(t,1,!0),this.IsLeftButtonPressed(n))){n.preventDefault();var f=u,e=this.OwnerControl.Selection.End,o=new k(r,f);this.OwnerControl.Selection.MoveTextPosition(o,!0,e,this);this.isSelectionChangedOnMouseMoved=!0}this.CheckForCursorVisibility(!1)}this.UpdateCursor(n)},n.prototype.OnMouseUpInternal=function(n){if(this.IsTouchInput){n.preventDefault();return}var i=new k(n.offsetX,n.offsetY),t=this.FindFocusedPage(i);this.isMousedown&&!this.isSelectionChangedOnMouseMoved&&this.CurrentPage!=null&&this.OwnerControl.Selection.Start!=null&&(this.UpdateTextPositionforSelection(t,n.detail,!0),this.CheckForCursorVisibility(!1));this.CurrentPage!=null&&this.OwnerControl.Selection.Start!=null&&this.OwnerControl.Selection.IsEmpty&&n.ctrlKey==!0&&this.NavigateHyperlink(t);this.isMousedown=!1;this.isSelectionChangedOnMouseMoved=!1;this.IsTouchInput=!1;n.preventDefault()},n.prototype.OnMouseWheelInternal=function(n){var i,r,t,u;n.ctrlKey==!0?(n.preventDefault(),i=n.pageX-this.ViewerContatiner.offsetLeft,i<this.Container.offsetWidth&&(this.preZoomFactor=this.ZoomFactor,navigator.userAgent.match("Firefox")?n.detail<0?this.ZoomFactor<=4.9&&(this.ZoomFactor=this.ZoomFactor+.1):this.ZoomFactor>=.2&&(this.ZoomFactor=this.ZoomFactor-.1):this.ZoomFactor=n.wheelDelta>0?this.ZoomFactor<=4.9?this.ZoomFactor+.1:5:this.ZoomFactor>=.2?this.ZoomFactor-.1:.1,r=this.VerticalScrollBar.model.value/this.preZoomFactor*this.ZoomFactor,this.VerticalScrollBar.scroll(r))):(u=navigator.userAgent.match("Edge")||navigator.userAgent.match("MSIE")||navigator.userAgent.match(".NET")?n.wheelDelta:n.wheelDeltaY,t=navigator.userAgent.match("Firefox")?this.VerticalScrollBar.model.value+n.detail*40:this.VerticalScrollBar.model.value-u,t>=0&&t<=this.VerticalScrollBar.model.maximum?(this.VerticalScrollBar.scroll(t),n.preventDefault()):t>this.VerticalScrollBar.model.maximum?this.VerticalScrollBar.scroll(this.VerticalScrollBar.model.maximum):this.VerticalScrollBar.scroll(0))},n.prototype.IsLeftButtonPressed=function(n){if(n=n||window.event,"buttons"in n)return n.buttons==1;var t=n.which||n.button;return t==1},n.prototype.OnkeyDownInternal=function(n){var t=n.which||n.keyCode,i=n.ctrlKey?n.ctrlKey:t===17?!0:!1,r=n.shiftKey?n.shiftKey:t===16?!0:!1;if(i&&!r)switch(t){case 65:this.OwnerControl.Selection.SelectRange(this.OwnerControl.Document.DocumentStart,this.OwnerControl.Document.DocumentEnd,!0);break;case 67:this.OwnerControl.Selection.Copy()}else if(r&&!i)switch(t){case 35:this.HandleShiftEndKey();break;case 36:this.HandleShiftHomeKey();break;case 37:this.HandleShiftLeftKey();break;case 38:this.HandleShiftUpKey();break;case 39:this.HandleShiftRightKey();break;case 40:this.HandleShiftDownKey()}else if(r&&i)switch(t){case 35:this.HandleControlShiftEndKey();break;case 36:this.HandleControlShiftHomeKey();break;case 37:this.HandleControlShiftLeftKey();break;case 38:this.HandleControlShiftUpKey();break;case 39:this.HandleControlShiftRightKey();break;case 40:this.HandleControlShiftDownKey()}n.preventDefault()},n.prototype.GetCurrentPoint=function(n,t){var i=new k(0,0);return i.X=n-this.ViewerContatiner.offsetLeft,i.Y=t-this.ViewerContatiner.offsetTop,i},n.prototype.UpdateCursorPosition=function(n){var i=this.GetLineWidget(n),s=null,e,o,r,l,a;i!=null&&i.CurrentParagraphWidget!=null&&i.CurrentParagraphWidget.ContainerWidget instanceof gt&&(s=i.CurrentParagraphWidget.ContainerWidget);var f=0,h=null,y=null;if(this.OwnerControl.Selection.SelectionRanges.Count>0)for(e=0;e<this.OwnerControl.Selection.SelectionRanges.Count;e++){var t=this.OwnerControl.Selection.SelectionRanges.Get(e),c=t.IsForward?t.Start:t.End,p=t.IsForward?t.End:t.Start,v=c.Location,w=p.Location,u=t.SelectedWidgets.Keys;for(o=0;o<u.Count;o++){if(r=u[o],l=t.SelectedWidgets.Get(r),r instanceof ki&&r==i)return h=u[u.length-1],y=t.SelectedWidgets.Get(h),n.X<=this.CurrentPage.Viewer.ClientArea.X?u[0]==i?!c.IsAtParagraphStart:!1:u[0]==i?(f=v.X+l.Width,c.IsAtParagraphStart?!(f>n.X):!(f>n.X&&v.X<n.X)):h==i?(f=l.Width,!(w.X>n.X&&this.CurrentPage.Viewer.ClientArea.X<n.X)):!1;if(r instanceof gt&&s!=null&&s==r&&(a=r,a.X+a.Width>n.X))return!1}}return!0},n.prototype.OnZoomFactorChanged=function(){this.zoomFactor>5?this.zoomFactor=5:this.zoomFactor<.1&&(this.zoomFactor=.1);this.Zoom();this.OwnerControl.RaiseClientEvent(vi.ZoomFactorChange,null)},n.prototype.UpdateHFClientArea=function(n,t){var i=n.SectionFormat.PageWidth-n.SectionFormat.LeftMargin-n.SectionFormat.RightMargin;i<0&&(i=0);this.ClientArea=t?new a(n.SectionFormat.LeftMargin,n.SectionFormat.HeaderDistance,i,n.SectionFormat.PageHeight-n.SectionFormat.HeaderDistance):new a(n.SectionFormat.LeftMargin,n.SectionFormat.PageHeight-n.SectionFormat.FooterDistance,i,n.SectionFormat.PageHeight-n.SectionFormat.FooterDistance);this.ClientActiveArea=new a(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height)},n.prototype.UpdateClientArea=function(n){var i=n.TopMargin,r,t;this.CurrentRenderingPage.HeaderWidget!=null&&(i=Math.max(n.HeaderDistance+this.CurrentRenderingPage.HeaderWidget.Height,n.TopMargin));r=.667+n.BottomMargin;this.CurrentRenderingPage.FooterWidget!=null&&(r=.667+Math.max(n.FooterDistance+this.CurrentRenderingPage.FooterWidget.Height,n.BottomMargin));t=n.PageWidth-n.LeftMargin-n.RightMargin;t<0&&(t=0);this.ClientArea=new a(n.LeftMargin,i,t,n.PageHeight-i-r);this.ClientActiveArea=new a(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height)},n.prototype.UpdateClientAreaForBlock=function(n,t){var i,r,f,u;t?n instanceof y&&n.TableWidgets.length>0?(r=n.TableWidgets[0],this.ClientActiveArea.X=this.ClientArea.X=r.X,this.ClientActiveArea.Width=this.ClientArea.Width=r.Width,r=n.TableWidgets[n.TableWidgets.length-1],r.X=this.ClientActiveArea.X,r.Y=this.ClientActiveArea.Y,this.ClientArea=new a(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new a(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height)):(n instanceof y&&n.TableFormat.TableAlignment!=fu.Left?(f=n.GetTableWidth(),i=n.TableFormat.TableAlignment==fu.Center?(this.ClientArea.Width-f)/2:this.ClientArea.Width-f,this.tableLeft.push(i)):i=n.LeftIndent,this.ClientActiveArea.X=this.ClientArea.X=this.ClientArea.X+i,u=this.ClientArea.Width-(i+n.RightIndent),this.ClientActiveArea.Width=this.ClientArea.Width=u>0?u:0,this.ClientArea=new a(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new a(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height)):(i=n instanceof y&&n.TableFormat.TableAlignment!=fu.Left&&this.tableLeft.length>0?this.tableLeft.pop():n.LeftIndent,this.ClientActiveArea.X=this.ClientArea.X=this.ClientArea.X-i,u=this.ClientArea.Width+i+n.RightIndent,this.ClientActiveArea.Width=this.ClientArea.Width=u>0?u:0,this.ClientArea=new a(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new a(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height))},n.prototype.UpdateClientAreaForRow=function(n,t){var i=n.OwnerTable.TableWidgets[n.OwnerTable.TableWidgets.length-1];t||(this.ClientActiveArea.X=this.ClientArea.X=i.X,this.ClientActiveArea.Width=this.ClientArea.Width=i.Width,this.ClientArea=new a(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new a(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height))},n.prototype.UpdateClientAreaForCell=function(n,t){var r=n.OwnerRow.TableRowWidgets[n.OwnerRow.TableRowWidgets.length-1],i=n.TableCellWidgets[n.TableCellWidgets.length-1];t?(this.ClientActiveArea.X=this.ClientArea.X=i.X,this.ClientActiveArea.Y=i.Y,this.ClientActiveArea.Width=this.ClientArea.Width=i.Width>0?i.Width:0,this instanceof ft&&(this.ClientActiveArea.Height=Number.POSITIVE_INFINITY),this.ClientArea=new a(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new a(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height)):(this.ClientActiveArea.X=this.ClientArea.X=i.X+i.Width+i.Margin.Right,this.ClientActiveArea.Width=r.X+r.Width-this.ClientArea.X<0?this.ClientArea.Width=0:this.ClientArea.Width=r.X+r.Width-this.ClientArea.X,this.ClientActiveArea.Y=i.Y-i.Margin.Top-n.OwnerTable.TableFormat.CellSpacing,n.OwnerTable.IsInsideTable||(this.ClientActiveArea.Height=this.ClientArea.Bottom-r.Y>0?this.ClientArea.Bottom-r.Y:0),this.ClientArea=new a(this.ClientArea.X,this.ClientArea.Y,this.ClientArea.Width,this.ClientArea.Height),this.ClientActiveArea=new a(this.ClientActiveArea.X,this.ClientActiveArea.Y,this.ClientActiveArea.Width,this.ClientActiveArea.Height))},n.prototype.UpdateClientWidth=function(n){this.ClientActiveArea.X-=n;this.ClientActiveArea.Width+n>0?this.ClientActiveArea.Width+=n:this.ClientActiveArea.Width=0},n.prototype.CutFromLeft=function(n){n<this.ClientActiveArea.Left&&(n=this.ClientActiveArea.Left);n>this.ClientActiveArea.Right&&(n=this.ClientActiveArea.Right);this.ClientActiveArea.Width=this.ClientActiveArea.Right>n?this.ClientActiveArea.Right-n:0;this.ClientActiveArea.X=n},n.prototype.CutFromTop=function(n){n<this.ClientActiveArea.Top&&(n=this.ClientActiveArea.Top);n>this.ClientActiveArea.Bottom&&(n=this.ClientActiveArea.Bottom);this.ClientActiveArea.Height=this.ClientActiveArea.Bottom-n;this.ClientActiveArea.X=this.ClientArea.X;this.ClientActiveArea.Width=this.ClientArea.Width;this.ClientActiveArea.Y=n},n.prototype.ClearContainer=function(){this.RemoveRenderedPages();this.Pages.Clear();this.VerticalScrollBar.scroll(0);this.HorizontalScrollBar.scroll(0)},n.prototype.InsertPage=function(n,t){var i,r;for(this.Pages.Remove(t),this.Pages.Insert(n,t),i=20,n>0&&(i+=this.Pages[n-1].BoundingRectangle.Bottom),r=n;r<this.Pages.Count;r++)t=this.Pages[r],t.BoundingRectangle=new a(t.BoundingRectangle.X,i,t.BoundingRectangle.Width,t.BoundingRectangle.Height),i=t.BoundingRectangle.Bottom+20},n.prototype.UpdateClientAreaTopOrLeft=function(n,t){t&&(this.ClientActiveArea.Y=this.ClientActiveArea.Y+n.TopBorderWidth,this.ClientActiveArea.X=this.ClientActiveArea.X+n.LeftBorderWidth)},n.prototype.UpdateTextPosition=function(n,t){var i=this.GetLineWidget(n);i!=null&&i.UpdateTextPosition(this.OwnerControl,n,t)},n.prototype.UpdateTextPositionforSelection=function(n,t,i){var r=this.GetLineWidget(n);if(r!=null&&r.UpdateTextPosition(this.OwnerControl,n,i),t>1){if(this.Pages.Count==0)return;this.CurrentPage!=null&&this.OwnerControl.Selection.Start!=null&&(t%2==0?this.OwnerControl.Selection.SelectCurrentWord(i):this.OwnerControl.Selection.SelectCurrentParagraph(i))}},n.prototype.GetLineWidget=function(n){return this.GetLineWidgetInternal(n,!1)},n.prototype.GetLineWidgetInternal=function(n){var i=null,t,r;if(this.CurrentPage!=null)for(t=0;t<this.CurrentPage.BodyWidgets.length;t++)if(r=this.CurrentPage.BodyWidgets[t],i=r.GetLineWidget(n),i!=null)break;return i},n.prototype.ClearSelectionHighlight=function(){var i=this,t,r,n,u;if(i instanceof ft)for(t=0;t<i.VisiblePages.Count;t++)r=i.VisiblePages[t],n=document.getElementById(r.Id+"_selection"),n!=null&&(u=n.getContext("2d"),u.clearRect(0,0,n.width,n.height));this.OwnerControl.Selection.SelectionRanges.Count>0&&this.OwnerControl.Selection.SelectionRanges.ClearSelectionHighlight()},n.prototype.NavigateHyperlink=function(n){var i=this.GetLineWidget(n),t;i!=null&&(t=i.GetHyperlinkField(this.OwnerControl,n),t!=null&&(this.UpdateTextPosition(n,!0),this.OwnerControl.FireRequestNavigate(t)))},n.prototype.ScrollToPosition=function(n,t){var f=t.Paragraph.GetLineWidgetInternal(t.Offset,!0),p=f.GetTop(),e,l,v;this.isMousedown&&(e=t.Paragraph.GetLineWidgetInternal(t.Offset,!1),l=e.GetTop(),e!=f&&t.Location.Y>=l&&(f=e));var a=f.Height,o=f.CurrentParagraphWidget.GetPage(),i=0,u=0,r=this,s=0;r instanceof ft&&(s=parseFloat(r.PageContainer.style.width.replace("px","")),v=o.BoundingRectangle.Width,i=(this.VisibleBounds.Width-v*this.ZoomFactor)/2,i<30&&(i=30),u=o.BoundingRectangle.Top*this.ZoomFactor+(this.Pages.IndexOf(o)+1)*r.PageGap*(1-this.ZoomFactor));i+=t.Location.X*this.ZoomFactor;u+=t.Location.Y*this.ZoomFactor;var h=0,c=0,y=parseFloat(this.Container.style.height.replace("px",""));r instanceof ft&&(r.PageContainer.style.left.indexOf("px")>-1&&(c=-parseFloat(r.PageContainer.style.left.replace("px",""))),r.PageContainer.style.top.indexOf("px")>-1&&(h=-parseFloat(r.PageContainer.style.top.replace("px",""))));h>u?this.VerticalScrollBar.scroll(u-10):h+y<u+a&&this.VerticalScrollBar.scroll(u+a-y+10);this.UpdateCaretToPage(n,o);c>i?this.HorizontalScrollBar.scroll(i-10):c+this.VisibleBounds.Width<i&&(i>=s-this.VisibleBounds.Width?this.HorizontalScrollBar.scroll(s-this.VisibleBounds.Width):this.HorizontalScrollBar.scroll(i))},n.prototype.RemovePage=function(n){this.CurrentPage==n&&(this.CurrentPage=null);this.SelectionStartPage==n&&(this.SelectionStartPage=null);this.SelectionEndPage==n&&(this.SelectionEndPage=null);var t=this.Pages.IndexOf(n);this.Pages.Remove(n);this.RemoveRenderedPages();this.UpdateScrollBars()},n.prototype.UpdateCaretToPage=function(n,t){if(t!=null)if(this.SelectionEndPage=t,this.OwnerControl.Selection.IsEmpty)this.SelectionStartPage=t;else{var r=n.Paragraph.GetLineWidget(n.Offset),i=r.CurrentParagraphWidget.GetPage();i!=null&&(this.SelectionStartPage=i)}},n.prototype.CheckForCursorVisibility=function(){},n.prototype.ShowCaret=function(n){n?(this.touchStart.style.display="block",this.touchEnd.style.display="block"):(this.touchStart.style.display="none",this.touchEnd.style.display="none")},n.prototype.HideCaret=function(){this.touchStart.style.display="none";this.touchEnd.style.display="none"},n.prototype.UpdateCaretPosition=function(){},n.prototype.UpdateTouchMarkPosition=function(){var n=this.GetCaretBottom(this.OwnerControl.Selection.Start,!1);this.touchStart.style.left=Math.round(this.OwnerControl.Selection.Start.Location.X-6)+"px";this.touchStart.style.top=n+"px";n=this.GetCaretBottom(this.OwnerControl.Selection.End,!1);this.touchEnd.style.left=Math.round(this.OwnerControl.Selection.End.Location.X-6)+"px";this.touchEnd.style.top=n+"px"},n.prototype.GetCaretBottom=function(n,t){var i=n.Location.Y;if(n.Paragraph.IsEmpty()){var l=n.Paragraph,r=0,u=0,f=l.GetParagraphMarkSize(r,u);r=f.TopMargin;u=f.BottomMargin;i+=f.Height;i+=r;t||(i+=u)}else{var e=0,s=n.Paragraph.GetInline(n.Offset,e),h=s.inline;e=s.index;var r=0,c=!1,o=h.GetCaretHeight(e,h.CharacterFormat,!1,r,c);r=o.TopMargin;c=o.IsItalic;i+=o.Height;t&&(i-=n.Paragraph.ParagraphFormat.AfterSpacing)}return i},n.prototype.HandleShiftLeftKey=function(){this.OwnerControl.Selection.ExtendBackward(!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleShiftRightKey=function(){this.OwnerControl.Selection.ExtendForward(!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleShiftUpKey=function(){this.OwnerControl.Selection.ExtendToPreviousLine(!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleShiftDownKey=function(){this.OwnerControl.Selection.ExtendToNextLine(!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleShiftHomeKey=function(){this.OwnerControl.Selection.ExtendToLineStart(!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleShiftEndKey=function(){this.OwnerControl.Selection.ExtendToLineEnd(!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleControlShiftHomeKey=function(){var n=null;this.OwnerControl.Document!=null&&(n=this.OwnerControl.Document.DocumentStart);n!=null&&(this.OwnerControl.Selection.End.SetPositionInternal(n),this.OwnerControl.Selection.FireSelectionChanged(!0));this.CheckForCursorVisibility(!1)},n.prototype.HandleControlShiftEndKey=function(){var n=null;this.OwnerControl.Document!=null&&(n=this.OwnerControl.Document.DocumentEnd);n!=null&&(this.OwnerControl.Selection.End.SetPosition(n.Paragraph,!1),this.OwnerControl.Selection.FireSelectionChanged(!0));this.CheckForCursorVisibility(!1)},n.prototype.HandleControlShiftDownKey=function(){this.OwnerControl.Selection.ExtendToParagraphEnd(!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleControlShiftLeftKey=function(){this.OwnerControl.Selection.ExtendToWordStart(!1,!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleControlShiftUpKey=function(){this.OwnerControl.Selection.ExtendToParagraphStart(!0);this.CheckForCursorVisibility(!1)},n.prototype.HandleControlShiftRightKey=function(){this.OwnerControl.Selection.ExtendToWordEnd(!1,!0);this.CheckForCursorVisibility(!1)},n}();t.LayoutViewer=au;ft=function(t){function i(n){t.call(this,n);this.PageGap=20;this.PageLeft=30;this.GetCurrentPageHeaderFooter=function(n,t){var i;return i=t?ot.OddHeader:ot.OddFooter,n.SectionFormat.DifferentFirstPage&&(this.Pages.length==1||this.Pages[this.Pages.length-1].Section!=n)?i=t?ot.FirstPageHeader:ot.FirstPageFooter:n.SectionFormat.DifferentOddAndEvenPages&&this.Pages.length%2==0&&(i=t?ot.EvenHeader:ot.EvenFooter),n.GetCurrentHeaderFooter(i)};this.PageContainer=document.createElement("div");this.PageContainer.setAttribute("id",this.OwnerControl.ContainerId+"_pageContainer");this.PageContainer.style.position="relative";this.Container.appendChild(this.PageContainer);this.VisiblePages=new e}return n(i,t),i.prototype.FindFocusedPage=function(n){var t=new k(n.X,n.Y),r;for(this.PageContainer.style.left.indexOf("px")>-1&&(t.X-=parseFloat(this.PageContainer.style.left.replace("px",""))),this.PageContainer.style.top.indexOf("px")>-1&&(t.Y-=parseFloat(this.PageContainer.style.top.replace("px",""))),r=0;r<this.Pages.length;r++){var i=this.Pages[r],u=(i.BoundingRectangle.Top-this.PageGap*(r+1))*this.ZoomFactor+this.PageGap*(r+1),e=i.BoundingRectangle.Height*this.ZoomFactor,f=i.BoundingRectangle.Left,o=i.BoundingRectangle.Right;if(u<=t.Y&&u+e>=t.Y)return this.CurrentPage=i,t.Y=(t.Y-u)/this.ZoomFactor,t.X=t.X>o?i.BoundingRectangle.Right:t.X<f?i.BoundingRectangle.Left:(t.X-f)/this.ZoomFactor,t}return t},i.prototype.UpdateCursor=function(n){var t=null,f=new k(n.offsetX,n.offsetY),i=this.FindFocusedPage(f),r=this.GetLineWidget(i),u;r!=null&&(t=r.GetHyperlinkField(this.OwnerControl,i));u=this.ViewerContatiner;u.style.cursor=t!=null&&n.ctrlKey==!0?"pointer":"default"},i.prototype.CreateNewPage=function(n){var r=this.PageGap,t;this.Pages.length>0&&(r=this.Pages[this.Pages.length-1].BoundingRectangle.Bottom+this.PageGap);t=new vu;t.Viewer=this;t.Section=n;var u=n.SectionFormat.PageWidth,f=n.SectionFormat.PageHeight,i=(this.VisibleBounds.Width-u*this.ZoomFactor)/2;return i<this.PageLeft&&(i=this.PageLeft),t.BoundingRectangle=new a(i,r,u,f),this.Pages.push(t),this.LayoutHeaderFooter(n),this.UpdateClientArea(n.SectionFormat),t.BodyWidgets.push(n.AddBodyWidget(this.ClientActiveArea)),t.BodyWidgets[t.BodyWidgets.length-1].Page=t,t},i.prototype.LayoutHeaderFooter=function(n){this.CurrentHeaderFooter=this.GetCurrentPageHeaderFooter(n,!0);this.CurrentHeaderFooter.Blocks.length>0&&(this.UpdateHFClientArea(n,!0),this.CurrentRenderingPage.HeaderWidget=this.CurrentHeaderFooter.LayoutItems(this));this.CurrentHeaderFooter=this.GetCurrentPageHeaderFooter(n,!1);this.CurrentHeaderFooter.Blocks.length>0&&(this.UpdateHFClientArea(n,!1),this.CurrentRenderingPage.FooterWidget=this.CurrentHeaderFooter.LayoutItems(this));this.CurrentHeaderFooter=null},i.prototype.Zoom=function(){this.UpdateScrollBars()},i.prototype.UpdateScrollBars=function(){for(var r,s,h,c,o,u=0,n=0;n<this.Pages.length;n++)u=u+this.Pages[n].BoundingRectangle.Height;for(r=0,n=0;n<this.Pages.length;n++)r<this.Pages[n].BoundingRectangle.Width&&(r=this.Pages[n].BoundingRectangle.Width);var f=r*this.ZoomFactor+this.PageLeft*2,e=u*this.ZoomFactor+(this.Pages.length+1)*this.PageGap,t=this.VisibleBounds.Width,i=this.VisibleBounds.Height;for(e>i&&(t-=this.VerticalScrollBar.model.width),f>t&&(i-=this.HorizontalScrollBar.model.height),r=f>t?f:t,u=e>i?e:i,this.Container.style.width=t.toString()+"px",this.Container.style.height=i.toString()+"px",this.PageContainer.style.width=r.toString()+"px",this.PageContainer.style.height=u.toString()+"px",n=0;n<this.Pages.length;n++)s=(r-this.Pages[n].BoundingRectangle.Width*this.ZoomFactor)/2,this.Pages[n].BoundingRectangle=s>this.PageLeft?new a(s,this.Pages[n].BoundingRectangle.Top,this.Pages[n].BoundingRectangle.Width,this.Pages[n].BoundingRectangle.Height):new a(this.PageLeft,this.Pages[n].BoundingRectangle.Top,this.Pages[n].BoundingRectangle.Width,this.Pages[n].BoundingRectangle.Height);h=this.HorizontalScrollBar.element[0];f>t?(o=this.HorizontalScrollBar.model.value,h.style.display="block",this.HorizontalScrollBar.option("maximum",r-t),this.HorizontalScrollBar.option("viewportsize",t),this.HorizontalScrollBar.option("width",t),this.HorizontalScrollBar._scrollData.handleSpace=t-2*this.HorizontalScrollBar.model.buttonSize,this.HorizontalScrollBar._scrollData.handle=Math.floor((t-18)/r*this.HorizontalScrollBar._scrollData.handleSpace),this.HorizontalScrollBar._scrollData.handle<15&&(this.HorizontalScrollBar._scrollData.handle=15),this.HorizontalScrollBar._scrollData.scrollable=this.HorizontalScrollBar.model.maximum,this.HorizontalScrollBar._scrollData.onePx=this.HorizontalScrollBar._scrollData.scrollable/(this.HorizontalScrollBar._scrollData.handleSpace-this.HorizontalScrollBar._scrollData.handle),this.HorizontalScrollBar["e-hhandle"].width(this.HorizontalScrollBar._scrollData.handle),this.HorizontalScrollBar.scroll(o)):(h.style.display="none",this.HorizontalScrollBar.scroll(0));c=this.VerticalScrollBar.element[0];e>i?(o=this.VerticalScrollBar.model.value,c.style.display="block",this.VerticalScrollBar.option("maximum",u-i),this.VerticalScrollBar.option("viewportsize",i),this.VerticalScrollBar.option("height",i),this.VerticalScrollBar._scrollData.handleSpace=i-2*this.VerticalScrollBar.model.buttonSize,this.VerticalScrollBar._scrollData.handle=Math.floor((i-18)/u*this.VerticalScrollBar._scrollData.handleSpace),this.VerticalScrollBar._scrollData.handle<15&&(this.VerticalScrollBar._scrollData.handle=15),this.VerticalScrollBar._scrollData.scrollable=this.VerticalScrollBar.model.maximum,this.VerticalScrollBar._scrollData.onePx=this.VerticalScrollBar._scrollData.scrollable/(this.VerticalScrollBar._scrollData.handleSpace-this.VerticalScrollBar._scrollData.handle),this.VerticalScrollBar["e-vhandle"].height(this.VerticalScrollBar._scrollData.handle),this.VerticalScrollBar.scroll(o)):(c.style.display="none",this.VerticalScrollBar.scroll(0))},i.prototype.VerticalScrollBar_ValueChanged=function(n){var t=n.scrollTop,i=parseFloat(this.Container.style.height),r=parseFloat(this.PageContainer.style.height);t>r-i&&(t=r-i);this.PageContainer.style.top=(-t).toString()+"px";this.UpdateVisiblePages(!0)},i.prototype.HorizontalScrollBar_ValueChanged=function(n){var t=n.scrollLeft,i=parseFloat(this.Container.style.width),r=parseFloat(this.PageContainer.style.width);t>r-i&&(t=r-i);this.PageContainer.style.left=(-t).toString()+"px"},i.prototype.UpdateVisiblePages=function(){for(var n=0;n<this.PageContainer.childNodes.length;n++)this.PageContainer.removeChild(this.PageContainer.childNodes[n]),n--;this.ClearVisiblePages();var e=this.PageGap,u=this.VisibleBounds.Height,t=-parseFloat(this.PageContainer.style.top),o=!0;for(n=0;n<this.Pages.length;n++){var r=this.Pages[n],i=(r.BoundingRectangle.Top-this.PageGap*(n+1))*this.ZoomFactor+this.PageGap*(n+1),f=r.BoundingRectangle.Height*this.ZoomFactor,s=r.BoundingRectangle.Left;(i>=t&&i<=t+u||i<=t&&i+f>=t+u||i+f>=t&&i+f<=t+u)&&(this.AddVisiblePage(r,s,e,!1),o=!1);e+=this.PageGap+r.BoundingRectangle.Height*this.ZoomFactor}},i.prototype.AddVisiblePage=function(n,t,i){var e=n.BoundingRectangle.Height*this.ZoomFactor,o=n.BoundingRectangle.Width*this.ZoomFactor,r,u,f;n.Id=this.OwnerControl.ContainerId+"_page_"+Math.random().toString();r=document.createElement("canvas");r.style.position="absolute";r.style.top=i.toString()+"px";r.style.left=t.toString()+"px";r.style.borderWidth="1px";r.style.borderColor="#D9DCDD";r.style.borderStyle="solid";r.style.backgroundColor=this.OwnerControl.Document.BackgroundColor;r.height=e;r.width=o;r.style.zIndex="0";r.id=n.Id+"_background";this.PageContainer.appendChild(r);u=document.createElement("canvas");u.style.position="absolute";u.style.top=i.toString()+"px";u.style.left=t.toString()+"px";u.style.borderWidth="0px";u.height=e;u.width=o;u.style.zIndex="1";u.id=n.Id+"_foreground";this.PageContainer.appendChild(u);f=document.createElement("canvas");f.style.position="absolute";f.style.top=i.toString()+"px";f.style.left=t.toString()+"px";f.style.borderWidth="0px";f.height=e;f.width=o;f.style.zIndex="2";f.id=n.Id+"_selection";this.PageContainer.appendChild(f);this.VisiblePages.Add(n);n.RenderWidgets()},i.prototype.ClearVisiblePages=function(){for(var i,t,n=0;n<this.VisiblePages.length;n++)i=this.VisiblePages[n],t=document.getElementById(i.Id),t!=null&&t.parentElement.removeChild(t),this.VisiblePages.RemoveAt(n),i.RemoveWidgets(this)},i.prototype.Print=function(){for(var r,i,n,e,u=0,t=0;t<this.Pages.length;t++)u=u+this.Pages[t].BoundingRectangle.Height;for(r=0,t=0;t<this.Pages.length;t++)r<this.Pages[t].BoundingRectangle.Width&&(r=this.Pages[t].BoundingRectangle.Width);for(i=navigator.userAgent,n=document.createElement("iframe"),n.style.position="absolute",n.style.left="-150em",document.body.appendChild(n),n.contentDocument.open(),i.indexOf("Chrome")!=-1||i.indexOf("Safari")!=-1||i.indexOf("Firefox")!=-1?(e=r<u?"portrait":"landscape",n.contentDocument.write("<!DOCTYPE html>"),n.contentDocument.write("<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100%; } img { height: 100%; width: 100%; display: block;}@media print{ body { margin: 0cm;}img { box-sizing: border-box; }br, button { display: none; }} @page{margin:0cm; size:"+e+";} <\/style><\/head><body><center>")):n.contentDocument.write("<html><head><style>@page{margin:0;size:"+r.toString()+"px "+u.toString()+"px;}<\/style><\/head><body><center>"),t=0;t<this.Pages.length;t++){var f=this.Pages[t],o=f.BoundingRectangle.Height,s=f.BoundingRectangle.Width,h=f.RenderCanvas().toDataURL();i.indexOf("Chrome")!=-1||i.indexOf("Safari")!=-1||i.indexOf("Firefox")!=-1?n.contentDocument.write('<div><img src="'+h+'" style="margin:0px;display:block;width:'+s.toString()+"px;height:"+o.toString()+'px; "/><\/div><br/>'):n.contentDocument.write('<img src="'+h+'" style="width:'+s.toString()+"px;height:"+o.toString()+';margin:0px;"/><br />')}n.contentDocument.write("<\/center><\/body><\/html>");n.contentDocument.write("<\/body><\/html>");navigator.userAgent.match("Firefox")?n.contentWindow.close():n.contentDocument.close();i.indexOf("Chrome")!=-1||i.indexOf("Safari")!=-1||i.indexOf("Firefox")!=-1?(n.contentWindow.focus(),n.contentWindow.print(),setTimeout(function(){document.body.removeChild(n)},500)):n.contentWindow.document.execCommand("print",!1,null)},i.prototype.RenderVisiblePages=function(){for(var t,n=0;n<this.Pages.length;n++)t=this.Pages[n],t.RemoveWidgets(this),t.RenderWidgets()},i.prototype.RemoveRenderedPages=function(){for(var t,i,n=0;n<this.Pages.length;n++)t=this.Pages[n],i=document.getElementById(t.Id),i!=null&&i.remove(),t.RemoveWidgets(this)},i.prototype.SetPageCount=function(){this.OwnerControl.PageCount=this.Pages.Count>0?this.Pages.Count:1},i}(au);t.PageLayoutViewer=ft;vu=function(){function n(){this.RepeatHeaderRowTableWidget=!1;this.HeaderWidget=null;this.FooterWidget=null;this.BodyWidgets=new e}return n.prototype.RenderWidgets=function(){var t=document.getElementById(this.Id+"_background").getContext("2d"),i=document.getElementById(this.Id+"_selection").getContext("2d"),r=document.getElementById(this.Id+"_foreground").getContext("2d"),n;for(this.SetZoomTransform(t,r,i,this),this.HeaderWidget!=null&&this.HeaderWidget._render(this),this.FooterWidget!=null&&this.FooterWidget._render(this),n=0;n<this.BodyWidgets.length;n++)this.BodyWidgets[n]._render(this)},n.prototype.RemoveWidgets=function(n){if(this.HeaderWidget!=null&&this.HeaderWidget.RemoveWidget(n),this.FooterWidget!=null&&this.FooterWidget.RemoveWidget(n),this.BodyWidgets!=null)for(var t=0;t<this.BodyWidgets.Count;t++)this.BodyWidgets[t].RemoveWidget(n)},n.prototype.RenderCanvas=function(){var n=document.createElement("canvas"),t;for(n.style.position="absolute",n.style.borderStyle="solid",n.style.borderWidth="1px",n.setAttribute("width",this.BoundingRectangle.Width.toString()),n.setAttribute("height",this.BoundingRectangle.Height.toString()),this.HeaderWidget!=null&&this.HeaderWidget._renderCanvas(n),this.FooterWidget!=null&&this.FooterWidget._renderCanvas(n),t=0;t<this.BodyWidgets.length;t++)this.BodyWidgets[t]._renderCanvas(n);return n},n.prototype.SetZoomTransform=function(n,t,i,r){n.setTransform(r.Viewer.ZoomFactor,0,0,r.Viewer.ZoomFactor,1,1);t.setTransform(r.Viewer.ZoomFactor,0,0,r.Viewer.ZoomFactor,1,1);i.setTransform(r.Viewer.ZoomFactor,0,0,r.Viewer.ZoomFactor,1,1)},n.prototype.ClearTransform=function(n,t,i){n.setTransform(1,0,0,1,0,0);t.setTransform(1,0,0,1,0,0);i.setTransform(1,0,0,1,0,0)},n.prototype.Dispose=function(){this.HeaderWidget=null;this.FooterWidget=null;this.Section=null;this.RemoveWidgets(this.Viewer);this.BodyWidgets!=null&&(this.BodyWidgets.Clear(),this.BodyWidgets=null);this.Viewer!=null&&(this.Viewer.Pages!=null&&this.Viewer.RemovePage(this),this.Viewer=null)},n}();t.Page=vu;oi=function(){function n(){this.X=0;this.Y=0;this.Width=0;this.Height=0;this.ChildWidgets=new e}return n.prototype.UpdateClientAreaLocation=function(n){this.X=n.X;this.Y=n.Y;this.Width=n.Width},n.prototype.UpdateWidgetLocation=function(n){this.X=n.X;this.Y=n.Y;this.Width=n.Width},n.prototype.GetPage=function(){var n=null,t;return this.ContainerWidget instanceof ni?(t=this.ContainerWidget,n=this.ContainerWidget.Page):this.ContainerWidget!=null&&(n=this.ContainerWidget.GetPage()),n},n.prototype.RenderSingleBorder=function(n,t,i,r,u,f,e){n.beginPath();n.moveTo(i,r);n.lineTo(u,f);n.lineWidth=e;n.strokeStyle=t.Color?t.Color:"#000000";e>0&&n.stroke();n.closePath()},n.prototype.ClearChildSelectionHighlight=function(t){for(var i=0;i<this.ChildWidgets.Count;i++)this.ChildWidgets[i]instanceof ki?this.ChildWidgets[i].ClearSelectionHighlight(t):this.ChildWidgets[i]instanceof gt?this.ChildWidgets[i].ClearSelectionHighlight(t):this.ChildWidgets[i]instanceof n&&this.ChildWidgets[i].ClearChildSelectionHighlight(t)},n}();t.Widget=oi;ni=function(t){function i(n){t.call(this);this.CurrentNode=n}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){var i=document.getElementById(n.Id+"_foreground"),r,t,u;if(i!=null)for(r=i.getContext("2d"),r.globalAlpha=1,t=0;t<this.ChildWidgets.length;t++)u=this.ChildWidgets[t],u._render(n)},i.prototype._renderCanvas=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._renderCanvas(n)},i.prototype.ShiftChildLocation=function(n){this.Y+=n;for(var t=0;t<this.ChildWidgets.length;t++)this.ChildWidgets[t]instanceof pt?(this.ChildWidgets[t].X=this.ChildWidgets[t].X,this.ChildWidgets[t].Y=this.ChildWidgets[t].Y+n):this.ChildWidgets[t].ShiftChildLocation(n)},i.prototype.GetLineWidget=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)if(this.ChildWidgets[t].Y<=n.Y&&this.ChildWidgets[t].Y+this.ChildWidgets[t].Height>=n.Y)return this.ChildWidgets[t].GetLineWidget(n);return i=null,this.ChildWidgets.length>0&&(i=this.ChildWidgets[0].Y<=n.Y?this.ChildWidgets[this.ChildWidgets.length-1].GetLineWidget(n):this.ChildWidgets[0].GetLineWidget(n)),i},i.prototype.RemoveWidget=function(n){if(n!=null)for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=this.Height,t,n;if(this.ChildWidgets!=null){for(t=0;t<this.ChildWidgets.Count;t++){if(n=this.ChildWidgets[t],n instanceof pt?n.Dispose():n instanceof bi?n.Dispose():n.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(n);t--}this.ChildWidgets=null}this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets!=null&&(this.ContainerWidget.ChildWidgets.Remove(this),this.ContainerWidget.Height-=i),this.ContainerWidget=null);this instanceof tu&&this.CurrentNode!=null?(this.CurrentNode.LayoutedWidgets!=null&&this.CurrentNode.LayoutedWidgets.Remove(this),this.CurrentNode=null):dt instanceof lt&&(this.CurrentNode.BodyWidgets!=null&&this.CurrentNode.BodyWidgets.Remove(this),this.CurrentNode=null);this.Page!=null&&(this.Page.BodyWidgets!=null&&this.Page.BodyWidgets.Contains(this)?(this.Page.BodyWidgets.Remove(this),this.Page.BodyWidgets.Count==0&&this.Page.Dispose()):this.Page.HeaderWidget==this?this.Page.HeaderWidget=null:this.Page.FooterWidget==this&&(this.Page.FooterWidget=null),this.Page=null)},i}(oi);t.BodyWidget=ni;tu=function(t){function i(n){t.call(this,n)}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){var i=document.getElementById(n.Id+"_foreground"),r,t,u;if(i!=null)for(r=i.getContext("2d"),r.globalAlpha=.75,t=0;t<this.ChildWidgets.length;t++)u=this.ChildWidgets[t],u._render(n)},i.prototype._renderCanvas=function(n){var i,t,r;if(n!=null)for(i=n.getContext("2d"),i.globalAlpha=.75,t=0;t<this.ChildWidgets.length;t++)r=this.ChildWidgets[t],r._renderCanvas(n)},i.prototype.GetLineWidget=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)if(this.ChildWidgets[t].Y<=n.Y&&this.ChildWidgets[t].Y+this.ChildWidgets[t].Height>=n.Y)return this.ChildWidgets[t].GetLineWidget(n);return i=null,this.ChildWidgets.length>0&&(i=this.ChildWidgets[0].Y<=n.Y?this.ChildWidgets[this.ChildWidgets.length-1].GetLineWidget(n):this.ChildWidgets[0].GetLineWidget(n)),i},i}(ni);t.HeaderFooterWidget=tu;ti=function(t){function i(n){t.call(this);this.leftMargin=0;this.topMargin=0;this.rightMargin=0;this.bottomMargin=0;this.CurrentNode=n;this.Table=n;this.Margin=new fi(this.leftMargin,this.topMargin,this.rightMargin,this.bottomMargin);this.LeftBorderWidth=0;this.RightBorderWidth=0;this.TopBorderWidth=0;this.BottomBorderWidth=0}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){var u=document.getElementById(n.Id+"_background"),i,t,r;for(this.CurrentNode.TableFormat.CellSpacing>0&&(i=u.getContext("2d"),this.RenderTableOutline(i)),t=0;t<this.ChildWidgets.length;t++)r=this.ChildWidgets[t],r._render(n)},i.prototype._renderCanvas=function(n){var i,t,r;for(this.CurrentNode.TableFormat.CellSpacing>0&&(i=n.getContext("2d"),this.RenderTableOutline(i)),t=0;t<this.ChildWidgets.length;t++)r=this.ChildWidgets[t],r._renderCanvas(n)},i.prototype.UpdateHeight=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i.UpdateHeight(n,!0)},i.prototype.ShiftChildLocation=function(n){this.Y=this.Y+n;for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].ShiftChildLocation(n)},i.prototype.GetSplittedWidget=function(n){for(var u,e,r,o=this.Y,t=null,f=0;f<this.ChildWidgets.length;f++){if(u=this.ChildWidgets[f],e=u.Height,(n<o+e||t!=null)&&(r=t==null&&u.IsFirstLineFit(n)?u.GetSplittedWidget(n):u,r!=null)){if(f==0&&r==u)return this;this.ChildWidgets.Contains(r)?(this.ChildWidgets.RemoveAt(this.ChildWidgets.indexOf(r)),f--,this.Height-=r.Height):this.Height-=e-u.Height;t==null?(t=new i(this.Table),t.UpdateWidgetLocation(this),this.Table.TableWidgets.push(t),t.Height=r.Height):t.Height+=r.Height;t.ChildWidgets.push(r);r.ContainerWidget=t}o+=u.Height}return t},i.prototype.IsFirstLineFit=function(n){return this.ChildWidgets[0].IsFirstLineFit(n)},i.prototype.UpdateChildLocation=function(n){for(var t,i=0;i<this.ChildWidgets.length;i++)t=this.ChildWidgets[i],t.X=t.X,t.Y=n,t.UpdateChildLocation(n),n+=t.Height},i.prototype.GetLineWidget=function(n){for(var t,r,f,l,e,i=null,u=0;u<this.ChildWidgets.Count;u++)if(this.ChildWidgets[u].Y<=n.Y){i=this.ChildWidgets[u].GetLineWidget(n);t=null;i!=null&&(t=i.CurrentParagraphWidget.ContainerWidget);r=0;f=0;t!=null&&(r=t.TableCell.OwnerTable.TableFormat.CellSpacing,f=t.TableCell.CellFormat.RowSpan);var o=0,s=0,h=0,c=0;if(r>0&&(o=t.TableCell.CellIndex==0?r:r/2,s=t.TableCell.CellIndex==t.TableCell.OwnerRow.Cells.Count-1?r:r/2,l=t.ContainerWidget,e=t.ContainerWidget.ContainerWidget,l!=null&&e!=null&&e.Table.TableWidgets.Count>0&&(h=t.TableCell.OwnerRow.RowIndex==0?r:r/2,c=t.TableCell.OwnerRow.RowIndex+f==t.TableCell.OwnerTable.Rows.Count?r:r/2)),i!=null&&i.CurrentParagraphWidget.X<=n.X&&i.CurrentParagraphWidget.X+i.Width>=n.X&&i.CurrentParagraphWidget.Y<=n.Y&&i.GetTop()+i.Height>=n.Y||t!=null&&t.X-t.Margin.Left-o<=n.X&&t.X+t.Width+t.Margin.Right+s>=n.X&&t.Y-t.Margin.Top-h<=n.Y&&t.Y+t.Height+t.Margin.Bottom+c>=n.Y)break}return i},i.prototype.RenderTableOutline=function(n){var r=this.CurrentNode,i=r.TableFormat.Borders.GetTableTopBorder(),t=0;i!=null&&(t=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left-t/2,this.Y,this.X-this.Margin.Left-t/2,this.Y+this.Height,t));i=r.TableFormat.Borders.GetTableTopBorder();t=0;i!=null&&(t=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left-t,this.Y-t/2,this.X+this.Width+t+this.Margin.Right,this.Y-t/2,t));i=r.TableFormat.Borders.GetTableRightBorder();t=0;i!=null&&(t=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X+this.Width+this.Margin.Right+t/2,this.Y,this.X+this.Width+this.Margin.Right+t/2,this.Y+this.Height,t));i=r.TableFormat.Borders.GetTableBottomBorder();t=0;i!=null&&(t=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left-t,this.Y+this.Height-t/2,this.X+this.Width+t+this.Margin.Right,this.Y+this.Height-t/2,t))},i.prototype.RemoveWidget=function(n){for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=this.Height,n,t;if(this.ChildWidgets!=null){for(n=0;n<this.ChildWidgets.Count;n++){if(t=this.ChildWidgets[n],t.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(t);n--}this.ChildWidgets=null}this.Table!=null&&(this.Table.TableWidgets!=null&&this.Table.TableWidgets.Remove(this),this.Table=null);this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets!=null&&(this.ContainerWidget.ChildWidgets.Remove(this),this.ContainerWidget.Height-=i,(this.ContainerWidget.ChildWidgets==null||this.ContainerWidget.ChildWidgets.Count==0)&&this.ContainerWidget instanceof ni&&this.ContainerWidget.Dispose()),this.ContainerWidget=null)},i}(oi);t.TableWidget=ti;bi=function(t){function i(n){t.call(this);this.CurrentNode=n;this.TableRow=n;this.TopBorderWidth=0;this.BottomBorderWidth=0}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._render(n)},i.prototype._renderCanvas=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._renderCanvas(n)},i.prototype.splitSpannedCellWidget=function(n,t){var i=n.GetSplittedWidget(t.ClientArea.Bottom,!1);i!=null&&t.SplittedCellWidgets.push(i)},i.prototype.UpdateHeight=function(n,t){for(var c,e,r,o,u,l,s=0;s<this.ChildWidgets.length;s++){var f=0,i=this.ChildWidgets[s],h=1;for(h=i.TableCell.CellFormat.RowSpan,f=i.TableCell.OwnerTable.TableFormat.CellSpacing,h>1?(c=this.ContainerWidget.ChildWidgets.indexOf(this),e=c+h-1-(this.TableRow.RowIndex-i.TableCell.OwnerRow.RowIndex),(n.ClientArea.Bottom<i.Y+i.Height+i.Margin.Bottom||e>=c+1)&&this.splitSpannedCellWidget(i,n),r=this,e>0&&(r=e<this.ContainerWidget.ChildWidgets.length?this.ContainerWidget.ChildWidgets[e]:this.ContainerWidget.ChildWidgets[this.ContainerWidget.ChildWidgets.length-1]),i.Y+i.Height+i.Margin.Bottom<r.Y+r.Height?i.Height=r.Y+r.Height-i.Y-i.Margin.Bottom:this.ContainerWidget.ContainerWidget!=null&&i.Y+i.Height+i.Margin.Bottom>r.Y+r.Height&&(r.Height=i.Y+i.Height+i.Margin.Bottom-r.Y,this==r&&this.TableRow.NextNode instanceof ri&&(o=this.TableRow.NextNode,o.TableRowWidgets.length>0&&(o.TableRowWidgets[0].X=o.TableRowWidgets[0].X,o.TableRowWidgets[0].Y=this.Y+this.Height)))):(f>0&&this.TableRow.OwnerTable.TableWidgets.Count>1&&this.Y==this.TableRow.OwnerTable.Document.OwnerControl.Viewer.ClientArea.Y&&n instanceof ft&&(f=f/2),i.Height=this.Height-i.Margin.Top-i.Margin.Bottom-f),i.UpdateHeight(n),u=this.ContainerWidget;u.ContainerWidget instanceof oi;)u=u.ContainerWidget;l=null;u instanceof ni&&(l=u.Page);(n instanceof ft&&n.VisiblePages.Contains(l)||t)&&i.UpdateCellVerticalPosition(!1,!1)}},i.prototype.GetSplittedWidget=function(n){for(var u,t,e,r=null,o=this.TableRow.RowIndex,f=0;f<this.ChildWidgets.length;f++)if(u=this.ChildWidgets[f],t=u.GetSplittedWidget(n,!0),t!=null){if(t==u)return this;this.ChildWidgets.Contains(t)&&this.ChildWidgets.Remove(t);(f==0||this.Height<u.Height+u.Margin.Top+u.Margin.Bottom)&&(this.Height=u.Height+u.Margin.Top+u.Margin.Bottom);r==null&&(r=new i(this.TableRow),r.UpdateWidgetLocation(this),this.TableRow.TableRowWidgets.push(r),r.Height=0);e=1;e=t.TableCell.CellFormat.RowSpan;o-t.TableCell.OwnerRow.RowIndex==e-1&&r.Height<t.Height+t.Margin.Top+t.Margin.Bottom&&(r.Height=t.Height+t.Margin.Top+t.Margin.Bottom);r.ChildWidgets.Add(t);t.ContainerWidget=r}return r},i.prototype.IsFirstLineFit=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)if(i=this.ChildWidgets[t],!i.IsFirstLineFit(n))return!1;return!0},i.prototype.InsertSplittedCellWidgets=function(n){for(var t=this.X,o=0,u,r,f,e,o=this.TableRow.OwnerTable.TableWidth,i=0;i<this.ChildWidgets.length;i++){if(u=this.ChildWidgets[i],Math.round(t)<Math.round(u.X-u.Margin.Left)){if(this.InsertRowSpannedWidget(n,t,i)){i--;continue}if(e=this.ChildWidgets.length,this.InsertEmptySplittedCellWidget(t,i),e<this.ChildWidgets.length){i--;continue}}if(t+=u.Margin.Left+u.Width+u.Margin.Right,i==this.ChildWidgets.length-1&&Math.round(t)<Math.round(this.X+o)){if(this.InsertRowSpannedWidget(n,t,i+1))continue;this.InsertEmptySplittedCellWidget(t,i+1);continue}if((this.ChildWidgets==null||this.ChildWidgets.Count==0)&&n.SplittedCellWidgets.Count>0)for(r=0;r<n.SplittedCellWidgets.Count;r++){if(f=n.SplittedCellWidgets[r],Math.round(t)<=Math.round(f.X-f.Margin.Left)){if(this.InsertRowSpannedWidget(n,t,r)){r--;continue}if(e=this.ChildWidgets.Count,this.InsertEmptySplittedCellWidget(t,r),e<this.ChildWidgets.Count){r--;continue}}if(t+=f.Margin.Left+f.Width+f.Margin.Right,r==this.ChildWidgets.Count-1&&Math.round(t)<Math.round(this.X+o)){if(this.InsertRowSpannedWidget(n,t,r+1))continue;this.InsertEmptySplittedCellWidget(t,r+1);continue}}n.SplittedCellWidgets.Count>0&&n.SplittedCellWidgets.Clear()}},i.prototype.InsertRowSpannedWidget=function(n,t,i){for(var r,u=0;u<n.SplittedCellWidgets.length;u++)if(r=n.SplittedCellWidgets[u],Math.round(t)==Math.round(r.X-r.Margin.Left))return this.ChildWidgets.Insert(i,r),r.ContainerWidget=this,n.SplittedCellWidgets.Remove(r),!0;return!1},i.prototype.InsertEmptySplittedCellWidget=function(n,t){for(var r,e,u,o,i,s,h=this.TableRow.OwnerTable.TableWidgets[this.TableRow.OwnerTable.TableWidgets.length-1],f=h.ChildWidgets.length-1;f>=0;f--)for(r=h.ChildWidgets[f],e=r.X,u=0;u<r.ChildWidgets.length;u++){if(o=1,i=r.ChildWidgets[u],Math.round(n)==Math.round(e)){o=i.TableCell.CellFormat.RowSpan;o>1&&(s=i.CreateCellWidget(),this.ChildWidgets.Insert(t,s),s.ContainerWidget=this);return}e+=i.Margin.Left+i.Width+i.Margin.Right}},i.prototype.UpdateChildLocation=function(n){var r=0,i,t;for(this.TableRow.OwnerTable.TableFormat.CellSpacing>0&&(r=this.TableRow.OwnerTable.TableFormat.CellSpacing),i=0;i<this.ChildWidgets.length;i++)t=this.ChildWidgets[i],t.X=t.X,t.Y=n+t.Margin.Top+r,t.UpdateChildLocation(t.Y)},i.prototype.ShiftChildLocation=function(n){this.Y=this.Y+n;for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].ShiftChildLocation(n)},i.prototype.GetLineWidget=function(n){for(var i,r,u,f,t=0;t<this.ChildWidgets.length;t++)if(i=0,i=this.TableRow.OwnerTable.TableFormat.CellSpacing,r=0,u=0,i>0&&(r=this.ChildWidgets[t].TableCell.ColumnIndex==0?i:i/2,u=this.ChildWidgets[t].TableCell.CellIndex==this.ChildWidgets[t].TableCell.OwnerRow.Cells.Count-1?i:i/2),this.ChildWidgets[t].X-this.ChildWidgets[t].Margin.Left-r<=n.X&&this.ChildWidgets[t].X+this.ChildWidgets[t].Width+this.ChildWidgets[t].Margin.Right+u>=n.X)return this.ChildWidgets[t].GetLineWidget(n);return f=null,this.ChildWidgets.length>0&&(f=this.ChildWidgets[0].X<=n.X?this.ChildWidgets[this.ChildWidgets.length-1].GetLineWidget(n):this.ChildWidgets[0].GetLineWidget(n)),f},i.prototype.RemoveWidget=function(n){for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=this.Height,n,t;if(this.ChildWidgets!=null){for(n=0;n<this.ChildWidgets.Count;n++){if(t=this.ChildWidgets[n],t.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(t);n--}this.ChildWidgets=null}this.TableRow!=null&&(this.TableRow.TableRowWidgets!=null&&this.TableRow.TableRowWidgets.Remove(this),this.TableRow=null);this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets!=null&&(this.ContainerWidget.ChildWidgets.Remove(this),(this.ContainerWidget.ChildWidgets==null||this.ContainerWidget.ChildWidgets.Count==0)&&this.ContainerWidget instanceof ti?this.ContainerWidget.Dispose():this.ContainerWidget.ContainerWidget instanceof ni&&(this.ContainerWidget.ContainerWidget.Height-=i),this.ContainerWidget.Height-=i),this.ContainerWidget=null)},i}(oi);t.TableRowWidget=bi;gt=function(t){function i(n){t.call(this);this.leftMargin=0;this.topMargin=0;this.rightMargin=0;this.bottomMargin=0;this.TableCell=n;this.CurrentNode=n;this.Margin=new fi(this.leftMargin,this.topMargin,this.rightMargin,this.bottomMargin);this.LeftBorderWidth=0;this.RightBorderWidth=0}return n(i,t),i.prototype._getHTML=function(){for(var r,t="",n=0,i=this.ChildWidgets;n<i.length;n++)r=i[n],t+=r._getHTML();return t},i.prototype._render=function(n){var f=document.getElementById(n.Id+"_background"),e=f.getContext("2d"),i,r,t,u;for(this.RenderTableCellOutline(e),i=document.getElementById(n.Id+"_selection"),r=i.getContext("2d"),n.Viewer.OwnerControl.Selection.SelectionRanges.Count>0&&n.Viewer.OwnerControl.Selection.SelectionRanges.AddSelectionHighlightTable(r,this),t=0;t<this.ChildWidgets.length;t++)u=this.ChildWidgets[t],u._render(n)},i.prototype._renderCanvas=function(n){var r=n.getContext("2d"),t,i;for(this.RenderTableCellOutline(r),t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._renderCanvas(n)},i.prototype.ShiftChildLocation=function(n){this.Y=this.Y+n;for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t]instanceof pt?(this.ChildWidgets[t].X=this.ChildWidgets[t].X,this.ChildWidgets[t].Y=this.ChildWidgets[t].Y+n):this.ChildWidgets[t].ShiftChildLocation(n)},i.prototype.GetSplittedWidget=function(n,t){var i=null,r,o,u,e,s,f;if(this.Y+this.Height>n-this.Margin.Bottom)for(r=0;r<this.ChildWidgets.length;r++)if(this.ChildWidgets[r]instanceof pt){if(o=this.ChildWidgets[r],u=o.GetSplittedWidget(n-this.Margin.Bottom),u!=null){if(r==0&&u==o)return this;this.ChildWidgets.Contains(u)&&(this.ChildWidgets.Remove(u),r--);this.Height-=u.Height;i==null&&(i=this.CreateCellWidget());i.Height+=u.Height;i.ChildWidgets.Add(u);u.ContainerWidget=i}}else if(e=this.ChildWidgets[r],n-this.Margin.Bottom<e.Y+e.Height&&(s=e.Height,f=e.GetSplittedWidget(n-this.Margin.Bottom),f!=null)){if(r==0&&f==e)return this;this.ChildWidgets.Contains(f)?(this.ChildWidgets.Remove(f),r--,this.Height-=f.Height):this.Height-=s-e.Height;i==null&&(i=this.CreateCellWidget());i.Height+=f.Height;i.ChildWidgets.push(f);f.ContainerWidget=i}return i==null&&t&&(this.ChildWidgets.length==0&&(this.Height=0),i=this.CreateCellWidget()),i},i.prototype.CreateCellWidget=function(){var n=new i(this.TableCell);return n.UpdateWidgetLocation(this),this.TableCell.TableCellWidgets.push(n),n.Margin=this.Margin,n.LeftBorderWidth=this.LeftBorderWidth,n.RightBorderWidth=this.RightBorderWidth,n},i.prototype.IsFirstLineFit=function(n){var t,i;return this.ChildWidgets.length==0?!0:this.ChildWidgets[0]instanceof pt?(t=this.ChildWidgets[0],t.IsFirstLineFit(n-this.Margin.Bottom)):(i=this.ChildWidgets[0],i.IsFirstLineFit(n-this.Margin.Bottom))},i.prototype.UpdateHeight=function(n){for(var t=0;t<this.ChildWidgets.length;t++)this.ChildWidgets[t]instanceof ti&&this.ChildWidgets[t].UpdateHeight(n)},i.prototype.UpdateChildLocation=function(n){for(var t=0;t<this.ChildWidgets.length;t++)this.ChildWidgets[t].X=this.ChildWidgets[t].X,this.ChildWidgets[t].Y=n,this.ChildWidgets[t]instanceof ti&&this.ChildWidgets[t].UpdateChildLocation(n),n+=this.ChildWidgets[t].Height},i.prototype.GetLineWidget=function(n){for(var i,t=0;t<this.ChildWidgets.length;t++)if(this.ChildWidgets[t].Y<=n.Y&&this.ChildWidgets[t].Y+this.ChildWidgets[t].Height>=n.Y)return this.ChildWidgets[t].GetLineWidget(n);return i=null,this.ChildWidgets.length>0&&(i=this.ChildWidgets[0].Y<=n.Y?this.ChildWidgets[this.ChildWidgets.length-1].GetLineWidget(n):this.ChildWidgets[0].GetLineWidget(n)),i},i.prototype.UpdateCellVerticalPosition=function(n,t){if(this.TableCell.OwnerTable.Owner instanceof lt||t){var i=this.GetDisplacement(n);this.UpdateCellContentVerticalPosition(i,n)}},i.prototype.GetDisplacement=function(n){var i=0,u=this.ContainerWidget,f=this.Margin.Top+this.Margin.Bottom,r,t;return i=this.TableCell.CellFormat.RowSpan>1?this.Height:u.Height-f,r=this.GetCellContentHeight(),t=0,i>r&&(t=i-r,this.TableCell.CellFormat.VerticalAlignment==eu.Center?t=t/2:(this.TableCell.CellFormat.VerticalAlignment==eu.Top||n)&&(t=0)),t},i.prototype.GetCellContentHeight=function(){for(var t=0,n=0;n<this.ChildWidgets.Count;n++)this.ChildWidgets[n]instanceof pt?t+=this.ChildWidgets[n].Height:this.ChildWidgets[n]instanceof ti&&(t+=this.ChildWidgets[n].Height);return t},i.prototype.UpdateCellContentVerticalPosition=function(n,t){var r,i;if(n!=0)for(r=this.Y+n,i=0;i<this.ChildWidgets.Count;i++)this.ChildWidgets[i]instanceof pt?this.ChildWidgets[i].Y=r:this.ChildWidgets[i]instanceof ti&&(r=this.UpdateTableWidgetLocation(this.ChildWidgets[i],r,t)),r=r+this.ChildWidgets[i].Height},i.prototype.UpdateTableWidgetLocation=function(n,t,i){var o,u,r,f,e;for(n.Y=t=t+n.TopBorderWidth,o=0,u=0;u<n.ChildWidgets.Count;u++){for(r=n.ChildWidgets[u],r.Y=t,f=0;f<r.ChildWidgets.Count;f++)e=r.ChildWidgets[f],e.Y=t,e.UpdateCellVerticalPosition(i,!0);t=t+r.Height}return t},i.prototype.RenderTableCellOutline=function(n){var f=null,t=this.TableCell,e=0,u=0,o=0,c=0,a=0,i,r,s,l,h;f=t.CellFormat.Borders;u=t.BottomMargin;e=t.TopMargin;o=t.LeftMargin;c=t.RightMargin;a=t.OwnerRow!=null&&t.OwnerRow.RowFormat.HeightType==et.Exactly?t.OwnerRow.RowFormat.Height+e+u:t.OwnerRow!=null&&t.OwnerRow.TableRowWidgets.Count<=1?Math.max(t.OwnerRow.RowFormat.Height,this.Height)+e+u:this.Height+e+u;i=f.GetCellLeftBorder(t);r=0;i!=null&&(r=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-o-r/2,this.Y-e,this.X-o-r/2,this.Y+this.Height+u,r));i=f.GetCellTopBorder(t);i!=null&&(r=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left,this.Y-this.Margin.Top+r/2,this.X+this.Width+this.Margin.Right,this.Y-this.Margin.Top+r/2,r));(t.OwnerTable.TableFormat.CellSpacing>0||t.CellIndex==t.OwnerRow.Cells.Count-1)&&(i=f.GetCellRightBorder(t),i!=null&&(r=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X+this.Width+this.Margin.Right-r/2,this.Y-e,this.X+this.Width+this.Margin.Right-r/2,this.Y+this.Height+u,r)));s=t.OwnerRow.NextNode;l=!1;s!=null&&(h=null,s.TableRowWidgets!=null&&s.TableRowWidgets.Count>0&&(h=s.TableRowWidgets[0]),h instanceof bi&&this.ContainerWidget instanceof bi&&this.ContainerWidget instanceof ti&&(l=this.ContainerWidget.ChildWidgets.Contains(h)));(t.OwnerTable.TableFormat.CellSpacing>0||t.OwnerRow.RowIndex==t.OwnerTable.Rows.Count-1||t.CellFormat.RowSpan>1&&t.OwnerRow.RowIndex+t.CellFormat.RowSpan==t.OwnerTable.Rows.Count||!l)&&(i=t.CellFormat.RowSpan>1&&t.OwnerRow.RowIndex+t.CellFormat.RowSpan==t.OwnerTable.Rows.Count?f.GetBorderBasedOnPriority(t.CellFormat.Borders.Bottom,t.OwnerTable.TableFormat.Borders.GetCellBottomBorder(t)):f.GetCellBottomBorder(t),i!=null&&(r=i.GetLineWidth(),this.RenderSingleBorder(n,i,this.X-this.Margin.Left,this.Y+this.Height+u+r/2,this.X+this.Width+this.Margin.Right,this.Y+this.Height+u+r/2,r)));i=f.GetCellDiagonalUpBorder(t);i!=null&&(r=i.GetLineWidth(),r>0&&this.RenderSingleBorder(n,i,this.X-o,this.Y+this.Height+u,this.X+this.Width+c,this.Y-e,r));i=f.GetCellDiagonalDownBorder(t);i!=null&&(r=i.GetLineWidth(),r>0&&this.RenderSingleBorder(n,i,this.X-o,this.Y-e,this.X+this.Width+c,this.Y+this.Height+u,r));this.RenderCellBackground(n,a)},i.prototype.RenderCellBackground=function(n,t){var r=this.CurrentNode.CellFormat,i=r.Shading.BackgroundColor;i&&(n.fillStyle=i,n.fillRect(this.X-this.Margin.Left+this.LeftBorderWidth,this.Y-this.TableCell.TopMargin,this.Width+this.Margin.Left+this.Margin.Right-this.LeftBorderWidth-this.RightBorderWidth,t),n.fill())},i.prototype.Highlight=function(n,t){this.ClearChildSelectionHighlight(n.OwnerControl.Viewer);n.CreateHighlightBorderInsideTable(this,n,t)},i.prototype.ClearSelectionHighlight=function(n){n!=null&&n.OwnerControl!=null&&n.OwnerControl.Selection.SelectionRanges.Count>0&&n.OwnerControl.Selection.SelectionRanges.ClearSelectionHighlightInternal(this)},i.prototype.RemoveWidget=function(n){n.OwnerControl!=null&&n.OwnerControl.Selection.SelectionRanges.Count>0&&n.OwnerControl.Selection.SelectionRanges.RemoveSelectionHighlight(this);for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=null,r=this.GetPage(),n,t;if(r!=null&&(i=r.Viewer),this.ChildWidgets!=null){for(n=0;n<this.ChildWidgets.Count;n++){if(t=this.ChildWidgets[n],t instanceof pt?t.Dispose():t.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(t);n--}this.ChildWidgets=null}this.ClearSelectionHighlight(i);this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets!=null&&this.ContainerWidget.ChildWidgets.Remove(this),this.ContainerWidget=null);this.TableCell!=null&&(this.TableCell.TableCellWidgets!=null&&this.TableCell.TableCellWidgets.Remove(this),this.TableCell=null)},i}(oi);t.TableCellWidget=gt;pt=function(t){function i(n){t.call(this);this.CurrentNode=n}return n(i,t),i.prototype._getHTML=function(){var n="<p ",t,i,r;for(n+='style="',n+="white-space:pre-wrap;line-height:100%;",n+="margin:0px;",n+='"',n+=">",t=0,i=this.ChildWidgets;t<i.length;t++)r=i[t],n+=r._getHTML();return n+"<\/p>"},i.prototype._render=function(n){for(var i,r=this.Y,u=this.X,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._render(n,u,r),r+=i.Height},i.prototype._renderCanvas=function(n){for(var i,r=this.Y,u=this.X,t=0;t<this.ChildWidgets.length;t++)i=this.ChildWidgets[t],i._renderCanvas(n,u,r),r+=i.Height},i.prototype.IsFirstLineFit=function(n){var t=this.ChildWidgets[0],r,i;return t.CurrentParagraphWidget.ContainerWidget instanceof gt&&(r=t.CurrentParagraphWidget.ContainerWidget,i=null,t.CurrentParagraphWidget.CurrentNode!=null&&r.ContainerWidget!=null&&(i=t.CurrentParagraphWidget.CurrentNode.GetOwnerDocument()),i!=null&&i.OwnerControl!=null&&r.ContainerWidget.Y==i.OwnerControl.Viewer.ClientArea.Y&&this.Y+t.Height>=n)?!0:this.Y+t.Height<=n},i.prototype.GetSplittedWidget=function(n){for(var t,e,f=this.Y,r=null,u=0;u<this.ChildWidgets.length;u++){if(t=this.ChildWidgets[u],n<f+t.Height){if(u==0){if(t.CurrentParagraphWidget.ContainerWidget instanceof gt&&t.CurrentParagraphWidget.ContainerWidget.Y==this.Y){f+=t.Height;continue}r=this;break}this.ChildWidgets.Contains(t)&&(this.ChildWidgets.Remove(t),u--);this.Height-=t.Height;r==null?(r=new i(this.CurrentNode),r.UpdateWidgetLocation(this),e=this.CurrentNode,e.ParagraphWidgets.push(r),r.Height=t.Height):r.Height+=t.Height;r.ChildWidgets.push(t);t.CurrentParagraphWidget=r}f+=t.Height}return r},i.prototype.GetLineWidget=function(n){for(var r,i=this.Y,t=0;t<this.ChildWidgets.length;t++){if(i<=n.Y&&i+this.ChildWidgets[t].Height>=n.Y)return this.ChildWidgets[t];i+=this.ChildWidgets[t].Height}return r=null,this.ChildWidgets.length>0&&(r=this.Y<=n.Y?this.ChildWidgets[this.ChildWidgets.length-1]:this.ChildWidgets[0]),r},i.prototype.Highlight=function(n,t,i,r,u,f){for(var e,o,c,s=0,h=i;h<this.ChildWidgets.length;h++){if(e=this.ChildWidgets[h],h==i&&(s=e.GetTop()),o=e.GetLeft(),e==r){c=r.GetLeftInternal(u,f);n.CreateHighlightBorder(t,e,c-o,o,s);return}n.CreateHighlightBorder(t,e,e.GetWidth(!0)-(o-this.X),o,s);s+=e.Height}},i.prototype.RemoveWidget=function(n){for(var t=0;t<this.ChildWidgets.Count;t++)this.ChildWidgets[t].RemoveWidget(n)},i.prototype.Dispose=function(){var i=this.Height,n,t;if(this.ChildWidgets!=null){for(n=0;n<this.ChildWidgets.Count;n++){if(t=this.ChildWidgets[n],t.Dispose(),this.ChildWidgets==null)break;this.ChildWidgets.Remove(t);n--}this.ChildWidgets=null}this.CurrentNode!=null&&(this.CurrentNode.ParagraphWidgets!=null&&this.CurrentNode.ParagraphWidgets.Remove(this),this.CurrentNode=null);this.ContainerWidget!=null&&(this.ContainerWidget.ChildWidgets.Remove(this),this.ContainerWidget.Height-=i,(this.ContainerWidget.ChildWidgets==null||this.ContainerWidget.ChildWidgets.Count==0)&&this.ContainerWidget instanceof ni&&this.ContainerWidget.Dispose(),this.ContainerWidget=null)},i}(oi);t.ParagraphWidget=pt;ki=function(){function n(n){this.X=0;this.Y=0;this.Width=0;this.Height=0;this.Children=null;this.CurrentParagraphWidget=n;this.Children=new e}return n.prototype._getHTML=function(){for(var r,t="",n=0,i=this.Children;n<i.length;n++)r=i[n],t+=r._getHTML();return t},n.prototype._IsParagraphFirstLine=function(){return this==this.CurrentParagraphWidget.ChildWidgets[0]?!0:!1},n.prototype._render=function(n,t,i){var f=document.getElementById(n.Id+"_background"),o=document.getElementById(n.Id+"_foreground"),s=document.getElementById(n.Id+"_selection"),r,u,e;if(f!=null){var h=f.getContext("2d"),c=o.getContext("2d"),l=s.getContext("2d");for(n.Viewer.OwnerControl.Selection.SelectionRanges.Count>0&&n.Viewer.OwnerControl.Selection.SelectionRanges.AddSelectionHighlight(l,this,i),this._IsParagraphFirstLine()&&(t+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),r=0;r<this.Children.Count;r++)u=this.Children[r],e=this.getUnderlineYposition(),u._render(c,h,t,i,e),t+=u.Width+u.Margin.Left}},n.prototype._renderCanvas=function(n,t,i){var f,r,u,e;if(n!=null)for(this._IsParagraphFirstLine()&&(t+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),f=n.getContext("2d"),r=0;r<this.Children.Count;r++)u=this.Children[r],e=this.getUnderlineYposition(),u._render(f,f,t,i,e),t+=u.Width+u.Margin.Left},n.prototype.getUnderlineYposition=function(){var t=0,i=0,n;if(this.Children.Count==0||this.Children.Count==1&&this.Children[0]instanceof rt||this.Children.Count==2&&this.Children[0]instanceof rt&&this.Children[1]instanceof rt)return 0;for(n=0;n<this.Children.Count;n++)t<this.Children[n].Height&&(t=this.Children[0].Margin.Top+this.Children[0].Height,i=this.Children[0].Height/20);return t-2*i},n.prototype.GetLeft=function(){var i=this.CurrentParagraphWidget.X,t,n;for(this._IsParagraphFirstLine()&&(i+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),t=0;t<this.Children.Count;t++)if(n=this.Children[t],n instanceof rt)i+=t==0?n.Margin.Left+n.Width:n.Width;else{i+=n.Margin.Left;break}return i},n.prototype.GetLeftInternal=function(n,t){var i=this.CurrentParagraphWidget.X,u,r;for(this._IsParagraphFirstLine()&&(i+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),u=this.Children.IndexOf(n),r=0;r<u;r++)i+=this.Children[r].Margin.Left+this.Children[r].Width;return n!=null&&(i+=n.Margin.Left),n instanceof c?i+=t==n.Length?n.Width:t>n.Length?n.Width+o.GetParagraphMarkSize(n.Inline.OwnerParagraph.CharacterFormat).Width:o.MeasureText(n.Text.substr(0,t),n.Inline.CharacterFormat).Width:t>0&&(n!=null?(i+=n.Width,t==2&&(i+=o.GetParagraphMarkSize(n.Inline.OwnerParagraph.CharacterFormat).Width)):i+=o.GetParagraphMarkSize(this.CurrentParagraphWidget.CurrentNode.CharacterFormat).Width),i},n.prototype.GetLineStartLeft=function(){var n=this.CurrentParagraphWidget.X;return this._IsParagraphFirstLine()&&(n+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),this.Children.Count>0&&(n+=this.Children[0].Margin.Left),n},n.prototype.GetTop=function(){for(var t=this.CurrentParagraphWidget.Y,i=this.CurrentParagraphWidget.ChildWidgets.IndexOf(this),n=0;n<i;n++)t+=this.CurrentParagraphWidget.ChildWidgets[n].Height;return t},n.prototype.UpdateTextPosition=function(n,t,i){var f=t,e=null,r=0,o=!1,u=this.UpdateTextPositionInternal(n,e,r,f,!1);u!=null&&(e=u.inline,r=u.index,f=u.caretPosition,o=u.isImageSelected);o?(n.Selection.Select(this.CurrentParagraphWidget.CurrentNode,e,r,f,!0),r==0?n.Selection.ExtendForward(!1):n.Selection.ExtendBackward(!1)):n.Selection.Select(this.CurrentParagraphWidget.CurrentNode,e,r,f,i)},n.prototype.UpdateTextPositionInternal=function(n,t,i,r,f){var d=!1,v=this.GetTop(),s=this.CurrentParagraphWidget.X,it=this.GetFirstElement(s),e=it.element,g,y,p,h,ft,a,nt,tt,l;if(s=it.left,e==null){var w=0,ut=0,b=this.CurrentParagraphWidget.CurrentNode.GetParagraphMarkSize(w,ut);w=b.TopMargin;ut=b.BottomMargin;f&&r.X>s+b.Width/2&&(s+=b.Width,this.CurrentParagraphWidget.CurrentNode.Inlines.Count>0&&(t=this.CurrentParagraphWidget.CurrentNode.Inlines[this.CurrentParagraphWidget.CurrentNode.Inlines.Count-1],i=t.Length),i++);r=new k(s,w>0?v+w:v)}else if(e!=null){if(r.X>s+e.Margin.Left){for(h=this.Children.IndexOf(e);h<this.Children.Count;h++){if(e=this.Children[h],r.X<s+e.Margin.Left+e.Width||h==this.Children.Count-1)break;s+=e.Margin.Left+e.Width}if(r.X>s+e.Margin.Left+e.Width)i=e instanceof c?this.GetTextLength(e)+e.Length:1,s+=e.Margin.Left+e.Width;else if(e instanceof c){for(g=r.X-s-e.Margin.Left,s+=e.Margin.Left,y=0,p=0,h=1;h<=e.Length;h++){if(l=0,l=h==e.Length?e.Width:o.MeasureText(e.Text.substr(0,h),e.Inline.CharacterFormat).Width,g<l||h==e.Length){ft=l-y;g-y>ft/2?(s+=l,p=h):(s+=y,p=h-1,h==1&&e!=this.Children[0]&&(a=this.Children.IndexOf(e),this.Children[a-1]instanceof rt||(e=this.Children[a-1],p=e instanceof c?e.Length:1)));break}y=l}i=this.GetTextLength(e)+p}else d=e instanceof li,r.X-s-e.Margin.Left>e.Width/2?(i=1,s+=e.Margin.Left+e.Width):e==this.Children[0]||d||(a=this.Children.IndexOf(e),this.Children[a-1]instanceof rt||(e=this.Children[a-1],i=e instanceof c?this.GetTextLength(e)+e.Length:1))}else s+=e.Margin.Left,i=this.GetTextLength(e);if(e instanceof c)v+=e.Margin.Top>0?e.Margin.Top:0;else{var et=o.MeasureText("a",e.Inline.CharacterFormat),st=et.Height,ot=et.BaselineOffset;v+=e.Margin.Top+e.Height-ot}t=e.Inline;nt=t.ValidateTextPosition(i);t=nt.inline;i=nt.index;tt=t.NextNode==null&&i==t.Length;f&&t.NextNode instanceof u&&i==t.Length&&(tt=t.IsLastRenderedInline(i));f&&tt&&(l=o.GetParagraphMarkSize(t.OwnerParagraph.CharacterFormat).Width,r.X>s+l/2&&(s+=l,i=t.Length+1));r=new k(s,v)}return{inline:t,index:i,caretPosition:r,isImageSelected:d}},n.prototype.GetTextLength=function(n){for(var i=0,r=n.Inline.Elements.IndexOf(n),t=0;t<r;t++)i+=n.Inline.Elements[t].Length;return i},n.prototype.GetFirstElementInternal=function(){for(var n=null,t=0;t<this.Children.Count;t++)if(n=this.Children[t],n instanceof rt)n=null;else break;return n},n.prototype.GetFirstElement=function(n){var r=0,t,i;for(this._IsParagraphFirstLine()&&(r=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),n+=r,t=null,i=0;i<this.Children.Count;i++)if(t=this.Children[i],t instanceof rt)n+=t.Margin.Left+t.Width,t=null;else break;return{element:t,left:n}},n.prototype.GetWidth=function(n){var i=0,t;for(this._IsParagraphFirstLine()&&(i+=this.CurrentParagraphWidget.CurrentNode.ParagraphFormat.FirstLineIndent),t=0;t<this.Children.Count;t++)i+=this.Children[t].Margin.Left+this.Children[t].Width;return n&&this.CurrentParagraphWidget.CurrentNode.ParagraphWidgets.indexOf(this.CurrentParagraphWidget)==this.CurrentParagraphWidget.CurrentNode.ParagraphWidgets.Count-1&&this.CurrentParagraphWidget.ChildWidgets.IndexOf(this)==this.CurrentParagraphWidget.ChildWidgets.Count-1&&(i+=o.GetParagraphMarkSize(this.CurrentParagraphWidget.CurrentNode.CharacterFormat).Width),i},n.prototype.UpdateTextPositionWidget=function(n,t,i,r){var f=t,e=null,o=0,u=this.UpdateTextPositionInternal(n,e,o,f,r);u!=null&&(e=u.inline,o=u.index,f=u.caretPosition);i.SetPositionForSelection(this.CurrentParagraphWidget.CurrentNode,e,o,f)},n.prototype.GetHyperlinkField=function(n,t){var u=null,v=this.GetTop(),c=this.GetLineStartLeft(),f,a,i,h,s,r,l;if(t.Y<v||t.Y>v+this.Height||t.X<c||t.X>c+this.Width)return null;if(f=this.CurrentParagraphWidget.X,a=this.GetFirstElement(f),f=a.left,i=a.element,i==null){if(s=o.GetParagraphMarkSize(this.CurrentParagraphWidget.CurrentNode.CharacterFormat).Width,t.X<=c+s||t.X>=c+s)return r=new e,l=this.CurrentParagraphWidget.CurrentNode.GetHyperlinkFields(this.CurrentParagraphWidget.CurrentNode,r),r.Clear(),r=null,l}else{if(t.X>f+i.Margin.Left)for(h=this.Children.IndexOf(i);h<this.Children.Count;h++){if(i=this.Children[h],t.X<f+i.Margin.Left+i.Width||h==this.Children.Count-1)break;f+=i.Margin.Left+i.Width}if(u=i.Inline,s=i.Margin.Left+i.Width,u.NextNode==null&&i==u.Elements[u.Elements.Count-1]&&(s+=o.GetParagraphMarkSize(u.OwnerParagraph.CharacterFormat).Width),t.X<=f+s)return r=new e,l=u.OwnerParagraph.GetHyperlinkField(u,r),r.Clear(),r=null,l}return null},n.prototype.ClearSelectionHighlight=function(n){n!=null&&n.OwnerControl!=null&&n.OwnerControl.Selection.SelectionRanges.Count>0&&n.OwnerControl.Selection.SelectionRanges.ClearSelectionHighlightInternal(this)},n.prototype.RemoveWidget=function(n){n.OwnerControl!=null&&n.OwnerControl.Selection.SelectionRanges.Count>0&&n.OwnerControl.Selection.SelectionRanges.RemoveSelectionHighlight(this)},n.prototype.Dispose=function(){var n=null;this.CurrentParagraphWidget!=null&&this.CurrentParagraphWidget.GetPage()!=null&&(n=this.CurrentParagraphWidget.GetPage().Viewer);this.DisposeInternal(n)},n.prototype.DisposeInternal=function(n){var t,i;if(this.ClearSelectionHighlight(n),this.Children!=null){for(t=0;t<this.Children.Count;t++)i=this.Children[t],i.Dispose(n),this.Children.Remove(i),t--;this.Children=null}this.CurrentParagraphWidget!=null&&(this.CurrentParagraphWidget.ChildWidgets!=null&&(this.CurrentParagraphWidget.ChildWidgets.Remove(this),this.CurrentParagraphWidget.Height-=this.Height),this.CurrentParagraphWidget=null)},n}();t.LineWidget=ki;lr=function(){function n(n){this.X=0;this.Y=0;this.Width=0;this.Height=0;this.BaseNode=n}return Object.defineProperty(n.prototype,"Inline",{get:function(){return this.BaseNode},enumerable:!0,configurable:!0}),n.prototype.GetIndexInInline=function(){var t=0,i,n;if(yt!=null&&this instanceof c)for(i=this.Inline.Elements.IndexOf(this),n=0;n<i;n++)t+=this.Inline.Elements[n].Length;return t},n.prototype._renderUnderline=function(n,t,i,r,u,f,e){var s=this.Height/(e==ct.Normal?1:1.5),h=this.Margin.Top,c=s/20,o=0;e==ct.Subscript||this instanceof rt?(o=s-2*c+i,h+=this.Height-s,o+=h>0?h:0):o=r+i;n.fillRect(t,o,this.Width,c)},n.prototype._renderStrikeThrough=function(n,t,i,r,u,f){var o=this.Height/(f==ct.Normal?1:1.5),s=this.Margin.Top;f==ct.Subscript&&(s+=this.Height-o);i+=s>0?s:0;var e=o/20,h=o/2+.5*e,c=0;for(r==hi.DoubleStrike&&(h-=e);c<(r==hi.DoubleStrike?2:1);)c++,n.fillRect(t+this.Margin.Left,h+i,this.Width,e),h+=2*e},n.prototype.ClipRect=function(n,t,i,r,u){n.beginPath();n.save();n.rect(t,i,r,u);n.clip()},n}();t.ElementBox=lr;c=function(t){function i(n){t.call(this,n);this.BaselineOffset=0;this.Index=0;this.Length=0}return n(i,t),Object.defineProperty(i.prototype,"Text",{get:function(){return this.Inline instanceof p?this.Inline.Text.substr(this.Index,this.Length):""},enumerable:!0,configurable:!0}),i.prototype._getHTML=function(){var n="<span ";return n+=">",n+=this.Inline.Text.substr(this.Index,this.Length),n+"<\/span>"},i.prototype._render=function(n,t,i,r,u){var c=!1,e=this.CurrentLineWidget.CurrentParagraphWidget.ContainerWidget,s,h,f,o,y;e instanceof gt&&(c=e.CurrentNode.OwnerRow.RowFormat.HeightType==et.Exactly);s=this.Margin.Top;h=this.Margin.Left;c&&this.ClipRect(n,e.X,e.Y,e.Width,e.Height);f=this.Inline.CharacterFormat;o=f.FontColor;n.textBaseline="top";var l="",a="",v=11;l=f.Bold?"bold":"";a=f.Italic?"italic":"";v=f.FontSize==0?.5:f.FontSize/(f.BaselineAlignment==ct.Normal?1:1.5);n.font=l+" "+a+" "+v+"px "+f.FontFamily;f.BaselineAlignment==ct.Subscript&&(s+=this.Height-this.Height/1.5);f.HighlightColor!=b.NoColor&&(t.fillStyle=st.GetHighlightColorCode(f.HighlightColor),t.fillRect(i+h,r+s,this.Width,this.Height));o=="empty"&&(y=this.Inline.OwnerParagraph.Document,o=this.Inline.CharacterFormat.GetDefaultFontColor(y));n.fillStyle=o;n.fillText(this.Text,i+h,r+s,this.Width);n.restore();f.Underline!=gi.None&&this._renderUnderline(n,i,r,u,o,f.Underline,f.BaselineAlignment);f.StrikeThrough!=hi.None&&this._renderStrikeThrough(n,i,r,f.StrikeThrough,o,f.BaselineAlignment)},i.prototype.Dispose=function(){var n=null;this.CurrentLineWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget.GetPage()!=null&&(n=this.CurrentLineWidget.CurrentParagraphWidget.GetPage().Viewer);this.DisposeInternal(n)},i.prototype.DisposeInternal=function(){this.CurrentLineWidget!=null&&(this.CurrentLineWidget.Children.Contains(this)&&this.CurrentLineWidget.Children.Remove(this),this.CurrentLineWidget=null);this.Inline!=null&&(this.Inline.Elements!=null&&this.Inline.Elements.Contains(this)&&this.Inline.Elements.Remove(this),this.BaseNode=null)},i}(lr);t.TextElementBox=c;rt=function(t){function i(n,i,r){t.call(this,n);this.BaselineOffset=0;this.index=0;this.isFollowCharacter=!1;this.ListLevel=i;this.isFollowCharacter=r}return n(i,t),Object.defineProperty(i.prototype,"Paragraph",{get:function(){return this.BaseNode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Text",{get:function(){return this.text},set:function(n){this.text=n},enumerable:!0,configurable:!0}),i.prototype._getHTML=function(){return},i.prototype._render=function(n,t,i,r,u){var h=this.Margin.Top,l=this.Margin.Left,f=this.ListLevel.CharacterFormat,c=this.Paragraph.CharacterFormat,e=f.FontColor,y;n.textBaseline="top";var a="",v="",p=f.FontFamily=="verdana"?c.FontFamily:f.FontFamily,o=f.FontSize==11?c.FontSize:f.FontSize,s=f.BaselineAlignment==0?c.BaselineAlignment:f.BaselineAlignment;a=f.Bold?"bold":"";v=f.Italic?"italic":"";o=o==0?.5:o/(s==ct.Normal?1:1.5);n.font=a+" "+v+" "+o+"px "+p;s==ct.Subscript&&(h+=this.Height-this.Height/1.5);f.HighlightColor!=b.NoColor&&(t.fillStyle=st.GetHighlightColorCode(f.HighlightColor),t.fillRect(i+l,r+h,this.Width,this.Height));e=="empty"&&(y=this.Paragraph.Document,e=this.ListLevel.CharacterFormat.GetDefaultFontColor(y));n.fillStyle=e;n.fillText(this.Text,i+l,r+h);f.Underline!=gi.None&&this._renderUnderline(n,i,r,u,e,f.Underline,s);f.StrikeThrough!=hi.None&&this._renderStrikeThrough(n,i,r,f.StrikeThrough,e,s)},i.prototype.Dispose=function(){var n=null;this.CurrentLineWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget.GetPage()!=null&&(n=this.CurrentLineWidget.CurrentParagraphWidget.GetPage().Viewer);this.DisposeInternal(n)},i.prototype.DisposeInternal=function(){this.CurrentLineWidget!=null&&(this.CurrentLineWidget.Children.Contains(this)&&this.CurrentLineWidget.Children.Remove(this),this.CurrentLineWidget=null);this.BaseNode=null;this.ListLevel=null},i}(lr);t.ListTextElementBox=rt;li=function(t){function i(n){t.call(this,n)}return n(i,t),i.prototype._getHTML=function(){var n="<img ";return n+='width="'+this.Inline.Width+'" ',n+='height="'+this.Inline.Height+'" ',n+='src="'+this.Inline.ImageString+'" ',n+">"},i.prototype._render=function(n,t,i,r,u){var o=this.Margin.Top,l=this.Margin.Left,s=0,e=this.Inline.CharacterFormat,a="black",h,f,c,v;n.textBaseline="top";h=document.createElement("img");h.src=this.Inline.ImageString;n.save();(o<0||this.CurrentLineWidget.Width<this.Width)&&(f=this.CurrentLineWidget.CurrentParagraphWidget.ContainerWidget,f instanceof ni?s=f.Width+f.X:f instanceof gt&&(c=0,f.ChildWidgets[0]instanceof pt&&(v=f.ChildWidgets[0].CurrentNode,c=v.ParagraphFormat.LeftIndent),s=f.Width+f.Margin.Left-f.LeftBorderWidth-c),this.ClipRect(n,i+l,r+o,s,f.Height));this.Inline.IsMetaFile||n.drawImage(h,i+l,r+o,this.Width,this.Height);n.restore();e.Underline!=gi.None&&this._renderUnderline(n,i,r,u,a,e.Underline,e.BaselineAlignment);e.StrikeThrough!=hi.None&&this._renderStrikeThrough(n,i,r,e.StrikeThrough,a,e.BaselineAlignment)},i.prototype.Dispose=function(){var n=null;this.CurrentLineWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget!=null&&this.CurrentLineWidget.CurrentParagraphWidget.GetPage()!=null&&(n=this.CurrentLineWidget.CurrentParagraphWidget.GetPage().Viewer);this.DisposeInternal(n)},i.prototype.DisposeInternal=function(){this.CurrentLineWidget!=null&&(this.CurrentLineWidget.Children.Contains(this)&&this.CurrentLineWidget.Children.Remove(this),this.CurrentLineWidget=null);this.Inline!=null&&(this.Inline.Elements!=null&&this.Inline.Elements.Contains(this)&&this.Inline.Elements.Remove(this),this.BaseNode=null)},i}(lr);t.ImageElementBox=li;ar=function(t){function i(n){t.call(this,n);this.listId=-1;this.abstractListId=-1;this.levelOverrides=new ur(this)}return n(i,t),Object.defineProperty(i.prototype,"OwnerDocument",{get:function(){return this.OwnerBase},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AbstractList",{get:function(){var n=null;return this.OwnerDocument!=null&&(n=this.OwnerDocument.GetAbstractListAdvByID(this.AbstractListId)),n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListId",{get:function(){return this.listId},set:function(n){this.listId=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AbstractListId",{get:function(){return this.abstractListId},set:function(n){this.abstractListId=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LevelOverrides",{get:function(){return this.levelOverrides},set:function(n){this.levelOverrides=n},enumerable:!0,configurable:!0}),i.prototype.GetListLevel=function(n){this.AbstractList!=null&&this.AbstractList.Levels.Count<=n&&n>=0&&n<9&&this.OwnerDocument.AddListLevel(this.AbstractList);var t=null;return this.LevelOverrides!=null&&(t=this.LevelOverrides.Get(n))!=null&&t.OverrideListLevel!=null?t.OverrideListLevel:this.AbstractList!=null&&n>=0&&n<this.AbstractList.Levels.Count?this.AbstractList.Levels[n]:null},i.prototype.GetListStartValue=function(n){var t=this.LevelOverrides!=null?this.LevelOverrides.Get(n):null,i;return t!=null&&t.OverrideListLevel==null?t.StartAt:(i=this.GetListLevel(n),i==null?0:i.StartAt)},i.prototype.Dispose=function(){this.SetOwner(null);this.LevelOverrides!=null&&this.LevelOverrides.Dispose();this.levelOverrides=null},i}(it);t.ListAdv=ar;ai=function(t){function i(n){t.call(this,n);this.abstractListId=-1;this.levels=new rr(this)}return n(i,t),Object.defineProperty(i.prototype,"OwnerDocument",{get:function(){return this.OwnerBase},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AbstractListId",{get:function(){return this.abstractListId},set:function(n){this.abstractListId=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Levels",{get:function(){return this.levels},set:function(n){this.levels=n},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){var n,t;if(this.SetOwner(null),this.levels!=null)for(n=0;n<this.levels.length;n++)t=this.levels[n],this.levels.Dispose,this.levels.Remove(t),n--},i}(it);t.AbstractListAdv=ai;at=function(t){function i(n){t.call(this,n);this.listLevelPattern=v.Arabic;this.startAt=0;this.numberFormat="";this.followCharacter=ou.Tab;this.levelNumber=0;this.paragraphFormat=null;this.characterFormat=null;this.restartLevel=0;this.CharacterFormat=new vr(this);this.ParagraphFormat=new di(this)}return n(i,t),Object.defineProperty(i.prototype,"OwnerDocument",{get:function(){return this.OwnerBase instanceof ai!=null?this.OwnerBase.OwnerDocument:this.OwnerBase instanceof si!=null?this.OwnerBase.OwnerList.OwnerDocument:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListLevelPattern",{get:function(){return this.listLevelPattern},set:function(n){this.listLevelPattern=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FollowCharacter",{get:function(){return this.followCharacter},set:function(n){this.followCharacter=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"StartAt",{get:function(){return this.startAt},set:function(n){this.startAt=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"NumberFormat",{get:function(){return this.numberFormat},set:function(n){this.numberFormat=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RestartLevel",{get:function(){return this.restartLevel},set:function(n){this.restartLevel=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LevelNumber",{get:function(){return this.OwnerBase instanceof si?this.OwnerBase.LevelNumber:this.OwnerBase instanceof ai&&this.OwnerBase.Levels!=null?this.OwnerBase.Levels.IndexOf(this):-1},set:function(n){this.levelNumber=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CharacterFormat",{get:function(){return this.characterFormat},set:function(n){this.characterFormat=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ParagraphFormat",{get:function(){return this.paragraphFormat},set:function(n){this.paragraphFormat=n},enumerable:!0,configurable:!0}),i.prototype.GetListText=function(n){switch(this.ListLevelPattern){case v.UpRoman:return this.GetAsRoman(n).toUpperCase();case v.LowRoman:return this.GetAsRoman(n).toLowerCase();case v.UpLetter:return this.GetAsLetter(n).toUpperCase();case v.LowLetter:return this.GetAsLetter(n).toLowerCase();case v.Arabic:return n.toString();case v.LeadingZero:return n<10?"0"+n.toString():n.toString();case v.Number:return n.toString();case v.OrdinalText:return n.toString();case v.Ordinal:return n.toString();case v.FarEast:return n.toString();case v.Special:return n.toString();default:return""}},i.prototype.GetAsRoman=function(n){var t="",i={number:n};return t+=this.GenerateNumber(i,1e3,"M"),t+=this.GenerateNumber(i,900,"CM"),t+=this.GenerateNumber(i,500,"D"),t+=this.GenerateNumber(i,400,"CD"),t+=this.GenerateNumber(i,100,"C"),t+=this.GenerateNumber(i,90,"XC"),t+=this.GenerateNumber(i,50,"L"),t+=this.GenerateNumber(i,40,"XL"),t+=this.GenerateNumber(i,10,"X"),t+=this.GenerateNumber(i,9,"IX"),t+=this.GenerateNumber(i,5,"V"),t+=this.GenerateNumber(i,4,"IV"),t+=this.GenerateNumber(i,1,"I"),t.toString()},i.prototype.GenerateNumber=function(n,t,i){for(var r="";n.number>=t;)n.number-=t,r+=i;return r.toString()},i.prototype.GetAsLetter=function(n){var t,i,r,u;if(n<=0)return"";for(t=n/26,i=n%26,i==0&&(i=26,t--),r=String.fromCharCode(64+i),u=r.toString();t>0;)u=r.toString(),t--;return u},i.DOTBULLET="",i.SQUAREBULLET="",i.ARROWBULLET="➤",i.CIRCLEBULLET=" ",i}(it);t.ListLevelAdv=at;si=function(t){function i(n){t.call(this,n)}return n(i,t),Object.defineProperty(i.prototype,"OwnerList",{get:function(){return this.OwnerBase},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"StartAt",{get:function(){return this.startAt},set:function(n){this.startAt=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LevelNumber",{get:function(){return this.levelNumber},set:function(n){this.levelNumber=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OverrideListLevel",{get:function(){return this.overrideListLevel},set:function(n){this.overrideListLevel=n},enumerable:!0,configurable:!0}),i}(it);t.LevelOverrideAdv=si;yu=function(t){function i(n){t.call(this,n);this.headerdistance=48;this.footerdistance=48;this.differentfirstpage=!1;this.differentoddandevenpages=!1;this.pagewidth=816;this.pageheight=1056;this.leftmargin=96;this.topmargin=96;this.rightmargin=96;this.bottommargin=96}return n(i,t),Object.defineProperty(i.prototype,"HeaderDistance",{get:function(){return this.headerdistance},set:function(n){this.headerdistance=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FooterDistance",{get:function(){return this.footerdistance},set:function(n){this.footerdistance=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DifferentFirstPage",{get:function(){return this.differentfirstpage},set:function(n){this.differentfirstpage=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"DifferentOddAndEvenPages",{get:function(){return this.differentoddandevenpages},set:function(n){this.differentoddandevenpages=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PageWidth",{get:function(){return this.pagewidth},set:function(n){this.pagewidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PageHeight",{get:function(){return this.pageheight},set:function(n){this.pageheight=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftMargin",{get:function(){return this.leftmargin},set:function(n){this.leftmargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopMargin",{get:function(){return this.topmargin},set:function(n){this.topmargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightMargin",{get:function(){return this.rightmargin},set:function(n){this.rightmargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BottomMargin",{get:function(){return this.bottommargin},set:function(n){this.bottommargin=n},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){this.SetOwner(null)},i}(ut);t.SectionFormat=yu;vr=function(t){function i(n){t.call(this,n);this.bold=!1;this.italic=!1;this.fontSize=11;this.underline=gi.None;this.strikeThrough=hi.None;this.baselineAlignment=ct.Normal;this.highlightColor=b.NoColor;this.fontColor="empty";this.fontFamily="verdana"}return n(i,t),Object.defineProperty(i.prototype,"Bold",{get:function(){return this.bold},set:function(n){this.bold=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Italic",{get:function(){return this.italic},set:function(n){this.italic=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FontSize",{get:function(){return this.fontSize},set:function(n){this.fontSize=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FontFamily",{get:function(){return this.fontFamily},set:function(n){this.fontFamily=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Underline",{get:function(){return this.underline},set:function(n){this.underline=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"StrikeThrough",{get:function(){return this.strikeThrough},set:function(n){this.strikeThrough=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BaselineAlignment",{get:function(){return this.baselineAlignment},set:function(n){this.baselineAlignment=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HighlightColor",{get:function(){return this.highlightColor},set:function(n){this.highlightColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FontColor",{get:function(){return this.fontColor},set:function(n){this.fontColor=n},enumerable:!0,configurable:!0}),i.prototype.CopyFormat=function(n){n.BaselineAlignment!=undefined&&n.BaselineAlignment!=null&&(this.Bold=n.Bold);n.Underline!=undefined&&n.Underline!=null&&(this.Underline=n.Underline);n.StrikeThrough!=undefined&&n.StrikeThrough!=null&&(this.StrikeThrough=n.StrikeThrough);n.FontSize!=undefined&&n.FontSize!=null&&(this.FontSize=n.FontSize);n.FontFamily!=undefined&&n.FontFamily!=null&&(this.FontFamily=n.FontFamily);n.Bold!=undefined&&n.Bold!=null&&(this.Bold=n.Bold);n.Italic!=undefined&&n.Italic!=null&&(this.Italic=n.Italic);n.HighlightColor!=undefined&&n.HighlightColor!=null&&(this.HighlightColor=n.HighlightColor);n.FontColor!=undefined&&n.FontColor!=null&&(this.FontColor=n.FontColor)},i.prototype.GetAsHtmlStyle=function(){var n='style="';return this.Bold&&(n+="font-weight:bold; "),this.Italic&&(n+="font-style:italic; "),this.Underline!=gi.None&&(n+="text-decoration:underline; "),this.StrikeThrough!=hi.None&&(n+="text-decoration:line-through; "),this.BaselineAlignment==ct.Subscript?n+="vertical-align:sub;":this.BaselineAlignment==ct.Superscript&&(n+="vertical-align:super;"),n+="color:"+this.FontColor+"; font-family:"+this.FontFamily+"; font-size:"+this.FontSize+"px; ",this.HighlightColor!=b.NoColor&&(n+="background:"+st.GetHighlightColorCode(this.HighlightColor)),n+'" '},i.prototype.GetDefaultFontColor=function(n){var t=n.BackgroundColor;return st.IsVeryDark(t)?"#FFFFFF":"#000000"},i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);t.CharacterFormat=vr;di=function(t){function i(n){t.call(this,n);this.leftIndent=0;this.rightIndent=0;this.firstLineIndent=0;this.afterSpacing=0;this.beforeSpacing=0;this.lineSpacing=1;this.lineSpacingType=bt.Multiple;this.ListFormat=new pu(this)}return n(i,t),Object.defineProperty(i.prototype,"Document",{get:function(){return this.OwnerBase instanceof r&&this.OwnerBase.Document!=null?this.OwnerBase.Document:this.OwnerBase instanceof at?this.OwnerBase.OwnerDocument:this.OwnerBase instanceof pi?this.OwnerBase:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftIndent",{get:function(){return this.leftIndent},set:function(n){this.leftIndent=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightIndent",{get:function(){return this.rightIndent},set:function(n){this.rightIndent=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"FirstLineIndent",{get:function(){return this.firstLineIndent},set:function(n){this.firstLineIndent=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BeforeSpacing",{get:function(){return this.beforeSpacing},set:function(n){this.beforeSpacing=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"AfterSpacing",{get:function(){return this.afterSpacing},set:function(n){this.afterSpacing=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineSpacing",{get:function(){return this.lineSpacing},set:function(n){this.lineSpacing=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LineSpacingType",{get:function(){return this.lineSpacingType},set:function(n){this.lineSpacingType=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TextAlignment",{get:function(){return this.textalignment},set:function(n){this.textalignment=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListFormat",{get:function(){return this.listFormat},set:function(n){this.listFormat=n},enumerable:!0,configurable:!0}),i.prototype.CopyFormat=function(n){n.AfterSpacing!=undefined&&n.AfterSpacing!=null&&(this.AfterSpacing=n.AfterSpacing);n.BeforeSpacing!=undefined&&n.BeforeSpacing!=null&&(this.BeforeSpacing=n.BeforeSpacing);n.LeftIndent!=undefined&&n.LeftIndent!=null&&(this.LeftIndent=n.LeftIndent);n.RightIndent!=undefined&&n.RightIndent!=null&&(this.RightIndent=n.RightIndent);n.FirstLineIndent!=undefined&&n.FirstLineIndent!=null&&(this.FirstLineIndent=n.FirstLineIndent);n.LineSpacing!=undefined&&n.LineSpacing!=null&&(this.LineSpacing=n.LineSpacing);n.LineSpacingType!=undefined&&n.LineSpacingType!=null&&(this.LineSpacingType=n.LineSpacingType);n.TextAlignment!=undefined&&n.TextAlignment!=null&&(this.TextAlignment=n.TextAlignment);n.ListFormat!=undefined&&n.ListFormat!=null&&(this.ListFormat=n.ListFormat)},i.prototype.GetAsHtmlStyle=function(){var n='style="',i,t;return n+=vt.TextAlign+tt.Colon+st.GetHtmlTextAlign(this.TextAlignment)+tt.SemiColon,i=this.LeftIndent,t=this.FirstLineIndent,this.ListFormat.ListLevel!=null&&(i-=48,t+=24),n+=vt.Margin+tt.Colon+this.BeforeSpacing.toString()+"px "+this.RightIndent.toString()+"px "+this.AfterSpacing.toString()+"px "+i.toString()+"px;",t!=0&&(n+=vt.TextIndent+tt.Colon+t.toString()+vt.Px+tt.SemiColon),n+=this.LineSpacingType==bt.Multiple?vt.LineHeight+tt.Colon+(this.LineSpacing*100).toString()+vt.Percentage+tt.SemiColon:vt.LineHeight+tt.Colon+this.LineSpacing.toString()+vt.Px+tt.SemiColon,n+'" '},i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);t.ParagraphFormat=di;pu=function(t){function i(n){t.call(this,n);this.listId=-1;this.listLevelNumber=0}return n(i,t),Object.defineProperty(i.prototype,"Document",{get:function(){return this.OwnerBase instanceof di?this.OwnerBase.Document:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListId",{get:function(){return this.listId},set:function(n){this.listId=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListLevelNumber",{get:function(){return this.listLevelNumber},set:function(n){this.listLevelNumber=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ListLevel",{get:function(){return this.List!=null?this.List.GetListLevel(this.ListLevelNumber):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"List",{get:function(){if(this.Document!=null)return this.Document.GetListByID(this.ListId)},enumerable:!0,configurable:!0}),i}(it);t.ListFormat=pu;wu=function(){function n(){this.tableColumns=new hu}return Object.defineProperty(n.prototype,"Columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),n.prototype.GetPreviousSpannedCellWidth=function(n,t){for(var r=0,i=n;i<t;i++)r+=this.tableColumns[i].PreferredWidth;return r},n.prototype.Dispose=function(){this.tableColumns!=null&&(this.tableColumns.Clear(),this.tableColumns=null)},n}();t.TableHolder=wu;iu=function(t){function i(n){t.call(this,n)}return n(i,t),Object.defineProperty(i.prototype,"BackgroundColor",{get:function(){return this.backgroundColor},set:function(n){this.backgroundColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ForegroundColor",{get:function(){return this.foregroundColor},set:function(n){this.foregroundColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TextureStyle",{get:function(){return this.textureStyle},set:function(n){this.textureStyle=n},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);t.Shading=iu;yr=function(t){function r(n){t.call(this,n);this.Left=new g(this);this.Right=new g(this);this.Top=new g(this);this.Bottom=new g(this);this.DiagonalUp=new g(this);this.DiagonalDown=new g(this);this.Horizontal=new g(this);this.Vertical=new g(this)}return n(r,t),Object.defineProperty(r.prototype,"Left",{get:function(){return this.left},set:function(n){this.left=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Right",{get:function(){return this.right},set:function(n){this.right=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Top",{get:function(){return this.top},set:function(n){this.top=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Bottom",{get:function(){return this.bottom},set:function(n){this.bottom=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Horizontal",{get:function(){return this.horizontal},set:function(n){this.horizontal=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Vertical",{get:function(){return this.vertical},set:function(n){this.vertical=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"DiagonalUp",{get:function(){return this.diagonalUp},set:function(n){this.diagonalUp=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"DiagonalDown",{get:function(){return this.diagonalDown},set:function(n){this.diagonalDown=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"LineStyle",{set:function(n){this.Left!=null&&(this.Left.LineStyle=n);this.Right!=null&&(this.Right.LineStyle=n);this.Top!=null&&(this.Top.LineStyle=n);this.Bottom!=null&&(this.Bottom.LineStyle=n);this.Horizontal!=null&&(this.Horizontal.LineStyle=n);this.Vertical!=null&&(this.Vertical.LineStyle=n);this.DiagonalUp!=null&&(this.DiagonalUp.LineStyle=n);this.DiagonalDown!=null&&(this.DiagonalDown.LineStyle=n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"LineWidth",{set:function(n){this.Left!=null&&(this.Left.LineWidth=n);this.Right!=null&&(this.Right.LineWidth=n);this.Top!=null&&(this.Top.LineWidth=n);this.Bottom!=null&&(this.Bottom.LineWidth=n);this.Horizontal!=null&&(this.Horizontal.LineWidth=n);this.Vertical!=null&&(this.Vertical.LineWidth=n);this.DiagonalUp!=null&&(this.DiagonalUp.LineWidth=n);this.DiagonalDown!=null&&(this.DiagonalDown.LineWidth=n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Color",{set:function(n){this.Left!=null&&(this.Left.Color=n);this.Right!=null&&(this.Right.Color=n);this.Top!=null&&(this.Top.Color=n);this.Bottom!=null&&(this.Bottom.Color=n);this.Horizontal!=null&&(this.Horizontal.Color=n);this.Vertical!=null&&(this.Vertical.Color=n);this.DiagonalUp!=null&&(this.DiagonalUp.Color=n);this.DiagonalDown!=null&&(this.DiagonalDown.Color=n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"OwnerCell",{get:function(){return this.OwnerBase instanceof uu&&this.OwnerBase.OwnerBase instanceof ht?this.OwnerBase.OwnerBase:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"OwnerRow",{get:function(){return this.OwnerCell!=null?this.OwnerCell.OwnerRow:this.OwnerBase instanceof ru&&this.OwnerBase.OwnerBase instanceof ri?this.OwnerBase.OwnerBase:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"OwnerTable",{get:function(){return this.OwnerRow!=null?this.OwnerRow.OwnerTable:this.OwnerBase instanceof wt&&this.OwnerBase.OwnerBase instanceof y?this.OwnerBase.OwnerBase:null},enumerable:!0,configurable:!0}),r.prototype.GetTableLeftBorder=function(){if(this.Left!=null)return this.Left;var n=new g(this);return n.LineStyle=i.Single,n.LineWidth=.66,n},r.prototype.GetTableRightBorder=function(){if(this.Right!=null)return this.Right;var n=new g(this);return n.LineStyle=i.Single,n.LineWidth=.66,n},r.prototype.GetTableTopBorder=function(){if(this.Top!=null)return this.Top;var n=new g(this);return n.LineStyle=i.Single,n.LineWidth=.66,n},r.prototype.GetTableBottomBorder=function(){if(this.Bottom!=null)return this.Bottom;var n=new g(this);return n.LineStyle=i.Single,n.LineWidth=.66,n},r.prototype.GetCellLeftBorder=function(n){var t=null,r=n.CellFormat.Borders,u=n.OwnerRow!=null?n.OwnerRow.RowFormat.Borders:null,f=n.OwnerTable!=null?n.OwnerTable.TableFormat.Borders:null,i;return r.Left!=null&&(t=r.Left),t==null&&(t=this.GetLeftBorderToRenderByHierarchy(t,u,f)),n.OwnerTable.TableFormat.CellSpacing>0?t=this.GetLeftBorderToRenderByHierarchy(t,u,f):(i=null,n.PreviousNode!=null&&(i=n.PreviousNode),t=this.GetPrevCellLeftBorder(t,i)),t==null&&(t=new g(this)),t},r.prototype.GetPrevCellLeftBorder=function(n,t){if(t!=null&&(n==null||n.LineStyle!=i.None||n.HasNoneStyle)){var u=void 0,r=null;if(t.CellFormat.Borders!=null&&t.CellFormat.Borders.Right!=null&&t.CellFormat.Borders.Right.LineStyle!=i.None&&(r=t.CellFormat.Borders.Right),r!=null&&r.LineStyle!=i.None)u=this.GetBorderBasedOnPriority(r,n);else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof wt))return this.GetLeftBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders)}else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof wt))return this.GetLeftBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders);return n},r.prototype.GetLeftBorderToRenderByHierarchy=function(n,t,u){return n!=null&&(n.LineStyle!=i.None||n.HasNoneStyle)?n:n!=null&&n.OwnerBase instanceof r&&n.OwnerBase.OwnerCell.ColumnIndex==0?(u!=null&&u.Left!=null&&(n=u.Left),n):t!=null&&t.Vertical!=null&&t.Vertical.LineStyle!=i.None?t.Vertical:u!=null&&u.Vertical!=null&&u.Vertical.LineStyle!=i.None?u.Vertical:n},r.prototype.GetCellDiagonalUpBorder=function(n){var i=null,t=null;return t=n.CellFormat.Borders,t.DiagonalUp!=null&&(i=t.DiagonalUp),i},r.prototype.GetCellDiagonalDownBorder=function(n){var i=null,t=null;return t=n.CellFormat.Borders,t.DiagonalDown!=null&&(i=t.DiagonalDown),i},r.prototype.GetCellRightBorder=function(n){var t=null,r=n.CellFormat.Borders,u=n.OwnerRow!=null?n.OwnerRow.RowFormat.Borders:null,f=n.OwnerTable!=null?n.OwnerTable.TableFormat.Borders:null,i;return r.Right!=null&&(t=r.Right),t==null&&(t=this.GetRightBorderToRenderByHierarchy(t,u,f)),n.OwnerTable.TableFormat.CellSpacing>0?t=this.GetRightBorderToRenderByHierarchy(t,u,f):(i=null,n.NextNode!=null&&(i=n.NextNode),t=this.GetAdjacentCellRightBorder(t,i)),t==null&&(t=new g(this)),t},r.prototype.GetAdjacentCellRightBorder=function(n,t){if(t!=null&&(n==null||n.LineStyle!=i.None||n.HasNoneStyle)){var r=null;if(t.CellFormat.Borders!=null&&t.CellFormat.Borders.Left!=null&&t.CellFormat.Borders.Left.LineStyle!=i.None&&(r=t.CellFormat.Borders.Left),r!=null&&r.LineStyle!=i.None)return this.GetBorderBasedOnPriority(n,r);if(n!=null&&!(n.OwnerBase.OwnerBase instanceof wt))return this.GetRightBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders)}else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof wt))return this.GetRightBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders);return n},r.prototype.GetRightBorderToRenderByHierarchy=function(n,t,u){return n!=null&&(n.LineStyle!=i.None||n.HasNoneStyle)?n:n!=null&&n.OwnerBase instanceof r&&n.OwnerBase.OwnerCell.ColumnIndex==n.OwnerBase.OwnerCell.OwnerRow.Cells.Count-1?(u!=null&&u.Right!=null&&(n=u.Right),n):t!=null&&t.Vertical!=null&&t.Vertical.LineStyle!=i.None?t.Vertical:u!=null&&u.Vertical!=null&&u.Vertical.LineStyle!=i.None?u.Vertical:n},r.prototype.GetCellTopBorder=function(n){var t=null,u=n.CellFormat.Borders,f=n.OwnerRow!=null?n.OwnerRow.RowFormat.Borders:null,e=n.OwnerTable!=null?n.OwnerTable.TableFormat.Borders:null,r,i;return u.Top!=null&&(t=u.Top),t==null&&(t=this.GetTopBorderToRenderByHierarchy(t,f,e)),n.OwnerTable.TableFormat.CellSpacing>0?t=this.GetTopBorderToRenderByHierarchy(t,f,e):(r=null,i=n.OwnerRow.PreviousNode,i!=null&&n.ColumnIndex<i.Cells.Count&&(r=i.Cells[n.ColumnIndex]),t=this.GetPrevCellTopBorder(t,r)),t==null&&(t=new g(this)),t},r.prototype.GetPrevCellTopBorder=function(n,t){if(t!=null&&(n==null||n.LineStyle!=i.None||n.HasNoneStyle)){var r=null;if(t.CellFormat.Borders!=null&&t.CellFormat.Borders.Bottom!=null&&t.CellFormat.Borders.Bottom.LineStyle!=i.None&&(r=t.CellFormat.Borders.Left),r!=null&&r.LineStyle!=i.None)return this.GetBorderBasedOnPriority(n,r);if(n!=null&&!(n.OwnerBase.OwnerBase instanceof wt))return this.GetTopBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders)}else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof wt))return this.GetTopBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders);return n},r.prototype.GetTopBorderToRenderByHierarchy=function(n,t,u){return n!=null&&(n.LineStyle!=i.None||n.HasNoneStyle)?n:n!=null&&n.OwnerBase instanceof r&&n.OwnerBase.OwnerCell.OwnerRow.RowIndex==0?(u!=null&&u.Top!=null&&(n=u.Top),n):t!=null&&t.Horizontal!=null&&t.Horizontal.LineStyle!=i.None?t.Horizontal:u!=null&&u.Horizontal!=null&&u.Horizontal.LineStyle!=i.None?u.Horizontal:n},r.prototype.GetCellBottomBorder=function(n){var t=null,u=n.CellFormat.Borders,f=n.OwnerRow!=null?n.OwnerRow.RowFormat.Borders:null,e=n.OwnerTable!=null?n.OwnerTable.TableFormat.Borders:null,r,i;return u.Bottom!=null&&(t=u.Bottom),t==null&&(t=this.GetBottomBorderToRenderByHierarchy(t,f,e)),n.OwnerTable.TableFormat.CellSpacing>0?t=this.GetBottomBorderToRenderByHierarchy(t,f,e):(r=null,i=n.OwnerRow.NextNode,i!=null&&n.ColumnIndex<i.Cells.Count&&(r=i.Cells[n.ColumnIndex]),t=this.GetAdjacentCellBottomBorder(t,r)),t==null&&(t=new g(this)),t},r.prototype.GetAdjacentCellBottomBorder=function(n,t){if(t!=null&&(n==null||n.LineStyle!=i.None||n.HasNoneStyle)){var r=null;if(t.CellFormat.Borders!=null&&t.CellFormat.Borders.Top!=null&&t.CellFormat.Borders.Top.LineStyle!=i.None&&(r=t.CellFormat.Borders.Top),r!=null&&r.LineStyle!=i.None)return this.GetBorderBasedOnPriority(n,r);if(n!=null&&!(n.OwnerBase.OwnerBase instanceof wt))return this.GetBottomBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders)}else if(n!=null&&!(n.OwnerBase.OwnerBase instanceof wt))return this.GetBottomBorderToRenderByHierarchy(n,n.OwnerBase.OwnerRow.RowFormat.Borders,n.OwnerBase.OwnerTable.TableFormat.Borders);return n},r.prototype.GetBottomBorderToRenderByHierarchy=function(n,t,u){return n!=null&&(n.LineStyle!=i.None||n.HasNoneStyle)?n:n!=null&&n.OwnerBase instanceof r&&n.OwnerBase.OwnerCell.OwnerRow.RowIndex+n.OwnerBase.OwnerCell.CellFormat.RowSpan==n.OwnerBase.OwnerCell.OwnerTable.Rows.Count?(u!=null&&u.Bottom!=null&&(n=u.Bottom),n):t!=null&&t.Horizontal!=null&&t.Horizontal.LineStyle!=i.None?t.Horizontal:u!=null&&u.Horizontal!=null&&u.Horizontal.LineStyle!=i.None?u.Horizontal:n},r.prototype.GetBorderBasedOnPriority=function(n,t){var e,o,s,h;if(n==null)return t;if(t==null)return n;if(e=n.GetBorderWeight(),o=t.GetBorderWeight(),e==o){if(s=n.GetPrecedence(),h=t.GetPrecedence(),s==h){var c=this.ConvertHexToRGB(n.Color),y=c.R,u=c.G,a=c.B,l=this.ConvertHexToRGB(t.Color),p=l.R,f=l.G,v=l.B,i=y+a+2*u,r=p+v+2*f;return i==r?(i=a+2*u,r=v+2*f,i==r?u==f?n:u>f?t:n:i>r?t:n):i>r?t:n}return s>h?n:t}return e>o?n:t},r.prototype.ConvertHexToRGB=function(n){if(n){n=n.replace(/[^0-9A-â€Œâ€‹F]/gi,"");var t=parseInt(n,16),i=t>>16&255,r=t>>8&255,u=t&255;return{R:i,G:r,B:u}}},r.prototype.GetAsHtmlStyle=function(){var t="",n=null;return n=this.OwnerCell!=null?this.GetCellLeftBorder(this.OwnerCell):this.GetTableLeftBorder(),n!=null&&n.LineStyle!=i.None?t+=n.GetAsHtmlStyle("left"):n!=null&&n.HasNoneStyle&&(t+="border-left-style:none;"),n=this.OwnerCell!=null?this.GetCellRightBorder(this.OwnerCell):this.GetTableRightBorder(),n!=null&&n.LineStyle!=i.None?t+=n.GetAsHtmlStyle("right"):n!=null&&n.HasNoneStyle&&(t+="border-right-style:none;"),n=this.OwnerCell!=null?this.GetCellTopBorder(this.OwnerCell):this.GetTableTopBorder(),n!=null&&n.LineStyle!=i.None?t+=n.GetAsHtmlStyle("top"):n!=null&&n.HasNoneStyle&&(t+="border-top-style:none;"),n=this.OwnerCell!=null?this.GetCellBottomBorder(this.OwnerCell):this.GetTableBottomBorder(),n!=null&&n.LineStyle!=i.None?t+=n.GetAsHtmlStyle("bottom"):n!=null&&n.HasNoneStyle&&(t+="border-bottom-style:none;"),t},r.prototype.Dispose=function(){this.SetOwner(null)},r}(it);t.Borders=yr;g=function(t){function r(n){t.call(this,n);this.color="#000000";this.lineStyle=i.Single;this.lineWidth=0}return n(r,t),Object.defineProperty(r.prototype,"Color",{get:function(){return this.color},set:function(n){this.color=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"LineStyle",{get:function(){return this.lineStyle},set:function(n){this.lineStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"LineWidth",{get:function(){return this.lineWidth},set:function(n){this.lineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Shadow",{get:function(){return this.shadow},set:function(n){this.shadow=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Space",{get:function(){return this.space},set:function(n){this.space=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"HasNoneStyle",{get:function(){return this.hasNoneStyle},set:function(n){this.hasNoneStyle=n},enumerable:!0,configurable:!0}),r.prototype.GetPrecedence=function(){var n=0;switch(this.LineStyle){case i.Single:n=1;break;case i.Thick:n=2;break;case i.Double:n=3;break;case i.Dot:n=4;break;case i.DashLargeGap:n=5;break;case i.DashDot:n=6;break;case i.DashDotDot:n=7;break;case i.Triple:n=8;break;case i.ThinThickSmallGap:n=9;break;case i.ThickThinSmallGap:n=10;break;case i.ThinThickThinSmallGap:n=11;break;case i.ThinThickMediumGap:n=12;break;case i.ThickThinMediumGap:n=13;break;case i.ThinThickThinMediumGap:n=14;break;case i.ThinThickLargeGap:n=15;break;case i.ThickThinLargeGap:n=16;break;case i.ThinThickThinLargeGap:n=17;break;case i.SingleWavy:n=18;break;case i.DoubleWavy:n=19;break;case i.DashSmallGap:n=20;break;case i.DashDotStroked:n=21;break;case i.Emboss3D:n=22;break;case i.Engrave3D:n=23;break;case i.Outset:n=24;break;case i.Inset:n=25}return n},r.prototype.GetBorderWeight=function(){var n=0,t=this.GetNumberOfLines(),r=this.GetBorderNumber();switch(this.LineStyle){case i.Single:case i.DashSmallGap:case i.DashDot:case i.DashDotDot:case i.Double:case i.Triple:case i.ThinThickSmallGap:case i.ThickThinSmallGap:case i.ThinThickThinSmallGap:case i.ThinThickMediumGap:case i.ThickThinMediumGap:case i.ThinThickThinMediumGap:case i.ThinThickLargeGap:case i.ThickThinLargeGap:case i.ThinThickThinLargeGap:case i.SingleWavy:case i.DoubleWavy:case i.DashDotStroked:case i.Emboss3D:case i.Engrave3D:case i.Outset:case i.Inset:case i.Thick:n=t*r;break;case i.Dot:case i.DashLargeGap:n=1}return n},r.prototype.GetBorderNumber=function(){var n=0;switch(this.LineStyle){case i.Single:n=1;break;case i.Thick:n=2;break;case i.Double:n=3;break;case i.Dot:n=4;break;case i.DashLargeGap:n=5;break;case i.DashDot:n=6;break;case i.DashDotDot:n=7;break;case i.Triple:n=8;break;case i.ThinThickSmallGap:n=9;break;case i.ThickThinSmallGap:n=10;break;case i.ThinThickThinSmallGap:n=11;break;case i.ThinThickMediumGap:n=12;break;case i.ThickThinMediumGap:n=13;break;case i.ThinThickThinMediumGap:n=14;break;case i.ThinThickLargeGap:n=15;break;case i.ThickThinLargeGap:n=16;break;case i.ThinThickThinLargeGap:n=17;break;case i.SingleWavy:n=18;break;case i.DoubleWavy:n=19;break;case i.DashSmallGap:n=20;break;case i.DashDotStroked:n=21;break;case i.Emboss3D:n=22;break;case i.Engrave3D:n=23;break;case i.Outset:n=24;break;case i.Inset:n=25}return n},r.prototype.GetNumberOfLines=function(){var n=0;switch(this.LineStyle){case i.Single:case i.Dot:case i.DashSmallGap:case i.DashLargeGap:case i.DashDot:case i.DashDotDot:n=1;break;case i.Double:n=3;break;case i.Triple:n=5;break;case i.ThinThickSmallGap:n=3;break;case i.ThickThinSmallGap:n=3;break;case i.ThinThickThinSmallGap:n=5;break;case i.ThinThickMediumGap:n=3;break;case i.ThickThinMediumGap:n=3;break;case i.ThinThickThinMediumGap:n=5;break;case i.ThinThickLargeGap:n=3;break;case i.ThickThinLargeGap:n=3;break;case i.ThinThickThinLargeGap:n=5;break;case i.SingleWavy:n=1;break;case i.DoubleWavy:n=2;break;case i.DashDotStroked:n=1;break;case i.Emboss3D:case i.Engrave3D:n=3;break;case i.Outset:case i.Inset:case i.Thick:n=1}return n},r.prototype.GetLineWidth=function(){var t,r,n;switch(this.LineStyle){case i.None:return 0;case i.Triple:case i.Double:case i.ThinThickSmallGap:case i.ThickThinSmallGap:case i.ThinThickThinSmallGap:case i.ThinThickMediumGap:case i.ThickThinMediumGap:case i.ThinThickThinMediumGap:case i.ThinThickLargeGap:case i.ThickThinLargeGap:case i.ThinThickThinLargeGap:case i.Emboss3D:case i.Engrave3D:for(t=this.GetBorderLineWidthArray(i,this.LineWidth),r=0,n=0;n<t.length;n++)r+=t[n];return r;case i.Single:case i.DashLargeGap:case i.DashSmallGap:case i.Dot:case i.DashDot:case i.DashDotDot:case i.Thick:return this.LineWidth;case i.SingleWavy:return this.LineWidth==1.5?3:2.5;case i.DoubleWavy:return 6.75;case i.DashDotStroked:case i.Outset:return this.LineWidth}return this.LineWidth},r.prototype.GetBorderLineWidthArray=function(n,t){var i=[t],r;switch(this.LineStyle){case n.Double:i=[1,1,1];break;case n.ThinThickSmallGap:i=[1,-.75,-.75];break;case n.ThickThinSmallGap:i=[-.75,-.75,1];break;case n.ThinThickMediumGap:i=[1,.5,.5];break;case n.ThickThinMediumGap:i=[.5,.5,1];break;case n.ThinThickLargeGap:i=[-1.5,1,-.75];break;case n.ThickThinLargeGap:i=[-.75,1,-1.5];break;case n.Triple:i=[1,1,1,1,1];break;case n.ThinThickThinSmallGap:i=[-.75,-.75,1,-.75,-.75];break;case n.ThinThickThinMediumGap:i=[.5,.5,1,.5,.5];break;case n.ThinThickThinLargeGap:i=[-.75,1,-1.5,1,-.75];break;case n.Emboss3D:case n.Engrave3D:i=[.25,0,1,0,.25]}if(i.length==1)return[t];for(r=0;r<i.length;r++)i[r]=i[r]>=0?i[r]*t:Math.abs(i[r]);return i},r.prototype.GetAsHtmlStyle=function(n){var t="";return t+="border-"+n+"-style:"+this.GetHtmlLineStyle(),t+=tt.SemiColon,this.LineWidth>0&&(t+="border-"+n+"-width:"+this.LineWidth.toString()+"px;"),this.Color!="#000000"&&(t+="border-"+n+"-color:"+this.Color+tt.SemiColon),t},r.prototype.GetHtmlLineStyle=function(){switch(this.LineStyle){case i.None:return"none";case i.Single:return"solid";case i.Dot:return"dotted";case i.DashSmallGap:case i.DashLargeGap:case i.DashDot:case i.DashDotDot:return"dashed";case i.Double:case i.Triple:case i.ThinThickSmallGap:case i.ThickThinSmallGap:case i.ThinThickThinSmallGap:case i.ThinThickMediumGap:case i.ThickThinMediumGap:case i.ThinThickThinMediumGap:case i.ThinThickLargeGap:case i.ThickThinLargeGap:case i.ThinThickThinLargeGap:return"double";case i.SingleWavy:return"solid";case i.DoubleWavy:return"double";case i.DashDotStroked:return"solid";case i.Emboss3D:return"ridge";case i.Engrave3D:return"groove";case i.Outset:return"outset";case i.Inset:return"inset";default:return"solid"}},r}(it);t.Border=g;wt=function(t){function i(n){t.call(this,n);this.leftMargin=7.2;this.topMargin=0;this.bottomMargin=0;this.rightMargin=7.2;this.Borders=new yr(this);this.Shading=new iu(this)}return n(i,t),Object.defineProperty(i.prototype,"Borders",{get:function(){return this.borders},set:function(n){this.borders=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CellSpacing",{get:function(){return this.cellSpacing},set:function(n){this.cellSpacing=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftMargin",{get:function(){return this.leftMargin},set:function(n){this.leftMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopMargin",{get:function(){return this.topMargin},set:function(n){this.topMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightMargin",{get:function(){return this.rightMargin},set:function(n){this.rightMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BottomMargin",{get:function(){return this.bottomMargin},set:function(n){this.bottomMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftIndent",{get:function(){return this.leftIndent},set:function(n){this.leftIndent=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Shading",{get:function(){return this.shading},set:function(n){this.shading=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TableAlignment",{get:function(){return this.tableAlignment},set:function(n){this.tableAlignment=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PreferredWidth",{get:function(){return this.prefferedWidth},set:function(n){this.prefferedWidth=n},enumerable:!0,configurable:!0}),i.prototype.GetAsHtmlStyle=function(){var t="",n;return this.Shading!=undefined&&this.Shading!=null&&this.Shading.BackgroundColor!=undefined&&this.Shading.BackgroundColor!=null&&(t+=" "+vt.BgColor+tt.Equal+'"'+this.Shading.BackgroundColor+'"'),t+=' border="1"',t+=' cellpadding="0"',n=' style="',this.LeftIndent!=undefined&&this.LeftIndent!=0&&(n+=vt.LeftIndent+tt.Colon+this.LeftIndent.toString()+"px;"),n+=this.CellSpacing!=undefined&&this.CellSpacing>0?"cellspacing:"+(this.CellSpacing*72/48).toString()+tt.SemiColon:"border-collapse:collapse;",this.Borders!=undefined&&this.Borders!=null&&(n+=this.Borders.GetAsHtmlStyle()),n+='" ',t+n},i.prototype.Dispose=function(){this.SetOwner(null);this.Borders.Dispose();this.Shading.Dispose()},i}(it);t.TableFormat=wt;ru=function(t){function i(n){t.call(this,n);this.Borders=new yr(this)}return n(i,t),Object.defineProperty(i.prototype,"AllowBreakAcrossPages",{get:function(){return this.allowBreakAcrossPages},set:function(n){this.allowBreakAcrossPages=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsHeader",{get:function(){return this.isHeader},set:function(n){this.isHeader=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Height",{get:function(){return this.height},set:function(n){this.height=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"HeightType",{get:function(){return this.heightType},set:function(n){this.heightType=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Borders",{get:function(){return this.borders},set:function(n){this.borders=n},enumerable:!0,configurable:!0}),i.prototype.GetAsHtmlStyle=function(){var n="";return this.Height!=undefined&&this.Height>0&&(n='style ="height:'+this.Height.toString()+'px;"'),n},i}(it);t.RowFormat=ru;uu=function(t){function i(n){t.call(this,n);this.leftMargin=0;this.topMargin=0;this.rightMargin=0;this.bottomMargin=0;this.Borders=new yr(this);this.Shading=new iu(this)}return n(i,t),Object.defineProperty(i.prototype,"Borders",{get:function(){return this.borders},set:function(n){this.borders=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"LeftMargin",{get:function(){return this.leftMargin},set:function(n){this.leftMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopMargin",{get:function(){return this.topMargin},set:function(n){this.topMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BottomMargin",{get:function(){return this.bottomMargin},set:function(n){this.bottomMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightMargin",{get:function(){return this.rightMargin},set:function(n){this.rightMargin=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"CellWidth",{get:function(){return this.cellWidth},set:function(n){this.cellWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ColumnSpan",{get:function(){return this.colSpan},set:function(n){this.colSpan=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RowSpan",{get:function(){return this.rowSpan},set:function(n){this.rowSpan=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PrefferedWidth",{get:function(){return this.prefferedWidth},set:function(n){this.prefferedWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PrefferedWidthType",{get:function(){return this.prefferedWidthtype},set:function(n){this.prefferedWidthtype=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Shading",{get:function(){return this.shading},set:function(n){this.shading=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"VerticalAlignment",{get:function(){return this.verticalAlignment},set:function(n){this.verticalAlignment=n},enumerable:!0,configurable:!0}),i.prototype.ContainsMargins=function(){return this.LeftMargin!=null&&this.LeftMargin!=undefined||this.RightMargin!=null&&this.RightMargin!=undefined||this.TopMargin!=null&&this.TopMargin!=undefined||this.BottomMargin!=null&&this.BottomMargin!=undefined},i.prototype.ClearMargins=function(){this.LeftMargin=this.RightMargin=this.TopMargin=this.BottomMargin=undefined},i.prototype.GetAsHtmlStyle=function(){var t="",n;return t+=" rowspan="+this.RowSpan.toString(),t+=" colspan="+this.ColumnSpan.toString(),this.Shading!=undefined&&this.Shading!=null&&this.Shading.BackgroundColor!=undefined&&this.Shading.BackgroundColor!=null&&(t+=" "+vt.BgColor+tt.Equal+'"'+this.Shading.BackgroundColor+'"'),this.CellWidth!=undefined&&this.CellWidth>0&&(t+=" width="+this.CellWidth.toString()),n=' style="',this.VerticalAlignment!=eu.Top&&(n+="valign:"+this.VerticalAlignment.toString().toLowerCase()),this.ContainsMargins()&&(this.LeftMargin!=undefined&&this.LeftMargin!=0&&(n+="padding-left:"+this.LeftMargin.toString()+"px;"),this.RightMargin!=undefined&&this.RightMargin!=0&&(n+="padding-right:"+this.RightMargin.toString()+"px;"),this.TopMargin!=undefined&&this.TopMargin!=0&&(n+="padding-top:"+this.TopMargin.toString()+"px;"),this.BottomMargin!=undefined&&this.BottomMargin!=0&&(n+="padding-bottom:"+this.BottomMargin.toString()+"px;")),this.Borders!=undefined&&this.Borders!=null&&(n+=this.Borders.GetAsHtmlStyle()),n+='" ',t+n},i.prototype.Dispose=function(){this.SetOwner(null)},i}(it);t.CellFormat=uu,function(n){n[n.None=0]="None";n[n.SingleStrike=1]="SingleStrike";n[n.DoubleStrike=2]="DoubleStrike"}(t.StrikeThrough||(t.StrikeThrough={}));hi=t.StrikeThrough,function(n){n[n.Normal=0]="Normal";n[n.Superscript=1]="Superscript";n[n.Subscript=2]="Subscript"}(t.BaselineAlignment||(t.BaselineAlignment={}));ct=t.BaselineAlignment,function(n){n[n.None=0]="None";n[n.Single=1]="Single";n[n.Words=2]="Words";n[n.Double=3]="Double";n[n.Dotted=4]="Dotted";n[n.Thick=6]="Thick";n[n.Dash=7]="Dash";n[n.DashLong=39]="DashLong";n[n.DotDash=9]="DotDash";n[n.DotDotDash=10]="DotDotDash";n[n.Wavy=11]="Wavy";n[n.DottedHeavy=20]="DottedHeavy";n[n.DashHeavy=23]="DashHeavy";n[n.DashLongHeavy=55]="DashLongHeavy";n[n.DotDashHeavy=25]="DotDashHeavy";n[n.DotDotDashHeavy=26]="DotDotDashHeavy";n[n.WavyHeavy=27]="WavyHeavy";n[n.WavyDouble=43]="WavyDouble"}(t.Underline||(t.Underline={}));gi=t.Underline,function(n){n[n.NoColor=0]="NoColor";n[n.Yellow=1]="Yellow";n[n.BrightGreen=2]="BrightGreen";n[n.Turquoise=3]="Turquoise";n[n.Pink=4]="Pink";n[n.Blue=5]="Blue";n[n.Red=6]="Red";n[n.DarkBlue=7]="DarkBlue";n[n.Teal=8]="Teal";n[n.Green=9]="Green";n[n.Violet=10]="Violet";n[n.DarkRed=11]="DarkRed";n[n.DarkYellow=12]="DarkYellow";n[n.Gray50=13]="Gray50";n[n.Gray25=14]="Gray25";n[n.Black=15]="Black"}(t.HighlightColor||(t.HighlightColor={}));b=t.HighlightColor,function(n){n[n.AtLeast=0]="AtLeast";n[n.Exactly=1]="Exactly";n[n.Multiple=2]="Multiple"}(t.LineSpacingType||(t.LineSpacingType={}));bt=t.LineSpacingType,function(n){n[n.Center=0]="Center";n[n.Left=1]="Left";n[n.Right=2]="Right";n[n.Justify=3]="Justify"}(t.TextAlignment||(t.TextAlignment={}));nt=t.TextAlignment,function(n){n[n.Auto=0]="Auto";n[n.Percent=1]="Percent";n[n.Pixel=2]="Pixel"}(t.WidthType||(t.WidthType={}));du=t.WidthType,function(n){n[n.Left=0]="Left";n[n.Center=1]="Center";n[n.Right=2]="Right"}(t.TableAlignment||(t.TableAlignment={}));fu=t.TableAlignment,function(n){n[n.None=0]="None";n[n.Single=1]="Single";n[n.Dot=2]="Dot";n[n.DashSmallGap=3]="DashSmallGap";n[n.DashLargeGap=4]="DashLargeGap";n[n.DashDot=5]="DashDot";n[n.DashDotDot=6]="DashDotDot";n[n.Double=7]="Double";n[n.Triple=8]="Triple";n[n.ThinThickSmallGap=9]="ThinThickSmallGap";n[n.ThickThinSmallGap=10]="ThickThinSmallGap";n[n.ThinThickThinSmallGap=11]="ThinThickThinSmallGap";n[n.ThinThickMediumGap=12]="ThinThickMediumGap";n[n.ThickThinMediumGap=13]="ThickThinMediumGap";n[n.ThinThickThinMediumGap=14]="ThinThickThinMediumGap";n[n.ThinThickLargeGap=15]="ThinThickLargeGap";n[n.ThickThinLargeGap=16]="ThickThinLargeGap";n[n.ThinThickThinLargeGap=17]="ThinThickThinLargeGap";n[n.SingleWavy=18]="SingleWavy";n[n.DoubleWavy=19]="DoubleWavy";n[n.DashDotStroked=20]="DashDotStroked";n[n.Emboss3D=21]="Emboss3D";n[n.Engrave3D=22]="Engrave3D";n[n.Outset=23]="Outset";n[n.Inset=24]="Inset";n[n.Thick=25]="Thick"}(t.LineStyle||(t.LineStyle={}));i=t.LineStyle,function(n){n[n.TextureNone=0]="TextureNone";n[n.Texture2Pt5Percent=35]="Texture2Pt5Percent";n[n.Texture5Percent=2]="Texture5Percent";n[n.Texture7Pt5Percent=36]="Texture7Pt5Percent";n[n.Texture10Percent=3]="Texture10Percent";n[n.Texture12Pt5Percent=37]="Texture12Pt5Percent";n[n.Texture15Percent=26]="Texture15Percent";n[n.Texture17Pt5Percent=39]="Texture17Pt5Percent";n[n.Texture20Percent=4]="Texture20Percent";n[n.Texture22Pt5Percent=40]="Texture22Pt5Percent";n[n.Texture25Percent=5]="Texture25Percent";n[n.Texture27Pt5Percent=41]="Texture27Pt5Percent";n[n.Texture30Percent=6]="Texture30Percent";n[n.Texture32Pt5Percent=42]="Texture32Pt5Percent";n[n.Texture35Percent=43]="Texture35Percent";n[n.Texture37Pt5Percent=44]="Texture37Pt5Percent";n[n.Texture40Percent=7]="Texture40Percent";n[n.Texture42Pt5Percent=45]="Texture42Pt5Percent";n[n.Texture45Percent=46]="Texture45Percent";n[n.Texture47Pt5Percent=47]="Texture47Pt5Percent";n[n.Texture50Percent=8]="Texture50Percent";n[n.Texture52Pt5Percent=48]="Texture52Pt5Percent";n[n.Texture55Percent=49]="Texture55Percent";n[n.Texture57Pt5Percent=50]="Texture57Pt5Percent";n[n.Texture60Percent=9]="Texture60Percent";n[n.Texture62Pt5Percent=51]="Texture62Pt5Percent";n[n.Texture65Percent=52]="Texture65Percent";n[n.Texture67Pt5Percent=53]="Texture67Pt5Percent";n[n.Texture70Percent=10]="Texture70Percent";n[n.Texture72Pt5Percent=54]="Texture72Pt5Percent";n[n.Texture75Percent=11]="Texture75Percent";n[n.Texture77Pt5Percent=55]="Texture77Pt5Percent";n[n.Texture80Percent=12]="Texture80Percent";n[n.Texture82Pt5Percent=56]="Texture82Pt5Percent";n[n.Texture85Percent=57]="Texture85Percent";n[n.Texture87Pt5Percent=58]="Texture87Pt5Percent";n[n.Texture90Percent=13]="Texture90Percent";n[n.Texture92Pt5Percent=59]="Texture92Pt5Percent";n[n.Texture95Percent=60]="Texture95Percent";n[n.Texture97Pt5Percent=61]="Texture97Pt5Percent";n[n.TextureSolid=1]="TextureSolid";n[n.TextureDarkHorizontal=14]="TextureDarkHorizontal";n[n.TextureDarkVertical=15]="TextureDarkVertical";n[n.TextureDarkDiagonalDown=16]="TextureDarkDiagonalDown";n[n.TextureDarkDiagonalUp=17]="TextureDarkDiagonalUp";n[n.TextureDarkCross=18]="TextureDarkCross";n[n.TextureDarkDiagonalCross=19]="TextureDarkDiagonalCross";n[n.TextureHorizontal=20]="TextureHorizontal";n[n.TextureVertical=21]="TextureVertical";n[n.TextureDiagonalDown=22]="TextureDiagonalDown";n[n.TextureDiagonalUp=23]="TextureDiagonalUp";n[n.TextureCross=24]="TextureCross";n[n.TextureDiagonalCross=25]="TextureDiagonalCross"}(t.TextureStyle||(t.TextureStyle={}));gu=t.TextureStyle,function(n){n[n.Auto=0]="Auto";n[n.Atleast=1]="Atleast";n[n.Exactly=2]="Exactly"}(t.HeightType||(t.HeightType={}));et=t.HeightType,function(n){n[n.Top=0]="Top";n[n.Center=1]="Center";n[n.Bottom=2]="Bottom"}(t.CellVerticalAlignment||(t.CellVerticalAlignment={}));eu=t.CellVerticalAlignment,function(n){n[n.EvenHeader=0]="EvenHeader";n[n.OddHeader=1]="OddHeader";n[n.EvenFooter=2]="EvenFooter";n[n.OddFooter=3]="OddFooter";n[n.FirstPageHeader=4]="FirstPageHeader";n[n.FirstPageFooter=5]="FirstPageFooter"}(t.HeaderFooterType||(t.HeaderFooterType={}));ot=t.HeaderFooterType,function(n){n[n.Arabic=0]="Arabic";n[n.UpRoman=1]="UpRoman";n[n.LowRoman=2]="LowRoman";n[n.UpLetter=3]="UpLetter";n[n.LowLetter=4]="LowLetter";n[n.Ordinal=5]="Ordinal";n[n.Number=6]="Number";n[n.OrdinalText=7]="OrdinalText";n[n.LeadingZero=22]="LeadingZero";n[n.Bullet=23]="Bullet";n[n.FarEast=20]="FarEast";n[n.Special=58]="Special";n[n.None=255]="None"}(t.ListLevelPattern||(t.ListLevelPattern={}));v=t.ListLevelPattern,function(n){n[n.Tab=0]="Tab";n[n.Space=1]="Space";n[n.None=2]="None"}(t.FollowCharacterType||(t.FollowCharacterType={}));ou=t.FollowCharacterType,function(n){n[n.File=0]="File";n[n.Webpage=1]="Webpage";n[n.Email=2]="Email";n[n.Bookmark=3]="Bookmark"}(t.HyperlinkType||(t.HyperlinkType={}));nr=t.HyperlinkType,function(n){n[n.None=0]="None";n[n.WholeWord=1]="WholeWord";n[n.CaseSensitive=2]="CaseSensitive";n[n.CaseSensitiveWholeWord=3]="CaseSensitiveWholeWord"}(t.FindOptions||(t.FindOptions={}));pr=t.FindOptions}(i||(i={})))});
